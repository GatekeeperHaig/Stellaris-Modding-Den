
namespace = pm_game_start

### Remove modifiers for star trek mods
event = {
	id = pm_game_start.1
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		log = "---- Fired Event pm_gamestart.1 ----"
		#log = "---- On Planet: [This.GetName] ----"
		log = "---- remove star trek modifiers ----"
		if = {
			limit = { 
				OR = {
					has_global_flag = star_trek_new_horizons 
					any_system = { 
						any_planet = { 
							is_planet_class = pc_geocrystalline 
						}
					}
				}
			}
			every_planet = {
				remove_modifier = "Precursor_Remnants"
				remove_modifier = "Precursor_Energy_Grid"
				remove_modifier = "Precursor_Satalite_Grid"
				remove_modifier = "Precursor_City"
				remove_modifier = "Precursor_Shipyards"
				remove_modifier = "Precursor_Planetary_Gun"
				remove_modifier = "Precursor_Bunker_Grid"
				remove_modifier = "Precursor_Mechs"
				remove_modifier = "Precursor_Planetary_Shield"
				remove_modifier = "Precursor_Floating_City"
				remove_modifier = "Precursor_Capital_Complex"
				remove_modifier = "Precursor_Communication_Hub"
				remove_modifier = "Precursor_Singularity_Drive"
				remove_modifier = "Utopian_World"
				remove_modifier = "Utopian_Services"
				remove_modifier = "Primitive_Reserve"
				remove_modifier = "Strange_Alien_Eggs"
				remove_modifier = "Ghost_Ships"
				remove_modifier = "Surface_Of_Bones"
				remove_modifier = "Arachnophobia"
				remove_modifier = "Giant_Worm"
				remove_modifier = "Temple_of_the_Ancient_One"
				remove_modifier = "Strange_Voices"
				remove_modifier = "Protomolecule_Infected_Station"
				remove_modifier = "Crystal_Moon_Palace"
				remove_modifier = "Cities_in_the_sky"
				remove_modifier = "Ancient_Temple"
				remove_modifier = "Android_Pleasure_Palace"
				remove_modifier = "Ruined_Battlefield"
				remove_modifier = "Spaceship_Graveyard"
				remove_modifier = "Artificial_Core"
			}
		}
	}
}

### Remove Precursor Modifiers from starting systems.
event = {
	id = pm_game_start.78870
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		log = "---- Fired Event pm_gamestart.78870 ----"
		#log = "---- On Planet: [This.GetName] ----"
		log = "---- removing precursor modifiers from starting systems ----"
		every_country = {
			limit = { exists = capital_scope }
			capital_scope = {
				solar_system = {
					every_system_planet = {
						if = {
							limit = { has_modifier = Precursor_Remnants }
							remove_modifier = Precursor_Remnants
						}
						if = {
							limit = { has_modifier = Precursor_Energy_Grid }
							remove_modifier = Precursor_Energy_Grid
						}
						if = {
							limit = { has_modifier = Precursor_Satalite_Grid }
							remove_modifier = Precursor_Satalite_Grid
						}
						if = {
							limit = { has_modifier = Precursor_City }
							remove_modifier = Precursor_City
						}
						if = {
							limit = { has_modifier = Precursor_Shipyards }
							remove_modifier = Precursor_Shipyards
						}if = {
							limit = { has_modifier = Precursor_Planetary_Gun }
							remove_modifier = Precursor_Planetary_Gun
						}
						if = {
							limit = { has_modifier = Precursor_Bunker_Grid }
							remove_modifier = Precursor_Bunker_Grid
						}
						if = {
							limit = { has_modifier = Precursor_Mechs }
							remove_modifier = Precursor_Mechs
						}
						if = {
							limit = { has_modifier = Precursor_Planetary_Shield }
							remove_modifier = Precursor_Planetary_Shield
						}
						if = {
							limit = { has_modifier = Precursor_Floating_City }
							remove_modifier = Precursor_Floating_City
						}
						if = {
							limit = { has_modifier = Precursor_Capital_Complex }
							remove_modifier = Precursor_Capital_Complex
						}
						if = {
							limit = { has_modifier = Precursor_Communication_Hub }
							remove_modifier = Precursor_Communication_Hub
						}
						if = {
							limit = { has_modifier = Precursor_Singularity_Drive }
							remove_modifier = Precursor_Singularity_Drive
						}
						if = {
							limit = { has_modifier = Precursor_Eternal_Fortress }
							remove_modifier = Precursor_Eternal_Fortress
						}
					}
				}
			}		
		}
	}
}

### Remove modifiers from Sol system planets.
event = {
	id = pm_game_start.78871
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		log = "---- Fired Event pm_gamestart.78871 ----"
		#log = "---- On Planet: [This.GetName] ----"
		log = "---- removing other modifiers from Sol system planets (where it makes sense story wise) ----"
		every_planet = {
			limit = { 
				if = {
					solar_system = { has_star_flag = sol }
				}
			}
			remove_modifier = Single_Biome
			remove_modifier = Hyper_Complex_Biome
			remove_modifier = weak_magnetic_field_2
			remove_modifier = strong_magnetic_field_2
			remove_modifier = ultra_rich_2
			remove_modifier = low_gravity_2
			remove_modifier = high_gravity_2
			remove_modifier = Floating_Islands
			remove_modifier = Hostile_Flora
			remove_modifier = Titanic_Predators
			remove_modifier = Unnatural_World
			remove_modifier = Atmospheric_Stimulant
			remove_modifier = Unusual_Seasons
			remove_modifier = Perfect_Seasons
			remove_modifier = Ruined_Battlefield
			remove_modifier = Spaceship_Graveyard
			remove_modifier = Living_Planet
			remove_modifier = Ideal_for_Life
			remove_modifier = Endless_Fish
			remove_modifier = Artificial_Water
			remove_modifier = Android_Pleasure_Palace
			remove_modifier = Small_Islands
			remove_modifier = Windy
			remove_modifier = Simple_Organisms
			remove_modifier = Newly_Evolved_Complex_Organisms
			remove_modifier = Delicious_Ingredients
			remove_modifier = Recent_Mass_Extinction
			remove_modifier = Friendly_Wildlife
			remove_modifier = Pleasant_Weather
			remove_modifier = Many_Extremophiles
			remove_modifier = Great_Temperature_Variation
			remove_modifier = Gorgeous_Sky
			remove_modifier = Ice_Age
			remove_modifier = Ancient_Temple
			remove_modifier = Tilted_Axis
			remove_modifier = Perpendicular_Axis
			remove_modifier = Radioactive_Mantle
			remove_modifier = Locust_Plagues
			remove_modifier = Acidic_Seas
			remove_modifier = Empathic_Life
			remove_modifier = Seasonal_Flooding
			remove_modifier = Lingering_Pollution
			remove_modifier = Thin_ozone_layer
			remove_modifier = Symbiotic_life
			remove_modifier = Resilent_parasites
			remove_modifier = Juggernaut_Manta_Rays
			remove_modifier = Black_Oily_Stone
			remove_modifier = Crystal_Moon_Palace
			remove_modifier = Cities_in_the_sky
			remove_modifier = Old_World
			remove_modifier = Dunes
			remove_modifier = Extensive_reef_systems
			remove_modifier = Trubbles
			remove_modifier = Strange_Voices
			remove_modifier = Solidified_Core
			remove_modifier = Temple_of_the_Ancient_One
			remove_modifier = Beautiful_Lakes
			remove_modifier = Proto_Forests
			remove_modifier = Dense_Forests
			remove_modifier = Planetwide_Forest
			remove_modifier = Hiveworld
			remove_modifier = Arachnophobia
			remove_modifier = Giant_Worm
			remove_modifier = Artificial_Core
			remove_modifier = Fast_Rotation
			remove_modifier = Exotic_Spices
			remove_modifier = Sandstorms
			remove_modifier = Sand_Tornadoes
			remove_modifier = Silicon_Crystals
			remove_modifier = Quicksand
			remove_modifier = Furry_Packs
			remove_modifier = Blizzards
			remove_modifier = Abominable_Predators
			remove_modifier = Rich_Soil
			remove_modifier = Otherworldly_Colours
			remove_modifier = Misty
			remove_modifier = Ecological_Nervous_System
			remove_modifier = Carnivorous_Flies
			remove_modifier = Algae_Boom
			remove_modifier = Ocean_Forests
			remove_modifier = Warm_Water_Lakes
			remove_modifier = Torrential_Rainstorms
			remove_modifier = Ocean_Currents
			remove_modifier = Ocean_Ridges
			remove_modifier = Ocean_Trenches
			remove_modifier = Unique_Marine_Habitats
			remove_modifier = Massive_Waves
			remove_modifier = Extinct_Species
			remove_modifier = Ghost_Ships
			remove_modifier = Omnious_Fog
			remove_modifier = Musical_Creatures 
			remove_modifier = Odd_Cloud_Shapes 
			remove_modifier = Giant_Mold_Blobs
			remove_modifier = Subterranean_Eco_System 
			remove_modifier = Massive_Waterfalls
			remove_modifier = Strange_Alien_Eggs
			remove_modifier = Beautiful_Planet_Rings
		}
	}
}

### Fallen Empire Planet Modifiers
event = {
	id = pm_game_start.78872
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		log = "---- Fired Event pm_gamestart.78872 ----"
		#log = "---- On Planet: [This.GetName] ----"
		log = "---- spawning fallen empire modifiers ----"
		# every_country = {
			# limit = {
				# OR = { 
					# has_country_flag = fallen_empire_1
					# has_country_flag = fallen_empire_2
					# has_country_flag = fallen_empire_3
					# has_country_flag = fallen_empire_4
					# has_country_flag = fallen_empire_militarist
				# }
			# }
			# solar_system = {
				# every_system_planet = {
					# if = {
						# limit = { is_capital = yes }
						# set_planet_flag = pm_fallen_empire_capital
						# c_random_modifier_fallen_empire = yes
					# }
					# if = {
						# limit = {
							# AND = {
								# is_colony = yes
								# NOT = { is_capital = yes }
							# }
						# }
						# set_planet_flag = pm_fallen_empire_colony
						# c_random_modifier_fallen_empire_chance = yes
					# }
				# }
			# }
		# }
		every_planet = {
			if = {
				limit = {
					AND = {
						is_capital = yes
						has_owner = yes
						owner = {
							OR = {
								has_country_flag = fallen_empire_1
								has_country_flag = fallen_empire_2
								has_country_flag = fallen_empire_3
								has_country_flag = fallen_empire_4
								has_country_flag = fallen_empire_militarist
							}
						}
						#has_planet_flag = pm_fallen_empire_capital
					}
				}
				c_random_modifier_fallen_empire = yes
				c_random_modifier_fallen_empire_chance = yes
				c_random_modifier_fallen_empire_chance = yes
			}
			if = {
				limit = {
					AND = {
						NOT = { is_capital = yes }
						is_colony = yes
						has_owner = yes
						owner = {
							OR = {
								has_country_flag = fallen_empire_1
								has_country_flag = fallen_empire_2
								has_country_flag = fallen_empire_3
								has_country_flag = fallen_empire_4
								has_country_flag = fallen_empire_militarist
							}
						}
						#has_planet_flag = pm_fallen_empire_colony
					}
				}
				c_random_modifier_fallen_empire_chance = yes
				c_random_modifier_fallen_empire_chance = yes
				c_random_modifier_fallen_empire_chance = yes
			}
		}
	}
}

### Roll precursor modifiers on empty ringworlds not owned by anyone.
event = {
	id = pm_game_start.78873
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		log = "---- Fired Event pm_gamestart.78873 ----"
		#log = "---- On Planet: [This.GetName] ----"
		log = "---- rolling precursor modifiers on non-owned ringworlds ----"
		every_planet = {
			limit = {
				if = {
					AND = {
						is_ringworld = yes
						solar_system = {
							NOT = { exists = space_owner }
						}
					}
				}
			}
			c_random_modifier_precursor_chance = yes
			c_random_modifier_precursor_chance = yes
			c_random_modifier_precursor_chance = yes
		}
	}
}

### Spawn unique tile blockers on every planet with the right modifier. Spawn resources where needed.
event = {
	id = pm_game_start.78874
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		log = "---- Fired Event pm_gamestart.78874 ----"
		#log = "---- On Planet: [This.GetName] ----"
		log = "---- spawning unique tile blockers ----"
		every_planet = {
			c_spawn_special_blockers = yes
			if = {
				limit = { has_modifier = Friendly_Wildlife }
				random_tile = {
					limit = {
						AND = {
							has_building = no
							has_pop = no
						}
					}
					clear_deposits = yes
					add_deposit = d_alien_pets_deposit
				}
			}
		}
	}
}

### add terraform canditate if planet has a precursor/interesting modifier and is of specific class
event = {
	id = pm_game_start.78875
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		log = "---- Fired Event pm_gamestart.78875 ----"
		#log = "---- On Planet: [This.GetName] ----"
		log = "---- adding terraforming candidate/valuable world candidate modifiers ----"
		every_planet = {
			if = {
				limit = {
					if = {
						AND = {
							OR = {
								is_planet_class = pc_molten
								is_planet_class = pc_toxic
								is_planet_class = pc_frozen
								is_planet_class = pc_barren
								is_planet_class = pc_barren_cold
							}
							OR = {
								c_has_precursor_modifiers = yes
								has_modifier = Unnatural_World
								has_modifier = ultra_rich_2
								has_modifier = Spaceship_Graveyard
								has_modifier = Old_World
								has_modifier = Artificial_Core
							}
							NOT = {
								OR = {
									has_modifier = terraforming_candidate 
									has_modifier = terraforming_candidate_precursor
								}
							}
						}
					}
				}
				add_modifier = { modifier = terraforming_candidate_precursor days = -1 }
			}
		}
	}
}

### sets global flag “has_guillis_planet_modifiers_mod”
event = {
	id = pm_game_start.78876
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		log = "---- Fired Event pm_gamestart.78876 ----"
		#log = "---- On Planet: [This.GetName] ----"
		log = "---- setting global flag has_guillis_planet_modifiers_mod ----"
		set_global_flag = "has_guillis_planet_modifiers_mod"
	}
}

### Changes planet graphics depending on modifiers
event = {
	id = pm_game_start.78877
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		log = "---- Fired Event pm_gamestart.78877 ----"
		#log = "---- On Planet: [This.GetName] ----"
		log = "---- changing planet graphics for specific modifiers ----"
		every_planet = {
			c_planet_graphics = yes
		}
	}
}

### Spawn Natural Planet Wonders vanilla worlds
event = {
	id = pm_game_start.78878
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		NOR = {
			has_global_flag = star_trek_new_horizons 
			any_system = { 
				any_planet = { 
					is_planet_class = pc_geocrystalline 
				}
			}
		}
	}
	
	immediate = {
		log = "---- Fired Event pm_gamestart.78878 ----"
		#log = "---- On Planet: [This.GetName] ----"
		log = "---- spawning planet wonders on vanilla planets ----"
		random_list = {
			100 = {}
			50 ={
				random_planet = {
					limit = {
						AND = {
							is_planet_class = pc_desert
							is_colony = no
							is_capital = no
							planet_size > 16
							NOT = { num_pops > 0 }
							NOT = { has_planet_flag = "pm_is_wondrous_world" }
							NOT = {	c_has_precursor_modifiers = yes	}
						}
					}
					set_planet_flag = "pm_is_wondrous_world"
					c_spawn_planet_wonders_desert = yes
					add_modifier = { modifier = "Planet_Wonder_Discovered" days = -1 }
				}
			}
		}
		random_list = {
			100 = {}
			50 ={
				random_planet = {
					limit = {
						AND = {
							is_planet_class = pc_arid
							is_colony = no
							is_capital = no
							planet_size > 16
							NOT = { num_pops > 0 }
							NOT = { has_planet_flag = "pm_is_wondrous_world" }
							NOT = {	c_has_precursor_modifiers = yes	}
						}
					}
					set_planet_flag = "pm_is_wondrous_world"
					c_spawn_planet_wonders_arid = yes
					add_modifier = { modifier = "Planet_Wonder_Discovered" days = -1 }
				}
			}
		}
		random_list = {
			100 = {}
			50 ={
				random_planet = {
					limit = {
						AND = {
							is_planet_class = pc_tropical
							is_colony = no
							is_capital = no
							planet_size > 16
							NOT = { num_pops > 0 }
							NOT = { has_planet_flag = "pm_is_wondrous_world" }
							NOT = {	c_has_precursor_modifiers = yes	}
						}
					}
					set_planet_flag = "pm_is_wondrous_world"
					c_spawn_planet_wonders_tropical = yes
					add_modifier = { modifier = "Planet_Wonder_Discovered" days = -1 }
				}
			}
		}
		random_list = {
			100 = {}
			50 ={
				random_planet = {
					limit = {
						AND = {
							is_planet_class = pc_continental
							is_colony = no
							is_capital = no
							planet_size > 16
							NOT = { num_pops > 0 }
							NOT = { has_planet_flag = "pm_is_wondrous_world" }
							NOT = {	c_has_precursor_modifiers = yes	}
						}
					}
					set_planet_flag = "pm_is_wondrous_world"
					c_spawn_planet_wonders_continental = yes
					add_modifier = { modifier = "Planet_Wonder_Discovered" days = -1 }
				}
			}
		}
		random_list = {
			100 = {}
			50 ={
				random_planet = {
					limit = {
						AND = {
							is_planet_class = pc_ocean
							is_colony = no
							is_capital = no
							planet_size > 16
							NOT = { num_pops > 0 }
							NOT = { has_planet_flag = "pm_is_wondrous_world" }
							NOT = {	c_has_precursor_modifiers = yes	}
						}
					}
					set_planet_flag = "pm_is_wondrous_world"
					c_spawn_planet_wonders_ocean = yes
					add_modifier = { modifier = "Planet_Wonder_Discovered" days = -1 }
				}
			}
		}
		random_list = {
			100 = {}
			50 ={
				random_planet = {
					limit = {
						AND = {
							is_planet_class = pc_arctic
							is_colony = no
							is_capital = no
							planet_size > 16
							NOT = { num_pops > 0 }
							NOT = { has_planet_flag = "pm_is_wondrous_world" }
							NOT = {	c_has_precursor_modifiers = yes	}
						}
					}
					set_planet_flag = "pm_is_wondrous_world"
					c_spawn_planet_wonders_arctic = yes
					add_modifier = { modifier = "Planet_Wonder_Discovered" days = -1 }
				}
			}
		}
		random_list = {
			100 = {}
			50 ={
				random_planet = {
					limit = {
						AND = {
							is_planet_class = pc_alpine
							is_colony = no
							is_capital = no
							planet_size > 16
							NOT = { num_pops > 0 }
							NOT = { has_planet_flag = "pm_is_wondrous_world" }
							NOT = {	c_has_precursor_modifiers = yes	}
						}
					}
					set_planet_flag = "pm_is_wondrous_world"
					c_spawn_planet_wonders_alpine = yes
					add_modifier = { modifier = "Planet_Wonder_Discovered" days = -1 }
				}
			}
		}
		random_list = {
			100 = {}
			50 ={
				random_planet = {
					limit = {
						AND = {
							is_planet_class = pc_tundra
							is_colony = no
							is_capital = no
							planet_size > 16
							NOT = { num_pops > 0 }
							NOT = { has_planet_flag = "pm_is_wondrous_world" }
							NOT = {	c_has_precursor_modifiers = yes	}
						}
					}
					set_planet_flag = "pm_is_wondrous_world"
					c_spawn_planet_wonders_tundra = yes
					add_modifier = { modifier = "Planet_Wonder_Discovered" days = -1 }
				}
			}
		}
		random_list = {
			100 = {}
			50 ={
				random_planet = {
					limit = {
						AND = {
							is_planet_class = pc_gaia
							is_colony = no
							is_capital = no
							planet_size > 16
							NOT = { num_pops > 0 }
							NOT = { has_planet_flag = "pm_is_wondrous_world" }
							NOT = {	c_has_precursor_modifiers = yes	}
						}
					}
					set_planet_flag = "pm_is_wondrous_world"
					c_spawn_planet_wonders_gaia = yes
					add_modifier = { modifier = "Planet_Wonder_Discovered" days = -1 }
				}
			}
		}
		random_list = {
			100 = {}
			50 ={
				random_planet = {
					limit = {
						AND = {
							is_planet_class = pc_nuked
							is_colony = no
							is_capital = no
							planet_size > 16
							NOT = { num_pops > 0 }
							NOT = { has_planet_flag = "pm_is_wondrous_world" }
							NOT = {	c_has_precursor_modifiers = yes	}
						}
					}
					set_planet_flag = "pm_is_wondrous_world"
					c_spawn_planet_wonders_nuked = yes
					add_modifier = { modifier = "Planet_Wonder_Discovered" days = -1 }
				}
			}
		}
	}
}

### Spawn Natural Planet Wonders all worlds including mods
event = {
	id = pm_game_start.78879
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		NOR = {
			has_global_flag = star_trek_new_horizons 
			any_system = { 
				any_planet = { 
					is_planet_class = pc_geocrystalline 
				}
			}
		}
	}
	
	immediate = {
		log = "---- Fired Event pm_gamestart.78879 ----"
		#log = "---- On Planet: [This.GetName] ----"
		log = "---- spawning planet wonders on vanilla + mod planets at random ----"
		random_list = {
			200 = {}
			50 ={
				random_planet = {
					limit = {
						AND = {
							pm_is_planet_dry_hot = yes
							NOR = { 
								is_planet_class = pc_toxic
								is_planet_class = pc_desert
								is_planet_class = pc_arid
								is_planet_class = pc_savannah
								is_planet_class = pc_tropical
								is_planet_class = pc_continental
								is_planet_class = pc_ocean
								is_planet_class = pc_tundra
								is_planet_class = pc_nuked
								is_planet_class = pc_machine
							}
							is_colony = no
							is_capital = no
							planet_size > 16
							NOT = { num_pops > 0 }
							NOT = { has_planet_flag = "pm_is_wondrous_world" }
							NOT = {	c_has_precursor_modifiers = yes	}
						}
					}
					set_planet_flag = "pm_is_wondrous_world"
					c_spawn_planet_wonders_any = yes
					add_modifier = { modifier = "Planet_Wonder_Discovered" days = -1 }
				}
			}
		}
		random_list = {
			200 = {}
			50 ={
				random_planet = {
					limit = {
						AND = {
							pm_is_planet_dry_cold = yes
							NOR = { 
								is_planet_class = pc_toxic
								is_planet_class = pc_desert
								is_planet_class = pc_arid
								is_planet_class = pc_savannah
								is_planet_class = pc_tropical
								is_planet_class = pc_continental
								is_planet_class = pc_ocean
								is_planet_class = pc_tundra
								is_planet_class = pc_nuked
								is_planet_class = pc_machine
							}
							is_colony = no
							is_capital = no
							planet_size > 16
							NOT = { num_pops > 0 }
							NOT = { has_planet_flag = "pm_is_wondrous_world" }
							NOT = {	c_has_precursor_modifiers = yes	}
						}
					}
					set_planet_flag = "pm_is_wondrous_world"
					c_spawn_planet_wonders_any = yes
					add_modifier = { modifier = "Planet_Wonder_Discovered" days = -1 }
				}
			}
		}
		random_list = {
			200 = {}
			50 ={
				random_planet = {
					limit = {
						AND = {
							pm_is_planet_wet_hot = yes
							NOR = { 
								is_planet_class = pc_toxic
								is_planet_class = pc_desert
								is_planet_class = pc_arid
								is_planet_class = pc_savannah
								is_planet_class = pc_tropical
								is_planet_class = pc_continental
								is_planet_class = pc_ocean
								is_planet_class = pc_tundra
								is_planet_class = pc_nuked
								is_planet_class = pc_machine
							}
							is_colony = no
							is_capital = no
							planet_size > 16
							NOT = { num_pops > 0 }
							NOT = { has_planet_flag = "pm_is_wondrous_world" }
							NOT = {	c_has_precursor_modifiers = yes	}
						}
					}
					set_planet_flag = "pm_is_wondrous_world"
					c_spawn_planet_wonders_any = yes
					add_modifier = { modifier = "Planet_Wonder_Discovered" days = -1 }
				}
			}
		}
		random_list = {
			200 = {}
			50 ={
				random_planet = {
					limit = {
						AND = {
							pm_is_planet_wet_cold = yes
							NOR = { 
								is_planet_class = pc_toxic
								is_planet_class = pc_desert
								is_planet_class = pc_arid
								is_planet_class = pc_savannah
								is_planet_class = pc_tropical
								is_planet_class = pc_continental
								is_planet_class = pc_ocean
								is_planet_class = pc_tundra
								is_planet_class = pc_nuked
								is_planet_class = pc_machine
							}
							is_colony = no
							is_capital = no
							planet_size > 16
							NOT = { num_pops > 0 }
							NOT = { has_planet_flag = "pm_is_wondrous_world" }
							NOT = {	c_has_precursor_modifiers = yes	}
						}
					}
					set_planet_flag = "pm_is_wondrous_world"
					c_spawn_planet_wonders_any = yes
					add_modifier = { modifier = "Planet_Wonder_Discovered" days = -1 }
				}
			}
		}
		random_list = {
			200 = {}
			50 ={
				random_planet = {
					limit = {
						AND = {
							pm_is_planet_exotic = yes
							NOR = { 
								is_planet_class = pc_toxic
								is_planet_class = pc_desert
								is_planet_class = pc_arid
								is_planet_class = pc_savannah
								is_planet_class = pc_tropical
								is_planet_class = pc_continental
								is_planet_class = pc_ocean
								is_planet_class = pc_tundra
								is_planet_class = pc_nuked
								is_planet_class = pc_machine
							}
							is_colony = no
							is_capital = no
							planet_size > 16
							NOT = { num_pops > 0 }
							NOT = { has_planet_flag = "pm_is_wondrous_world" }
							NOT = {	c_has_precursor_modifiers = yes	}
						}
					}
					set_planet_flag = "pm_is_wondrous_world"
					c_spawn_planet_wonders_any = yes
					add_modifier = { modifier = "Planet_Wonder_Discovered" days = -1 }
				}
			}
		}
		random_list = {
			200 = {}
			50 ={
				random_planet = {
					limit = {
						AND = {
							pm_is_planet_habital_planetary_diversity = yes
							NOT = { is_planet_class = pc_toxic }
							is_colony = no
							is_capital = no
							planet_size > 16
							NOT = { num_pops > 0 }
							NOT = { has_planet_flag = "pm_is_wondrous_world" }
							NOT = {	c_has_precursor_modifiers = yes	}
						}
					}
					set_planet_flag = "pm_is_wondrous_world"
					c_spawn_planet_wonders_any = yes
					add_modifier = { modifier = "Planet_Wonder_Discovered" days = -1 }
				}
			}
		}
		random_list = {
			200 = {}
			50 ={
				random_planet = {
					limit = {
						AND = {
							pm_is_planet_habital_star_trek_new_worlds = yes
							NOT = { is_planet_class = pc_toxic }
							is_colony = no
							is_capital = no
							planet_size > 16
							NOT = { num_pops > 0 }
							NOT = { has_planet_flag = "pm_is_wondrous_world" }
							NOT = {	c_has_precursor_modifiers = yes	}
						}
					}
					set_planet_flag = "pm_is_wondrous_world"
					c_spawn_planet_wonders_any = yes
					add_modifier = { modifier = "Planet_Wonder_Discovered" days = -1 }
				}
			}
		}
		random_list = {
			200 = {}
			50 ={
				random_planet = {
					limit = {
						AND = {
							pm_is_planet_habital_star_trek_new_horizons = yes
							NOT = { is_planet_class = pc_toxic }
							is_colony = no
							is_capital = no
							planet_size > 16
							NOT = { num_pops > 0 }
							NOT = { has_planet_flag = "pm_is_wondrous_world" }
							NOT = {	c_has_precursor_modifiers = yes	}
						}
					}
					set_planet_flag = "pm_is_wondrous_world"
					c_spawn_planet_wonders_any = yes
					add_modifier = { modifier = "Planet_Wonder_Discovered" days = -1 }
				}
			}
		}
	}
}

# global initialisation
### set planet flags for precursors worlds and turn some into tomb worlds
### duplicate asteroids for binary asteroid modifier
### duplicate pulsar for binary pulsar modifier
event = {
	id = pm_game_start.78880
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		log = "---- Fired Event pm_gamestart.78880 ----"
		#log = "---- On Planet: [This.GetName] ----"
		log = "---- setting precursor world flags ----"
		every_planet = {
			if = {
				limit = {
					c_has_precursor_modifiers = yes
				}
				set_planet_flag = "pm_is_precursor_world"
				if = {
					limit = {
						OR = {
							is_planet_class = pc_molten
							is_planet_class = pc_barren
							is_planet_class = pc_barren_cold
							is_planet_class = pc_toxic
							is_planet_class = pc_frozen
						}
					}
					random_list = {
						50 = { 
							change_pc = pc_nuked
							c_crisis_purge_modifiers = yes
							c_random_modifier_precursor_chance = yes
							c_random_modifier_crisis_purge = yes
							c_random_modifier_crisis_purge = yes
							reroll_deposits = yes
							#reroll_blockers = yes
							c_spawn_special_blockers = yes
							if = {
								limit = {
									planet_size < 10
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_dangerous_wildlife"				
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_radioactive_wasteland"				
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_radioactive_wasteland"				
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_city_ruins"				
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_bomb_crater"				
								}
							}
							if = {
								limit = {
									AND = {
										planet_size < 14
										planet_size > 9
									}
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_dangerous_wildlife"				
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_radioactive_wasteland"				
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_radioactive_wasteland"				
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_radioactive_wasteland"				
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_city_ruins"				
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_bomb_crater"				
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_bomb_crater"				
								}
							}
							if = {
								limit = {
									AND = {
										planet_size < 20
										planet_size > 13
									}
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_dangerous_wildlife"				
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_radioactive_wasteland"				
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_radioactive_wasteland"				
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_city_ruins"				
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_city_ruins"				
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_city_ruins"				
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_bomb_crater"				
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_bomb_crater"				
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_bomb_crater"				
								}
							}
							if = {
								limit = {
									planet_size > 19
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_dangerous_wildlife"				
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_dangerous_wildlife"				
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_radioactive_wasteland"				
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_radioactive_wasteland"				
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_radioactive_wasteland"				
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_radioactive_wasteland"				
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_city_ruins"				
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_city_ruins"				
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_bomb_crater"				
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_bomb_crater"				
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_bomb_crater"				
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_bomb_crater"				
								}
								random_tile = {
									limit = { has_blocker = no has_building = no }
									set_blocker = "tb_bomb_crater"				
								}
							}
							if = {
								limit = { has_modifier = terraforming_candidate }
								remove_modifier = terraforming_candidate
							}
							if = {
								limit = { has_modifier = terraforming_candidate_precursor }
								remove_modifier = terraforming_candidate_precursor
							}
						}
						450 = { }
					}
				}
			}
			# adds rings to worlds with ring modifiers
			if = {
				limit = {
					has_modifier = Beautiful_Planet_Rings
				}
				set_ring = yes 
			}
			# Duplicate asteroid 
			if = {
				limit = {
					AND = {
						has_modifier = Binary_Asteroids
						NOT = { has_planet_flag = pm_binary_asteroid }
					}
				}
				save_event_target_as = pm_double_asteroid
				solar_system = {
					spawn_planet = {
						class = "pc_asteroid"
						location = event_target:pm_double_asteroid
						orbit_location = no
						orbit_angle_offset = 5
						orbit_distance_offset = -4.0
						size = 20
						has_ring = no
						
						init_effect = {
							set_name = pm_binary_asteroids
							set_planet_entity = {
								entity = "asteroid_entity"
							}
							surveyed = {
								set_surveyed = no
							}
							reroll_planet = yes
							set_planet_flag = pm_binary_asteroid
							if = {
								limit= { NOT = { has_modifier = Binary_Asteroids } }
								add_modifier = { modifier = Binary_Asteroids days = -1 }
							}
						}
					}
				}
				set_planet_flag = pm_binary_asteroid
			}
			# Duplicate pulsar 
			if = {
				limit = {
					AND = {
						has_modifier = Resonant_Twins
						NOT = { has_planet_flag = pm_binary_pulsar }
					}
				}
				save_event_target_as = pm_double_pulsar
				solar_system = {
					spawn_planet = {
						class = "pc_pulsar"
						location = event_target:pm_double_pulsar
						orbit_location = yes
						orbit_angle = { min = 0 max = 360 }
						orbit_distance_offset = 30.0
						size = 25
						has_ring = no
						
						init_effect = {
							set_name = pm_binary_pulsars
							set_planet_entity = {
								entity = "pulsar_entity"
							}
							surveyed = {
								set_surveyed = no
							}
							set_planet_flag = pm_binary_pulsar
							if = {
								limit= { NOT = { has_modifier = Resonant_Twins } }
								add_modifier = { modifier = Resonant_Twins days = -1 }
							}
						}
					}
				}
				set_planet_flag = pm_binary_pulsar
			}
		}
	}
}
