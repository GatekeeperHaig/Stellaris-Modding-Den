namespace = ex_spaceport_events

event = { #this event fires on game start, firing ex_spaceport_events.2
	id = ex_spaceport_events.0
	hide_window = yes
	is_triggered_only = yes

	immediate = { 
		every_country = { 
			limit = { is_country_type = default }
			every_owned_planet = { planet_event = { id = ex_spaceport_events.2 } }
		}
	}	
}

ship_event = { #this event fires the moment a spaceport is built, firing in turn ex_spaceport_events.2
	id = ex_spaceport_events.1
	hide_window = yes
	is_triggered_only = yes

	immediate = { from = { planet_event = { id = ex_spaceport_events.2 } } }		
}

planet_event = { #this event deletes the default spaceports and replaces them with spaceports with a custom initial module (different graphics - and not tied to sections)
	id = ex_spaceport_events.2
	hide_window = yes

	trigger = {
		has_spaceport = yes
		OR = {
			has_spaceport_module = projectile_weapon
			has_spaceport_module = laser_weapon
			has_spaceport_module = missile_weapon
		}	
	}	
	
	immediate = {
		if = {
			limit = { has_spaceport_module = projectile_weapon }
			spaceport = { delete_ship = this } 
			create_spaceport = {
				owner = root
				initial_module = "ex_projectile_weapon"
			}
			set_spaceport_level = 1		
			planet_event = { id = ex_spaceport_events.10 } 
		}
		if = {
			limit = { has_spaceport_module = laser_weapon }
			spaceport = { delete_ship = this } 
			create_spaceport = {
				owner = root
				initial_module = "ex_laser_weapon"
			}
			set_spaceport_level = 1		
			planet_event = { id = ex_spaceport_events.10 } 
		}
		if = {
			limit = { has_spaceport_module = missile_weapon }
			spaceport = { delete_ship = this } 
			create_spaceport = {
				owner = root
				initial_module = "ex_missile_weapon"
			}
			set_spaceport_level = 1		
			planet_event = { id = ex_spaceport_events.10 } 
		}	
	}
}				

planet_event = {
	id = ex_spaceport_events.10
	hide_window = yes

	trigger = {
		has_spaceport = yes
		is_spaceport_module_slot_free = 1
	}

	immediate = {
		if = {
			limit = { has_spaceport_module = ex_projectile_weapon }
			if = {
				limit = { owner = { tier_1_kinetics = yes } }
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_1_tier_1" }
			}	
			if = {
				limit = { owner = { tier_2_kinetics = yes } }
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_1_tier_2" }
			}				
			if = {
				limit = { owner = { tier_3_kinetics = yes } }
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_1_tier_3" }
			}				
			if = {
				limit = { owner = { tier_4_kinetics = yes } }
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_1_tier_4" }
			}	
			if = {
				limit = { owner = { tier_5_kinetics = yes } }
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_1_tier_5" }
			}
		}	
		if = {
			limit = { has_spaceport_module = ex_laser_weapon }
			if = {
				limit = { owner = { tier_1_energy = yes } }
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_1_tier_1" }
			}	
			if = {
				limit = { owner = { tier_2_energy = yes } }
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_1_tier_2" }
			}				
			if = {
				limit = { owner = { tier_3_energy = yes } }
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_1_tier_3" }
			}				
			if = {
				limit = { owner = { tier_4_energy = yes } }
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_1_tier_4" }
			}	
			if = {
				limit = { owner = { tier_5_energy = yes } }
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_1_tier_5" }
			}
		}	
		if = {
			limit = { has_spaceport_module = ex_missile_weapon }
			if = {
				limit = { owner = { tier_1_explosives = yes } }
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_1_tier_1" }
			}	
			if = {
				limit = { owner = { tier_2_explosives = yes } }
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_1_tier_2" }
			}				
			if = {
				limit = { owner = { tier_3_explosives = yes } }
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_1_tier_3" }
			}				
			if = {
				limit = { owner = { tier_4_explosives = yes } }
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_1_tier_4" }
			}	
			if = {
				limit = { owner = { tier_5_explosives = yes } }
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_1_tier_5" }
			}
		}					
		set_planet_flag = ex_spaceport_1
	}
}

planet_event = {
	id = ex_spaceport_events.11
	hide_window = yes

	trigger = {
		has_spaceport = yes
		is_spaceport_module_slot_free = 2
		NOT = { 
			has_planet_flag = ex_spaceport_2
			has_planet_flag = ex_spaceport_3
			has_planet_flag = ex_spaceport_4
			has_planet_flag = ex_spaceport_5
			has_planet_flag = ex_spaceport_6
			has_planet_flag = ex_spaceport_7
			has_planet_flag = ex_spaceport_8
			has_planet_flag = ex_spaceport_9
		}
	}

	immediate = {
		if = {
			limit = { has_spaceport_module = ex_projectile_weapon }
			remove_level_1_core_module_kinetic = yes
			if = {
				limit = { owner = { tier_1_kinetics = yes } }
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_2_tier_1" }				
			}	
			if = {
				limit = { owner = { tier_2_kinetics = yes } }
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_2_tier_2" }
			}				
			if = {
				limit = { owner = { tier_3_kinetics = yes } }
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_2_tier_3" }
			}				
			if = {
				limit = { owner = { tier_4_kinetics = yes } }
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_2_tier_4" }
			}	
			if = {
				limit = { owner = { tier_5_kinetics = yes } }
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_2_tier_5" }
			}
		}	
		if = {
			limit = { has_spaceport_module = ex_laser_weapon }
			remove_level_1_core_module_energy = yes
			if = {
				limit = { owner = { tier_1_energy = yes } }
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_2_tier_1" }
			}	
			if = {
				limit = { owner = { tier_2_energy = yes } }
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_2_tier_2" }
			}				
			if = {
				limit = { owner = { tier_3_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_2_tier_3" }
			}				
			if = {
				limit = { owner = { tier_4_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_2_tier_4" }
			}	
			if = {
				limit = { owner = { tier_5_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_2_tier_5" }
			}
		}	
		if = {
			limit = { has_spaceport_module = ex_missile_weapon }
			remove_level_1_core_module_explosives = yes
			if = {
				limit = { owner = { tier_1_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_2_tier_1" }
			}	
			if = {
				limit = { owner = { tier_2_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_2_tier_2" }
			}				
			if = {
				limit = { owner = { tier_3_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_2_tier_3" }
			}				
			if = {
				limit = { owner = { tier_4_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_2_tier_4" }
			}	
			if = {
				limit = { owner = { tier_5_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_2_tier_5" }
			}
		}					
		remove_planet_flag = ex_spaceport_1
		set_planet_flag = ex_spaceport_2
	}
}

planet_event = {
	id = ex_spaceport_events.12
	hide_window = yes

	trigger = {
		has_spaceport = yes
		is_spaceport_module_slot_free = 3
		NOT = { 
			has_planet_flag = ex_spaceport_3
			has_planet_flag = ex_spaceport_4
			has_planet_flag = ex_spaceport_5
			has_planet_flag = ex_spaceport_6
			has_planet_flag = ex_spaceport_7
			has_planet_flag = ex_spaceport_8
			has_planet_flag = ex_spaceport_9
		}
	}

	immediate = {
		if = {
			limit = { has_spaceport_module = ex_projectile_weapon }
			remove_level_2_core_module_kinetic = yes
			if = {
				limit = { owner = { tier_1_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_3_tier_1" }				
			}	
			if = {
				limit = { owner = { tier_2_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_3_tier_2" }
			}				
			if = {
				limit = { owner = { tier_3_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_3_tier_3" }
			}				
			if = {
				limit = { owner = { tier_4_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_3_tier_4" }
			}	
			if = {
				limit = { owner = { tier_5_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_3_tier_5" }
			}
		}	
		if = {
			limit = { has_spaceport_module = ex_laser_weapon }
			remove_level_2_core_module_energy = yes
			if = {
				limit = { owner = { tier_1_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_3_tier_1" }
			}	
			if = {
				limit = { owner = { tier_2_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_3_tier_2" }
			}				
			if = {
				limit = { owner = { tier_3_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_3_tier_3" }
			}				
			if = {
				limit = { owner = { tier_4_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_3_tier_4" }
			}	
			if = {
				limit = { owner = { tier_5_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_3_tier_5" }
			}
		}	
		if = {
			limit = { has_spaceport_module = ex_missile_weapon }
			remove_level_2_core_module_explosives = yes
			if = {
				limit = { owner = { tier_1_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_3_tier_1" }
			}	
			if = {
				limit = { owner = { tier_2_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_3_tier_2" }
			}				
			if = {
				limit = { owner = { tier_3_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_3_tier_3" }
			}				
			if = {
				limit = { owner = { tier_4_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_3_tier_4" }
			}	
			if = {
				limit = { owner = { tier_5_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_3_tier_5" }
			}
		}					
		remove_planet_flag = ex_spaceport_2
		set_planet_flag = ex_spaceport_3
	}
}

planet_event = {
	id = ex_spaceport_events.13
	hide_window = yes

	trigger = {
		has_spaceport = yes
		is_spaceport_module_slot_free = 4
		NOT = { 
			has_planet_flag = ex_spaceport_4
			has_planet_flag = ex_spaceport_5
			has_planet_flag = ex_spaceport_6
			has_planet_flag = ex_spaceport_7
			has_planet_flag = ex_spaceport_8
			has_planet_flag = ex_spaceport_9
		}
	}

	immediate = {
		if = {
			limit = { has_spaceport_module = ex_projectile_weapon }
			remove_level_3_core_module_kinetic = yes
			if = {
				limit = { owner = { tier_1_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_4_tier_1" }				
			}	
			if = {
				limit = { owner = { tier_2_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_4_tier_2" }
			}				
			if = {
				limit = { owner = { tier_3_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_4_tier_3" }
			}				
			if = {
				limit = { owner = { tier_4_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_4_tier_4" }
			}	
			if = {
				limit = { owner = { tier_5_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_4_tier_5" }
			}
		}	
		if = {
			limit = { has_spaceport_module = ex_laser_weapon }
			remove_level_3_core_module_energy = yes
			if = {
				limit = { owner = { tier_1_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_4_tier_1" }
			}	
			if = {
				limit = { owner = { tier_2_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_4_tier_2" }
			}				
			if = {
				limit = { owner = { tier_3_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_4_tier_3" }
			}				
			if = {
				limit = { owner = { tier_4_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_4_tier_4" }
			}	
			if = {
				limit = { owner = { tier_5_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_4_tier_5" }
			}
		}	
		if = {
			limit = { has_spaceport_module = ex_missile_weapon }
			remove_level_3_core_module_explosives = yes
			if = {
				limit = { owner = { tier_1_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_4_tier_1" }
			}	
			if = {
				limit = { owner = { tier_2_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_4_tier_2" }
			}				
			if = {
				limit = { owner = { tier_3_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_4_tier_3" }
			}				
			if = {
				limit = { owner = { tier_4_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_4_tier_4" }
			}	
			if = {
				limit = { owner = { tier_5_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_4_tier_5" }
			}
		}					
		remove_planet_flag = ex_spaceport_3
		set_planet_flag = ex_spaceport_4
	}
}

planet_event = {
	id = ex_spaceport_events.14
	hide_window = yes

	trigger = {
		has_spaceport = yes
		is_spaceport_module_slot_free = 5
		NOT = { 
			has_planet_flag = ex_spaceport_5
			has_planet_flag = ex_spaceport_6
			has_planet_flag = ex_spaceport_7
			has_planet_flag = ex_spaceport_8
			has_planet_flag = ex_spaceport_9
		}
	}

	immediate = {
		if = {
			limit = { has_spaceport_module = ex_projectile_weapon }
			remove_level_4_core_module_kinetic = yes
			if = {
				limit = { owner = { tier_1_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_5_tier_1" }				
			}	
			if = {
				limit = { owner = { tier_2_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_5_tier_2" }
			}				
			if = {
				limit = { owner = { tier_3_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_5_tier_3" }
			}				
			if = {
				limit = { owner = { tier_4_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_5_tier_4" }
			}	
			if = {
				limit = { owner = { tier_5_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_5_tier_5" }
			}
		}	
		if = {
			limit = { has_spaceport_module = ex_laser_weapon }
			remove_level_4_core_module_energy = yes
			if = {
				limit = { owner = { tier_1_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_5_tier_1" }
			}	
			if = {
				limit = { owner = { tier_2_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_5_tier_2" }
			}				
			if = {
				limit = { owner = { tier_3_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_5_tier_3" }
			}				
			if = {
				limit = { owner = { tier_4_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_5_tier_4" }
			}	
			if = {
				limit = { owner = { tier_5_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_5_tier_5" }
			}
		}	
		if = {
			limit = { has_spaceport_module = ex_missile_weapon }
			remove_level_4_core_module_explosives = yes
			if = {
				limit = { owner = { tier_1_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_5_tier_1" }
			}	
			if = {
				limit = { owner = { tier_2_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_5_tier_2" }
			}				
			if = {
				limit = { owner = { tier_3_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_5_tier_3" }
			}				
			if = {
				limit = { owner = { tier_4_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_5_tier_4" }
			}	
			if = {
				limit = { owner = { tier_5_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_5_tier_5" }
			}
		}					
		remove_planet_flag = ex_spaceport_4
		set_planet_flag = ex_spaceport_5
	}
}

planet_event = {
	id = ex_spaceport_events.15
	hide_window = yes

	trigger = {
		has_spaceport = yes
		is_spaceport_module_slot_free = 6
		NOT = { 
			has_planet_flag = ex_spaceport_6
			has_planet_flag = ex_spaceport_7
			has_planet_flag = ex_spaceport_8
			has_planet_flag = ex_spaceport_9
		}
	}

	immediate = {
		if = {
			limit = { has_spaceport_module = ex_projectile_weapon }
			remove_level_5_core_module_kinetic = yes
			if = {
				limit = { owner = { tier_1_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_6_tier_1" }				
			}	
			if = {
				limit = { owner = { tier_2_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_6_tier_2" }
			}				
			if = {
				limit = { owner = { tier_3_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_6_tier_3" }
			}				
			if = {
				limit = { owner = { tier_4_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_6_tier_4" }
			}	
			if = {
				limit = { owner = { tier_5_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_6_tier_5" }
			}
		}	
		if = {
			limit = { has_spaceport_module = ex_laser_weapon }
			remove_level_5_core_module_energy = yes
			if = {
				limit = { owner = { tier_1_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_6_tier_1" }
			}	
			if = {
				limit = { owner = { tier_2_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_6_tier_2" }
			}				
			if = {
				limit = { owner = { tier_3_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_6_tier_3" }
			}				
			if = {
				limit = { owner = { tier_4_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_6_tier_4" }
			}	
			if = {
				limit = { owner = { tier_5_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_6_tier_5" }
			}
		}	
		if = {
			limit = { has_spaceport_module = ex_missile_weapon }
			remove_level_5_core_module_explosives = yes
			if = {
				limit = { owner = { tier_1_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_6_tier_1" }
			}	
			if = {
				limit = { owner = { tier_2_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_6_tier_2" }
			}				
			if = {
				limit = { owner = { tier_3_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_6_tier_3" }
			}				
			if = {
				limit = { owner = { tier_4_explosives = yes } }			
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_6_tier_4" }
			}	
			if = {
				limit = { owner = { tier_5_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_6_tier_5" }
			}
		}					
		remove_planet_flag = ex_spaceport_5
		set_planet_flag = ex_spaceport_6
	}
}

planet_event = {
	id = ex_spaceport_events.16
	hide_window = yes

	trigger = {
		has_spaceport = yes
		is_spaceport_module_slot_free = 7
		NOT = { 
			has_planet_flag = ex_spaceport_7
			has_planet_flag = ex_spaceport_8
			has_planet_flag = ex_spaceport_9
		}
	}

	immediate = {
		if = {
			limit = { has_spaceport_module = ex_projectile_weapon }
			remove_level_6_core_module_kinetic = yes
			if = {
				limit = { owner = { tier_1_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_7_tier_1" }				
			}	
			if = {
				limit = { owner = { tier_2_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_7_tier_2" }
			}				
			if = {
				limit = { owner = { tier_3_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_7_tier_3" }
			}				
			if = {
				limit = { owner = { tier_4_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_7_tier_4" }
			}	
			if = {
				limit = { owner = { tier_5_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_7_tier_5" }
			}
		}	
		if = {
			limit = { has_spaceport_module = ex_laser_weapon }
			remove_level_6_core_module_energy = yes
			if = {
				limit = { owner = { tier_1_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_7_tier_1" }
			}	
			if = {
				limit = { owner = { tier_2_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_7_tier_2" }
			}				
			if = {
				limit = { owner = { tier_3_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_7_tier_3" }
			}				
			if = {
				limit = { owner = { tier_4_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_7_tier_4" }
			}	
			if = {
				limit = { owner = { tier_5_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_7_tier_5" }
			}
		}	
		if = {
			limit = { has_spaceport_module = ex_missile_weapon }
			remove_level_6_core_module_explosives = yes
			if = {
				limit = { owner = { tier_1_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_7_tier_1" }
			}	
			if = {
				limit = { owner = { tier_2_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_7_tier_2" }
			}				
			if = {
				limit = { owner = { tier_3_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_7_tier_3" }
			}				
			if = {
				limit = { owner = { tier_4_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_7_tier_4" }
			}	
			if = {
				limit = { owner = { tier_5_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_7_tier_5" }
			}
		}					
		remove_planet_flag = ex_spaceport_6
		set_planet_flag = ex_spaceport_7
	}
}

planet_event = {
	id = ex_spaceport_events.17
	hide_window = yes

	trigger = {
		has_spaceport = yes
		is_spaceport_module_slot_free = 8
		NOT = { 
			has_planet_flag = ex_spaceport_8
			has_planet_flag = ex_spaceport_9
		}
	}

	immediate = {
		if = {
			limit = { has_spaceport_module = ex_projectile_weapon }
			remove_level_7_core_module_kinetic = yes
			if = {
				limit = { owner = { tier_1_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_8_tier_1" }				
			}	
			if = {
				limit = { owner = { tier_2_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_8_tier_2" }
			}				
			if = {
				limit = { owner = { tier_3_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_8_tier_3" }
			}				
			if = {
				limit = { owner = { tier_4_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_8_tier_4" }
			}	
			if = {
				limit = { owner = { tier_5_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_8_tier_5" }
			}
		}	
		if = {
			limit = { has_spaceport_module = ex_laser_weapon }
			remove_level_7_core_module_energy = yes
			if = {
				limit = { owner = { tier_1_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_8_tier_1" }
			}	
			if = {
				limit = { owner = { tier_2_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_8_tier_2" }
			}				
			if = {
				limit = { owner = { tier_3_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_8_tier_3" }
			}				
			if = {
				limit = { owner = { tier_4_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_8_tier_4" }
			}	
			if = {
				limit = { owner = { tier_5_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_8_tier_5" }
			}
		}	
		if = {
			limit = { has_spaceport_module = ex_missile_weapon }
			remove_level_7_core_module_explosives = yes
			if = {
				limit = { owner = { tier_1_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_8_tier_1" }
			}	
			if = {
				limit = { owner = { tier_2_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_8_tier_2" }
			}				
			if = {
				limit = { owner = { tier_3_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_8_tier_3" }
			}				
			if = {
				limit = { owner = { tier_4_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_8_tier_4" }
			}	
			if = {
				limit = { owner = { tier_5_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_8_tier_5" }
			}
		}					
		remove_planet_flag = ex_spaceport_7
		set_planet_flag = ex_spaceport_8
	}
}

planet_event = {
	id = ex_spaceport_events.18
	hide_window = yes

	trigger = {
		has_spaceport = yes
		is_spaceport_module_slot_free = 9
		NOT = { has_planet_flag = ex_spaceport_9 }
	}

	immediate = {
		if = {
			limit = { has_spaceport_module = ex_projectile_weapon }
			remove_level_8_core_module_kinetic = yes
			if = {
				limit = { owner = { tier_1_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_9_tier_1" }				
			}	
			if = {
				limit = { owner = { tier_2_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_9_tier_2" }
			}				
			if = {
				limit = { owner = { tier_3_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_9_tier_3" }
			}				
			if = {
				limit = { owner = { tier_4_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_9_tier_4" }
			}	
			if = {
				limit = { owner = { tier_5_kinetics = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_kinetic_level_9_tier_5" }
			}
		}	
		if = {
			limit = { has_spaceport_module = ex_laser_weapon }
			remove_level_8_core_module_energy = yes
			if = {
				limit = { owner = { tier_1_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_9_tier_1" }
			}	
			if = {
				limit = { owner = { tier_2_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_9_tier_2" }
			}				
			if = {
				limit = { owner = { tier_3_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_9_tier_3" }
			}				
			if = {
				limit = { owner = { tier_4_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_9_tier_4" }
			}	
			if = {
				limit = { owner = { tier_5_energy = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_energy_level_9_tier_5" }
			}
		}	
		if = {
			limit = { has_spaceport_module = ex_missile_weapon }
			remove_level_8_core_module_explosives = yes
			if = {
				limit = { owner = { tier_1_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_9_tier_1" }
			}	
			if = {
				limit = { owner = { tier_2_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_9_tier_2" }
			}				
			if = {
				limit = { owner = { tier_3_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_9_tier_3" }
			}				
			if = {
				limit = { owner = { tier_4_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_9_tier_4" }
			}	
			if = {
				limit = { owner = { tier_5_explosives = yes } }				
				set_spaceport_module = { slot = 1 module = "space_port_core_module_explosives_level_9_tier_5" }
			}
		}					
		remove_planet_flag = ex_spaceport_8
		set_planet_flag = ex_spaceport_9
	}
}