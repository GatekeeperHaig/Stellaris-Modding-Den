calculate_tile_weights = { #this runs on tile scope, and it saves the variables into the tile scope
	check_energy_deposit = yes
	check_mineral_deposit = yes
	check_unity_deposit = yes
	check_food_deposit = yes
	check_society_research_deposit = yes
	check_physics_research_deposit = yes		
	check_adj_bonus_buildings = yes
}

calculate_pop_weights = { #this runs on pop scope, and it saves the variables into the pop scope	
	check_pop_traits = yes
}	

calculate_planet_weights = { #this runs on planet scope, and it saves the variables into the planet scope	
	check_planet_bonus_buildings = yes
	check_planet_modifiers = yes
	check_planet_type = yes
}	

calculate_adjcancy_weights = { #this runs on tile scope, and it saves the variables into all the adj. tiles' scope
	if = { limit = { has_building = yes } check_adj_bonus_buildings = yes }
	if = { limit = { has_blocker = yes } check_adj_bonus_blockers = yes }
}
	
check_energy_deposit = {		
	if = {
		limit = { has_resource = { type = energy amount > 0 } }
		if = {
			limit = { has_resource = { type = energy amount = 1 } }
			change_variable = { which = energy_weight value = 1 }
			break = yes
		}
		if = {
			limit = { has_resource = { type = energy amount = 2 } }
			change_variable = { which = energy_weight value = 2 }
			break = yes
		}
		if = {
			limit = { has_resource = { type = energy amount = 3 } }
			change_variable = { which = energy_weight value = 3 }
			break = yes
		}	
		if = {
			limit = { has_resource = { type = energy amount = 4 } }
			change_variable = { which = energy_weight value = 4 }
			break = yes
		}	
		if = {
			limit = { has_resource = { type = energy amount = 5 } }
			change_variable = { which = energy_weight value = 5 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = energy amount = 6 } }
			change_variable = { which = energy_weight value = 6 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = energy amount = 7 } }
			change_variable = { which = energy_weight value = 7 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = energy amount = 8 } }
			change_variable = { which = energy_weight value = 8 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = energy amount = 9 } }
			change_variable = { which = energy_weight value = 9 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = energy amount = 10 } }
			change_variable = { which = energy_weight value = 10 }
			break = yes
		}		
		else = { break = yes }
	}
}	

check_mineral_deposit = {		
	if = {
		limit = { has_resource = { type = minerals amount > 0 } }
		if = {
			limit = { has_resource = { type = minerals amount = 1 } }
			change_variable = { which = minerals_weight value = 1 }
			break = yes
		}
		if = {
			limit = { has_resource = { type = minerals amount = 2 } }
			change_variable = { which = minerals_weight value = 2 }
			break = yes
		}
		if = {
			limit = { has_resource = { type = minerals amount = 3 } }
			change_variable = { which = minerals_weight value = 3 }
			break = yes
		}	
		if = {
			limit = { has_resource = { type = minerals amount = 4 } }
			change_variable = { which = minerals_weight value = 4 }
			break = yes
		}	
		if = {
			limit = { has_resource = { type = minerals amount = 5 } }
			change_variable = { which = minerals_weight value = 5 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = minerals amount = 6 } }
			change_variable = { which = minerals_weight value = 6 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = minerals amount = 7 } }
			change_variable = { which = minerals_weight value = 7 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = minerals amount = 8 } }
			change_variable = { which = minerals_weight value = 8 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = minerals amount = 9 } }
			change_variable = { which = minerals_weight value = 9 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = minerals amount = 10 } }
			change_variable = { which = minerals_weight value = 10 }
			break = yes
		}		
		else = { break = yes }
	}
}	

check_food_deposit = {		
	if = {
		limit = { has_resource = { type = food amount > 0 } }
		if = {
			limit = { has_resource = { type = food amount = 1 } }
			change_variable = { which = food_weight value = 1 }
			break = yes
		}
		if = {
			limit = { has_resource = { type = food amount = 2 } }
			change_variable = { which = food_weight value = 2 }
			break = yes
		}
		if = {
			limit = { has_resource = { type = food amount = 3 } }
			change_variable = { which = food_weight value = 3 }
			break = yes
		}	
		if = {
			limit = { has_resource = { type = food amount = 4 } }
			change_variable = { which = food_weight value = 4 }
			break = yes
		}	
		if = {
			limit = { has_resource = { type = food amount = 5 } }
			change_variable = { which = food_weight value = 5 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = food amount = 6 } }
			change_variable = { which = food_weight value = 6 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = food amount = 7 } }
			change_variable = { which = food_weight value = 7 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = food amount = 8 } }
			change_variable = { which = food_weight value = 8 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = food amount = 9 } }
			change_variable = { which = food_weight value = 9 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = food amount = 10 } }
			change_variable = { which = food_weight value = 10 }
			break = yes
		}		
		else = { break = yes }
	}
}	

check_unity_deposit = {		
	if = {
		limit = { has_resource = { type = unity amount > 0 } }
		if = {
			limit = { has_resource = { type = unity amount = 1 } }
			change_variable = { which = unity_weight value = 1 }
			break = yes
		}
		if = {
			limit = { has_resource = { type = unity amount = 2 } }
			change_variable = { which = unity_weight value = 2 }
			break = yes
		}
		if = {
			limit = { has_resource = { type = unity amount = 3 } }
			change_variable = { which = unity_weight value = 3 }
			break = yes
		}	
		if = {
			limit = { has_resource = { type = unity amount = 4 } }
			change_variable = { which = unity_weight value = 4 }
			break = yes
		}	
		if = {
			limit = { has_resource = { type = unity amount = 5 } }
			change_variable = { which = unity_weight value = 5 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = unity amount = 6 } }
			change_variable = { which = unity_weight value = 6 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = unity amount = 7 } }
			change_variable = { which = unity_weight value = 7 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = unity amount = 8 } }
			change_variable = { which = unity_weight value = 8 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = unity amount = 9 } }
			change_variable = { which = unity_weight value = 9 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = unity amount = 10 } }
			change_variable = { which = unity_weight value = 10 }
			break = yes
		}		
		else = { break = yes }
	}
}	

check_society_research_deposit = {		
	if = {
		limit = { has_resource = { type = society_research amount > 0 } }
		if = {
			limit = { has_resource = { type = society_research amount = 1 } }
			change_variable = { which = society_research_weight value = 1 }
			break = yes
		}
		if = {
			limit = { has_resource = { type = society_research amount = 2 } }
			change_variable = { which = society_research_weight value = 2 }
			break = yes
		}
		if = {
			limit = { has_resource = { type = society_research amount = 3 } }
			change_variable = { which = society_research_weight value = 3 }
			break = yes
		}	
		if = {
			limit = { has_resource = { type = society_research amount = 4 } }
			change_variable = { which = society_research_weight value = 4 }
			break = yes
		}	
		if = {
			limit = { has_resource = { type = society_research amount = 5 } }
			change_variable = { which = society_research_weight value = 5 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = society_research amount = 6 } }
			change_variable = { which = society_research_weight value = 6 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = society_research amount = 7 } }
			change_variable = { which = society_research_weight value = 7 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = society_research amount = 8 } }
			change_variable = { which = society_research_weight value = 8 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = society_research amount = 9 } }
			change_variable = { which = society_research_weight value = 9 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = society_research amount = 10 } }
			change_variable = { which = society_research_weight value = 10 }
			break = yes
		}		
		else = { break = yes }
	}
}	

check_physics_research_deposit = {		
	if = {
		limit = { has_resource = { type = physics_research amount > 0 } }
		if = {
			limit = { has_resource = { type = physics_research amount = 1 } }
			change_variable = { which = physics_research_weight value = 1 }
			break = yes
		}
		if = {
			limit = { has_resource = { type = physics_research amount = 2 } }
			change_variable = { which = physics_research_weight value = 2 }
			break = yes
		}
		if = {
			limit = { has_resource = { type = physics_research amount = 3 } }
			change_variable = { which = physics_research_weight value = 3 }
			break = yes
		}	
		if = {
			limit = { has_resource = { type = physics_research amount = 4 } }
			change_variable = { which = physics_research_weight value = 4 }
			break = yes
		}	
		if = {
			limit = { has_resource = { type = physics_research amount = 5 } }
			change_variable = { which = physics_research_weight value = 5 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = physics_research amount = 6 } }
			change_variable = { which = physics_research_weight value = 6 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = physics_research amount = 7 } }
			change_variable = { which = physics_research_weight value = 7 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = physics_research amount = 8 } }
			change_variable = { which = physics_research_weight value = 8 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = physics_research amount = 9 } }
			change_variable = { which = physics_research_weight value = 9 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = physics_research amount = 10 } }
			change_variable = { which = physics_research_weight value = 10 }
			break = yes
		}		
		else = { break = yes }
	}
}	

check_engineering_research_deposit = {		
	if = {
		limit = { has_resource = { type = engineering_research amount > 0 } }
		if = {
			limit = { has_resource = { type = engineering_research amount = 1 } }
			change_variable = { which = engineering_research_weight value = 1 }
			break = yes
		}
		if = {
			limit = { has_resource = { type = engineering_research amount = 2 } }
			change_variable = { which = engineering_research_weight value = 2 }
			break = yes
		}
		if = {
			limit = { has_resource = { type = engineering_research amount = 3 } }
			change_variable = { which = engineering_research_weight value = 3 }
			break = yes
		}	
		if = {
			limit = { has_resource = { type = engineering_research amount = 4 } }
			change_variable = { which = engineering_research_weight value = 4 }
			break = yes
		}	
		if = {
			limit = { has_resource = { type = engineering_research amount = 5 } }
			change_variable = { which = engineering_research_weight value = 5 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = engineering_research amount = 6 } }
			change_variable = { which = engineering_research_weight value = 6 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = engineering_research amount = 7 } }
			change_variable = { which = engineering_research_weight value = 7 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = engineering_research amount = 8 } }
			change_variable = { which = engineering_research_weight value = 8 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = engineering_research amount = 9 } }
			change_variable = { which = engineering_research_weight value = 9 }
			break = yes
		}		
		if = {
			limit = { has_resource = { type = engineering_research amount = 10 } }
			change_variable = { which = engineering_research_weight value = 10 }
			break = yes
		}		
		else = { break = yes }
	}
}	

check_pop_traits = {
	if = {
		limit = { has_pop = yes }
		if = { 
			limit = { NOR = { has_trait = "trait_machine_unit" has_trait = "trait_mechanical" } }
			if = { 
				limit = { pop = { has_trait = "trait_nerve_stapled" } }
				change_variable = { which = energy_weight value = -5 }
				change_variable = { which = minerals_weight value = 1 }
				change_variable = { which = food_weight value = 1 }
				change_variable = { which = unity_weight value = -5 }
				change_variable = { which = society_research_weight value = -7.5 }
				change_variable = { which = physics_research_weight value = -7.5 }
				change_variable = { which = engineering_research_weight value = -7.5 }
			}
			if = { 
				limit = { pop = { has_trait = "trait_presapient_proles" } }
				change_variable = { which = energy_weight value = -5 }
				change_variable = { which = minerals_weight value = 1 }
				change_variable = { which = food_weight value = 1 }			
				change_variable = { which = society_research_weight value = -2.5 }
				change_variable = { which = physics_research_weight value = -2.5 }
				change_variable = { which = engineering_research_weight value = -2.5 }
			}		
			if = { 
				limit = { pop = { has_trait = "trait_syncretic_proles" } }
				change_variable = { which = minerals_weight value = 1 }
				change_variable = { which = food_weight value = 1 }			
				change_variable = { which = society_research_weight value = -1.5 }
				change_variable = { which = physics_research_weight value = -1.5 }
				change_variable = { which = engineering_research_weight value = -1.5 }
			}			
			if = { 
				limit = { pop = { has_trait = "trait_agrarian" } }
				change_variable = { which = food_weight value = 1.5 }
			}	
			if = { 
				limit = { pop = { has_trait = "trait_thrifty" } }
				change_variable = { which = energy_weight value = 1.5 }
			}				
			if = { 
				limit = { pop = { has_trait = "trait_industrious" } }
				change_variable = { which = minerals_weight value = 1.5 }
			}			
			if = { 
				limit = { pop = { has_trait = "trait_intelligent" } }
				change_variable = { which = society_research_weight value = 1 }
				change_variable = { which = physics_research_weight value = 1 }
				change_variable = { which = engineering_research_weight value = 1 }
			}			
			if = { 
				limit = { pop = { has_trait = "trait_natural_engineers" } }
				change_variable = { which = engineering_research_weight value = 1.5 }
			}						
			if = { 
				limit = { pop = { has_trait = "trait_natural_physicists" } }
				change_variable = { which = physics_research_weight value = 1.5 }
			}						
			if = { 
				limit = { pop = { has_trait = "trait_natural_sociologists" } }
				change_variable = { which = society_research_weight value = 1.5 }
			}			
			if = { 
				limit = { pop = { has_trait = "trait_very_strong" } }
				change_variable = { which = minerals_weight value = 1 }
			}						
			if = { 
				limit = { pop = { has_trait = "trait_strong" } }
				change_variable = { which = minerals_weight value = 0.5 }
			}									
			if = { 
				limit = { pop = { has_trait = "trait_weak" } }
				change_variable = { which = minerals_weight value = -0.5 }
			}	
			if = { 
				limit = { pop = { has_trait = "trait_erudite" } }
				change_variable = { which = society_research_weight value = 2 }
				change_variable = { which = physics_research_weight value = 2 }
				change_variable = { which = engineering_research_weight value = 2 }
			}
			if = { 				
				limit = { pop = { has_trait = "trait_presapient_earthbound" } }			
				change_variable = { which = energy_weight value = 1 }
			}
			if = { 				
				limit = { pop = { has_trait = "trait_presapient_natural_intellectuals" } }			
				change_variable = { which = society_research_weight value = 1 }
				change_variable = { which = physics_research_weight value = 1 }
				change_variable = { which = engineering_research_weight value = 1 }
				change_variable = { which = minerals_weight value = 1 }
			}				
			break = yes	
		}	
		if = { 
			limit = { OR = { has_trait = "trait_machine_unit" has_trait = "trait_mechanical" } }
			if = { 
				limit = { pop = { has_trait = "trait_robotic_1" } }
				change_variable = { which = energy_weight value = -8 }
				change_variable = { which = minerals_weight value = 1 }				
				change_variable = { which = unity_weight value = -4 }
				change_variable = { which = society_research_weight value = -8 }
				change_variable = { which = physics_research_weight value = -8 }
				change_variable = { which = engineering_research_weight value = -8 }
			}						
			if = { 
				limit = { pop = { has_trait = "trait_robotic_2" } }
				change_variable = { which = energy_weight value = -2 }
				change_variable = { which = minerals_weight value = 1.5 }				
				change_variable = { which = unity_weight value = -2 }
				change_variable = { which = society_research_weight value = -4 }
				change_variable = { which = physics_research_weight value = -4 }
				change_variable = { which = engineering_research_weight value = -4 }
			}
			if = { 
				limit = { pop = { has_trait = "trait_robotic_3" } }
				change_variable = { which = energy_weight value = 2 }
				change_variable = { which = minerals_weight value = 2 }				
				change_variable = { which = unity_weight value = 2 }
				change_variable = { which = society_research_weight value = 2 }
				change_variable = { which = physics_research_weight value = 2 }
				change_variable = { which = engineering_research_weight value = 2 }
			}			
			if = { 
				limit = { pop = { has_trait = "trait_robot_power_drills" } }
				change_variable = { which = minerals_weight value = 1 }				
			}			
			if = { 
				limit = { pop = { has_trait = "trait_robot_harvesters" } }
				change_variable = { which = food_weight value = 1 }				
			}			
			if = { 
				limit = { pop = { has_trait = "trait_robot_logic_engines" } }
				change_variable = { which = society_research_weight value = 1 }
				change_variable = { which = physics_research_weight value = 1 }
				change_variable = { which = engineering_research_weight value = 1 }
			}
			if = { 
				limit = { pop = { has_trait = "trait_robot_superconductive" } }
				change_variable = { which = energy_weight value = 1 }				
			}
			if = { 
				limit = { pop = { has_trait = "trait_robot_propaganda_machines" } }
				change_variable = { which = unity_weight value = 1 }				
			}
			else = { break = yes }				
		}
	}
}						

check_planet_bonus_buildings = {
	if = { 
		limit = {
			planet = { has_building = building_mineral_processing_plant_1 }
			change_variable = { which = minerals_weight value = 1 }
		}
	}	
	if = { 
		limit = {
			planet = { has_building = building_mineral_processing_plant_2 }
			change_variable = { which = minerals_weight value = 1 }
		}
	}	
	if = { 
		limit = {
			planet = { has_building = building_power_hub_1 }
			change_variable = { which = energy_weight value = 1 }
		}
	}	
	if = { 
		limit = {
			planet = { has_building = building_power_hub_2 }
			change_variable = { which = energy_weight value = 2 }
		}
	}		
	if = { 
		limit = {
			planet = { has_building = building_akx_worm_1 }
			change_variable = { which = energy_weight value = 2.5 }
		}
	}			
	if = { 
		limit = {
			planet = { has_building = building_hypercomms_forum }
			change_variable = { which = unity_weight value = 1 }
		}
	}	
	if = { 
		limit = {
			planet = { has_building = building_sacred_nexus }
			change_variable = { which = unity_weight value = 1 }
		}
	}
	if = { 
		limit = {
			planet = { has_building = building_sacred_nexus }
			change_variable = { which = unity_weight value = 1 }
		}
	}	
	if = { 
		limit = {
			planet = { has_building = building_galactic_stock_exchange }
			change_variable = { which = energy_weight value = 1 }
		}
	}		
}	

check_adj_bonus_buildings = {
	if = {
		limit = { has_capital_building = yes }
		if = { 
			limit = { has_capital_1 = yes }
			every_neighboring_tile = {
				change_variable = { which = energy_weight value = 1 }
				change_variable = { which = minerals_weight value = 1 }				
				change_variable = { which = unity_weight value = 1 }
				change_variable = { which = society_research_weight value = 1 }
				change_variable = { which = physics_research_weight value = 1 }
				change_variable = { which = engineering_research_weight value = 1 }
				break = yes
			}
		}		
		if = { 
			limit = { has_capital_2 = yes }
			every_neighboring_tile = {
				change_variable = { which = energy_weight value = 2 }
				change_variable = { which = minerals_weight value = 2 }				
				change_variable = { which = unity_weight value = 2 }
				change_variable = { which = society_research_weight value = 2 }
				change_variable = { which = physics_research_weight value = 2 }
				change_variable = { which = engineering_research_weight value = 2 }
				break = yes
			}
		}			
		if = { 
			limit = { has_capital_3 = yes }
			every_neighboring_tile = {	
				change_variable = { which = energy_weight value = 3 }
				change_variable = { which = minerals_weight value = 3 }				
				change_variable = { which = unity_weight value = 3 }
				change_variable = { which = society_research_weight value = 3 }
				change_variable = { which = physics_research_weight value = 3 }
				change_variable = { which = engineering_research_weight value = 3 }
				break = yes
			}
		}	
	}	
	if = { 
		limit = { has_hyperstorage_building = yes }  
		if = { 
			limit = { has_building = building_mineral_silo_1 }
			every_neighboring_tile = {
				change_variable = { which = energy_weight value = 1 }
				change_variable = { which = minerals_weight value = 1 }				
				change_variable = { which = food_weight value = 1 }
				break = yes
			}
		}
		if = { 
			limit = { has_building = building_mineral_silo_2 }
			every_neighboring_tile = {	
				change_variable = { which = energy_weight value = 2 }
				change_variable = { which = minerals_weight value = 2 }				
				change_variable = { which = food_weight value = 2 }
				break = yes
			}
		}	
		if = { 
			limit = { has_building = building_mineral_silo_3 }
			every_neighboring_tile = {	
				change_variable = { which = energy_weight value = 2 }
				change_variable = { which = minerals_weight value = 2 }				
				change_variable = { which = food_weight value = 2 }
				break = yes
			}
		}	
	}
	if = { 
		limit = { has_polytechnic_building = yes } 
		every_neighboring_tile = {
			change_variable = { which = society_research_weight value = 1 }
			change_variable = { which = physics_research_weight value = 1 }
			change_variable = { which = engineering_research_weight value = 1 }
			break = yes
		}	
	}	
	if = { 
		limit = { planet = { is_ringworld = yes } }	
		if = {
			limit = { has_building_power_plant_rw = yes }
			every_neighboring_tile = { change_variable = { which = energy_weight value = 1 } }
			break = yes
		}
		if = {
			limit = { has_building_hydroponics_farm_rw = yes }
			every_neighboring_tile = { change_variable = { which = food_weight value = 1 } }
			break = yes
		}		
		if = {
			limit = { has_building_mining_network_rw = yes }
			every_neighboring_tile = { change_variable = { which = minerals_weight value = 1 } }
			break = yes
		}				
		if = {
			limit = { has_building_engineering_facility_rw = yes }
			every_neighboring_tile = { change_variable = { which = engineering_research_weight value = 1 } }
			break = yes
		}					
		if = {
			limit = { has_building_physics_lab_rw = yes }
			every_neighboring_tile = { change_variable = { which = physics_research_weight value = 1 } }
			break = yes
		}							
		if = {
			limit = { has_building_biolab_rw = yes }
			every_neighboring_tile = { change_variable = { which = society_research_weight value = 1 } }
			break = yes
		}									
		if = { 
			limit = { is_capital = yes }
			if = {
				limit = { has_building_power_plant_5_rw = yes }
				every_neighboring_tile = { change_variable = { which = energy_weight value = 2 } }
				break = yes
			}
			if = {
				limit = { has_building_hydroponics_farm_5_rw = yes }
				every_neighboring_tile = { change_variable = { which = food_weight value = 2 } }
				break = yes
			}		
			if = {
				limit = { has_building_mining_network_5_rw = yes }
				every_neighboring_tile = { change_variable = { which = minerals_weight value = 2 } }
				break = yes
			}				
			if = {
				limit = { has_building_engineering_facility_4_rw = yes }
				every_neighboring_tile = { change_variable = { which = engineering_research_weight value = 2 } }
				break = yes
			}					
			if = {
				limit = { has_building_physics_lab_4_rw = yes }
				every_neighboring_tile = { change_variable = { which = physics_research_weight value = 2 } }
				break = yes
			}							
			if = {
				limit = { has_building_biolab_4_rw = yes }
				every_neighboring_tile = { change_variable = { which = society_research_weight value = 2 } }
				break = yes
			}							
		}
	}	
	if = { 
		limit = { planet = { is_capital = yes is_habitat = yes } } 
			if = {
				limit = { has_building_hab_solar_power_processor_2 = yes }
				every_neighboring_tile = { change_variable = { which = energy_weight value = 1 } }
				break = yes
			}
			if = {
				limit = { has_building_hab_agri_bay_2 = yes }
				every_neighboring_tile = { change_variable = { which = food_weight value = 1 } }
				break = yes
			}		
			if = {
				limit = { has_building_hab_astro_mining_facility_2 = yes }
				every_neighboring_tile = { change_variable = { which = minerals_weight value = 1 } }
				break = yes
			}				
			if = {
				limit = { has_building_hab_laboratory_module_2 = yes }
				every_neighboring_tile = { 
					change_variable = { which = engineering_research_weight value = 1 } 
					change_variable = { which = society_research_weight value = 1 } }
					change_variable = { which = physics_research_weight value = 1 } }
				}	
				break = yes
			}					
		}
	}					
	if = { 
		limit = { planet = { is_capital = yes is_ringworld = no is_habitat = no } }
			if = {
				limit = { has_building_power_plant_5 = yes }
				every_neighboring_tile = { change_variable = { which = energy_weight value = 1 } }
				break = yes
			}
			if = {
				limit = { has_building_hydroponics_farm_5 = yes }
				every_neighboring_tile = { change_variable = { which = food_weight value = 1 } }
				break = yes
			}		
			if = {
				limit = { has_building_mining_network_5 = yes }
				every_neighboring_tile = { change_variable = { which = minerals_weight value = 1 } }
				break = yes
			}				
			if = {
				limit = { has_building_engineering_facility_4 = yes }
				every_neighboring_tile = { change_variable = { which = engineering_research_weight value = 1 } }
				break = yes
			}					
			if = {
				limit = { has_building_physics_lab_4 = yes }
				every_neighboring_tile = { change_variable = { which = physics_research_weight value = 1 } }
				break = yes
			}							
			if = {
				limit = { has_building_biolab_4 = yes }
				every_neighboring_tile = { change_variable = { which = society_research_weight value = 1 } }
				break = yes
			}				
		}
	}	
	if = {
		limit = { has_global_flag = ex_planets_enhanced_active }
		check_planets_enhanced_sr_buildings = yes 
	}	
}			