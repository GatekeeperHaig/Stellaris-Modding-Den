##########################################################################
# Shroud Decisions
##########################################################################

# Shroud World
decision_shroud_world = {
	icon = decision_shroud_world
	owned_planets_only = yes

	enactment_time = 1800
	resources = {
		category = decisions
		cost = {
			energy =  5000
			sr_zro = 1000
		}
	}
	
	potential = {
		owner = { has_ascension_perk = ap_transcendence }
		habitable_structure = no
		NOT = { is_planet_class = pc_pdshroud }
		NOT = { is_planet_class = pc_city }
		NOT = { is_planet_class = pc_shroudcity }
		NOT = { is_planet_class = pc_ecocity }
		NOT = { is_planet_class = pc_milarc }
		NOT = { is_planet_class = pc_relic }
		NOT = { is_planet_class = pc_crystal }
		NOT = { is_planet_class = pc_graveyard }
		NOT = { is_planet_class = pc_floating }
		NOT = { is_planet_class = pc_archive }
		NOT = { is_planet_class = pc_technoorganic }
		NOT = { is_planet_class = pc_pd_barren_cold_hab }
		NOT = { is_planet_class = pc_pd_barren_hab }
		NOT = { is_planet_class = pc_pd_frozen_hab }
		NOT = { is_planet_class = pc_pd_gas_giant_hab }
		NOT = { is_planet_class = pc_pd_hothouse_hab }
		NOT = { is_planet_class = pc_pd_molten_hab }
		NOT = { is_planet_class = pc_pd_toxic_hab }
		NOT = { is_planet_class = pc_pd_asteroid_hab }
	}

	effect = {
		custom_tooltip = decision_shroud_world_effects_custom
		change_pc = pc_pdshroud
		if = {
			limit = { has_modifier = engineered_environment_gaia }
			remove_modifier = engineered_environment_gaia
		}
		if = {
			limit = { has_modifier = engineered_environment }
			remove_modifier = engineered_environment
		}
		if = {
			limit = { has_modifier = bleak_planet }
			remove_modifier = bleak_planet
		}
		if = {
			limit = { has_modifier = high_gravity }
			remove_modifier = high_gravity
		}
		if = {
			limit = { has_modifier = irradiated_planet }
			remove_modifier = irradiated_planet
		}
		if = {
			limit = { has_modifier = mineral_poor }
			remove_modifier = mineral_poor
		}
		if = {
			limit = { has_modifier = unstable_tectonics }
			remove_modifier = unstable_tectonics
		}
		if = {
			limit = { has_modifier = weak_magnetic_field }
			remove_modifier = weak_magnetic_field
		}
		if = {
			limit = { has_modifier = exofungus }
			remove_modifier = exofungus
		}
		if = {
			limit = { has_modifier = exofungus }
			remove_modifier = exofungus
		} 
		hidden_effect = {
			add_deposit = d_pdshroud
			remove_deposit = d_geothermal_slurry_site
			remove_modifier = geothermal
			remove_deposit = d_ancient_motes
			remove_modifier = superhabitable
			remove_deposit = d_biolumen_nature_preserve
			remove_modifier = biolumen
			remove_deposit = d_nightside_mining_operations
			remove_modifier = tidal_locked2
			remove_deposit = d_karst_cave
			remove_modifier = karst
			remove_deposit = d_lava_lakes
			remove_modifier = primal
			remove_deposit = d_lava_lakes
			remove_modifier = primal
			remove_deposit = d_aquatic_trench
			remove_modifier = aquatic
			remove_deposit = d_ammonia_sea
			remove_modifier = ammonia
			remove_deposit = d_sulfur_pool
			remove_modifier = pdsulfur
			remove_deposit = d_acid_lakes
			remove_deposit = d_pdacid_rain
			remove_modifier = pdacid
			remove_deposit = d_frozen_gas_mountain
			remove_modifier = methane
			IF = {
				limit = {
					has_planet_flag = planet_earth
				}
				set_planet_entity = {
                    entity = "pdshroud_planet_earth_entity"
                }
			}
		}
	}   

	ai_weight = {
        weight = 0
        modifier = {
            factor = 0
            or = {
                free_building_slots > 0
                owner = {
                    or = {
                        resource_stockpile_compare = { resource = energy value < 6000 } 
                        resource_stockpile_compare = { resource = influence value < 150 }
                     } }
            }
        }
    }
}

# Vanilla Shrouded World to PD
decision_shrouded_world = {
	icon = decision_shroud_world

	resources = {
		category = decisions
		cost = {
			energy = 5000
			sr_zro = 1000
		}
	}
	
	potential = {
		exists = space_owner
		space_owner = { is_same_value = from }
		from = { has_ascension_perk = ap_transcendence }
		is_planet_class = pc_shrouded
		NOT = { has_planet_flag = pd_shroud_transformation }
	}

	effect = {
		custom_tooltip = decision_shrouded_world_effects_custom
		#change_pc = pc_pdshroud
		hidden_effect = { 
			set_planet_flag = pd_shroud_transformation 
			planet_event = { id = pdshroud.98 days = 3600 } 
			add_modifier = {
				modifier = pdshroudtransformation days = -1
			}
		}
	}   

	ai_weight = {
        weight = 0
        modifier = {
            factor = 0
            or = {
                free_building_slots > 0
                owner = {
                    or = {
                        resource_stockpile_compare = { resource = energy value < 6000 } 
                        resource_stockpile_compare = { resource = influence value < 150 }
					} 
				}
            }
        }
    }
}

# Shroud Arc
decision_shroud_arc = {
	icon = decision_shroud_arc
	owned_planets_only = yes

	enactment_time = 1800
	resources = {
		category = decisions
		cost = {
			energy =  2500
			sr_zro = 500
		}
	}
	
	potential = {
		owner = { has_ascension_perk = ap_transcendence }
		habitable_structure = no
		OR = {
			is_planet_class = pc_city
			is_planet_class = pc_ecocity
			is_planet_class = pc_milarc
		}
		NOT = { has_planet_flag = shroudedarc }
	}

	effect = {
		custom_tooltip = decision_shroud_world_effects_custom
		hidden_effect = {
			#Housing
			if = {
				limit = { num_districts = { type = district_arcology_housing value = 1 } }
				add_district = district_pdshroudarc_housing
			}
			if = {
				limit = { num_districts = { type = district_arcology_housing value = 2 } }
				while = { count = 2 add_district = district_pdshroudarc_housing }
			}
			if = {
				limit = { num_districts = { type = district_arcology_housing value = 3 } }
				while = { count = 3 add_district = district_pdshroudarc_housing }
			}
			if = {
				limit = { num_districts = { type = district_arcology_housing value = 4 } }
				while = { count = 4 add_district = district_pdshroudarc_housing }
			}
			if = {
				limit = { num_districts = { type = district_arcology_housing value = 5 } }
				while = { count = 5 add_district = district_pdshroudarc_housing }
			}
			if = {
				limit = { num_districts = { type = district_arcology_housing value = 6 } }
				while = { count = 6 add_district = district_pdshroudarc_housing }
			}
			if = {
				limit = { num_districts = { type = district_arcology_housing value = 7 } }
				while = { count = 7 add_district = district_pdshroudarc_housing }
			}
			if = {
				limit = { num_districts = { type = district_arcology_housing value = 8 } }
				while = { count = 8 add_district = district_pdshroudarc_housing }
			}
			if = {
				limit = { num_districts = { type = district_arcology_housing value = 9 } }
				while = { count = 9 add_district = district_pdshroudarc_housing }
			}
			if = {
				limit = { num_districts = { type = district_arcology_housing value = 10 } }
				while = { count = 10 add_district = district_pdshroudarc_housing }
			}
			if = {
				limit = { num_districts = { type = district_arcology_housing value = 11 } }
				while = { count = 11 add_district = district_pdshroudarc_housing }
			}
			if = {
				limit = { num_districts = { type = district_arcology_housing value = 12 } }
				while = { count = 12 add_district = district_pdshroudarc_housing }
			}
			if = {
				limit = { num_districts = { type = district_arcology_housing value = 13 } }
				while = { count = 13 add_district = district_pdshroudarc_housing }
			}
			if = {
				limit = { num_districts = { type = district_arcology_housing value = 14 } }
				while = { count = 14 add_district = district_pdshroudarc_housing }
			}
			if = {
				limit = { num_districts = { type = district_arcology_housing value = 15 } }
				while = { count = 15 add_district = district_pdshroudarc_housing }
			}
			if = {
				limit = { num_districts = { type = district_arcology_housing value = 16 } }
				while = { count = 16 add_district = district_pdshroudarc_housing }
			}
			if = {
				limit = { num_districts = { type = district_arcology_housing value = 17 } }
				while = { count = 17 add_district = district_pdshroudarc_housing }
			}
			if = {
				limit = { num_districts = { type = district_arcology_housing value = 18 } }
				while = { count = 18 add_district = district_pdshroudarc_housing }
			}
			if = {
				limit = { num_districts = { type = district_arcology_housing value = 19 } }
				while = { count = 19 add_district = district_pdshroudarc_housing }
			}
			if = {
				limit = { num_districts = { type = district_arcology_housing value = 20 } }
				while = { count = 20 add_district = district_pdshroudarc_housing }
			}
			if = {
				limit = { num_districts = { type = district_arcology_housing value = 21 } }
				while = { count = 21 add_district = district_pdshroudarc_housing }
			}
			if = {
				limit = { num_districts = { type = district_arcology_housing value = 22 } }
				while = { count = 22 add_district = district_pdshroudarc_housing }
			}
			if = {
				limit = { num_districts = { type = district_arcology_housing value = 23 } }
				while = { count = 23 add_district = district_pdshroudarc_housing }
			}
			if = {
				limit = { num_districts = { type = district_arcology_housing value = 24 } }
				while = { count = 24 add_district = district_pdshroudarc_housing }
			}
			if = {
				limit = { num_districts = { type = district_arcology_housing value = 25 } }
				while = { count = 25 add_district = district_pdshroudarc_housing }
			}
			#Alloys
			if = {
				limit = { num_districts = { type = district_arcology_arms_industry value = 1 } }
				add_district = district_pdshroudarc_arms_industry
			}
			if = {
				limit = { num_districts = { type = district_arcology_arms_industry value = 2 } }
				while = { count = 2 add_district = district_pdshroudarc_arms_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_arms_industry value = 3 } }
				while = { count = 3 add_district = district_pdshroudarc_arms_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_arms_industry value = 4 } }
				while = { count = 4 add_district = district_pdshroudarc_arms_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_arms_industry value = 5 } }
				while = { count = 5 add_district = district_pdshroudarc_arms_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_arms_industry value = 6 } }
				while = { count = 6 add_district = district_pdshroudarc_arms_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_arms_industry value = 7 } }
				while = { count = 7 add_district = district_pdshroudarc_arms_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_arms_industry value = 8 } }
				while = { count = 8 add_district = district_pdshroudarc_arms_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_arms_industry value = 9 } }
				while = { count = 9 add_district = district_pdshroudarc_arms_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_arms_industry value = 10 } }
				while = { count = 10 add_district = district_pdshroudarc_arms_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_arms_industry value = 11 } }
				while = { count = 11 add_district = district_pdshroudarc_arms_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_arms_industry value = 12 } }
				while = { count = 12 add_district = district_pdshroudarc_arms_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_arms_industry value = 13 } }
				while = { count = 13 add_district = district_pdshroudarc_arms_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_arms_industry value = 14 } }
				while = { count = 14 add_district = district_pdshroudarc_arms_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_arms_industry value = 15 } }
				while = { count = 15 add_district = district_pdshroudarc_arms_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_arms_industry value = 16 } }
				while = { count = 16 add_district = district_pdshroudarc_arms_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_arms_industry value = 17 } }
				while = { count = 17 add_district = district_pdshroudarc_arms_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_arms_industry value = 18 } }
				while = { count = 18 add_district = district_pdshroudarc_arms_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_arms_industry value = 19 } }
				while = { count = 19 add_district = district_pdshroudarc_arms_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_arms_industry value = 20 } }
				while = { count = 20 add_district = district_pdshroudarc_arms_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_arms_industry value = 21 } }
				while = { count = 21 add_district = district_pdshroudarc_arms_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_arms_industry value = 22 } }
				while = { count = 22 add_district = district_pdshroudarc_arms_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_arms_industry value = 23 } }
				while = { count = 23 add_district = district_pdshroudarc_arms_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_arms_industry value = 24 } }
				while = { count = 24 add_district = district_pdshroudarc_arms_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_arms_industry value = 25 } }
				while = { count = 25 add_district = district_pdshroudarc_arms_industry }
			}
			#Consumer Goods
			if = {
				limit = { num_districts = { type = district_arcology_civilian_industry value = 1 } }
				add_district = district_pdshroudarc_civilian_industry
			}
			if = {
				limit = { num_districts = { type = district_arcology_civilian_industry value = 2 } }
				while = { count = 2 add_district = district_pdshroudarc_civilian_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_civilian_industry value = 3 } }
				while = { count = 3 add_district = district_pdshroudarc_civilian_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_civilian_industry value = 4 } }
				while = { count = 4 add_district = district_pdshroudarc_civilian_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_civilian_industry value = 5 } }
				while = { count = 5 add_district = district_pdshroudarc_civilian_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_civilian_industry value = 6 } }
				while = { count = 6 add_district = district_pdshroudarc_civilian_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_civilian_industry value = 7 } }
				while = { count = 7 add_district = district_pdshroudarc_civilian_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_civilian_industry value = 8 } }
				while = { count = 8 add_district = district_pdshroudarc_civilian_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_civilian_industry value = 9 } }
				while = { count = 9 add_district = district_pdshroudarc_civilian_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_civilian_industry value = 10 } }
				while = { count = 10 add_district = district_pdshroudarc_civilian_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_civilian_industry value = 11 } }
				while = { count = 11 add_district = district_pdshroudarc_civilian_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_civilian_industry value = 12 } }
				while = { count = 12 add_district = district_pdshroudarc_civilian_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_civilian_industry value = 13 } }
				while = { count = 13 add_district = district_pdshroudarc_civilian_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_civilian_industry value = 14 } }
				while = { count = 14 add_district = district_pdshroudarc_civilian_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_civilian_industry value = 15 } }
				while = { count = 15 add_district = district_pdshroudarc_civilian_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_civilian_industry value = 16 } }
				while = { count = 16 add_district = district_pdshroudarc_civilian_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_civilian_industry value = 17 } }
				while = { count = 17 add_district = district_pdshroudarc_civilian_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_civilian_industry value = 18 } }
				while = { count = 18 add_district = district_pdshroudarc_civilian_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_civilian_industry value = 19 } }
				while = { count = 19 add_district = district_pdshroudarc_civilian_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_civilian_industry value = 20 } }
				while = { count = 20 add_district = district_pdshroudarc_civilian_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_civilian_industry value = 21 } }
				while = { count = 21 add_district = district_pdshroudarc_civilian_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_civilian_industry value = 22 } }
				while = { count = 22 add_district = district_pdshroudarc_civilian_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_civilian_industry value = 23 } }
				while = { count = 23 add_district = district_pdshroudarc_civilian_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_civilian_industry value = 24 } }
				while = { count = 24 add_district = district_pdshroudarc_civilian_industry }
			}
			if = {
				limit = { num_districts = { type = district_arcology_civilian_industry value = 25 } }
				while = { count = 25 add_district = district_pdshroudarc_civilian_industry }
			}
			#Temples
			if = {
				limit = { num_districts = { type = district_arcology_leisure value = 1 } }
				add_district = district_pdshroudarc_temple
			}
			if = {
				limit = { num_districts = { type = district_arcology_leisure value = 2 } }
				while = { count = 2 add_district = district_pdshroudarc_temple }
			}
			if = {
				limit = { num_districts = { type = district_arcology_leisure value = 3 } }
				while = { count = 3 add_district = district_pdshroudarc_temple }
			}
			if = {
				limit = { num_districts = { type = district_arcology_leisure value = 4 } }
				while = { count = 4 add_district = district_pdshroudarc_temple }
			}
			if = {
				limit = { num_districts = { type = district_arcology_leisure value = 5 } }
				while = { count = 5 add_district = district_pdshroudarc_temple }
			}
			if = {
				limit = { num_districts = { type = district_arcology_leisure value = 6 } }
				while = { count = 6 add_district = district_pdshroudarc_temple }
			}
			if = {
				limit = { num_districts = { type = district_arcology_leisure value = 7 } }
				while = { count = 7 add_district = district_pdshroudarc_temple }
			}
			if = {
				limit = { num_districts = { type = district_arcology_leisure value = 8 } }
				while = { count = 8 add_district = district_pdshroudarc_temple }
			}
			if = {
				limit = { num_districts = { type = district_arcology_leisure value = 9 } }
				while = { count = 9 add_district = district_pdshroudarc_temple }
			}
			if = {
				limit = { num_districts = { type = district_arcology_leisure value = 10 } }
				while = { count = 10 add_district = district_pdshroudarc_temple }
			}
			if = {
				limit = { num_districts = { type = district_arcology_leisure value = 11 } }
				while = { count = 11 add_district = district_pdshroudarc_temple }
			}
			if = {
				limit = { num_districts = { type = district_arcology_leisure value = 12 } }
				while = { count = 12 add_district = district_pdshroudarc_temple }
			}
			if = {
				limit = { num_districts = { type = district_arcology_leisure value = 13 } }
				while = { count = 13 add_district = district_pdshroudarc_temple }
			}
			if = {
				limit = { num_districts = { type = district_arcology_leisure value = 14 } }
				while = { count = 14 add_district = district_pdshroudarc_temple }
			}
			if = {
				limit = { num_districts = { type = district_arcology_leisure value = 15 } }
				while = { count = 15 add_district = district_pdshroudarc_temple }
			}
			if = {
				limit = { num_districts = { type = district_arcology_leisure value = 16 } }
				while = { count = 16 add_district = district_pdshroudarc_temple }
			}
			if = {
				limit = { num_districts = { type = district_arcology_leisure value = 17 } }
				while = { count = 17 add_district = district_pdshroudarc_temple }
			}
			if = {
				limit = { num_districts = { type = district_arcology_leisure value = 18 } }
				while = { count = 18 add_district = district_pdshroudarc_temple }
			}
			if = {
				limit = { num_districts = { type = district_arcology_leisure value = 19 } }
				while = { count = 19 add_district = district_pdshroudarc_temple }
			}
			if = {
				limit = { num_districts = { type = district_arcology_leisure value = 20 } }
				while = { count = 20 add_district = district_pdshroudarc_temple }
			}
			if = {
				limit = { num_districts = { type = district_arcology_leisure value = 21 } }
				while = { count = 21 add_district = district_pdshroudarc_temple }
			}
			if = {
				limit = { num_districts = { type = district_arcology_leisure value = 22 } }
				while = { count = 22 add_district = district_pdshroudarc_temple }
			}
			if = {
				limit = { num_districts = { type = district_arcology_leisure value = 23 } }
				while = { count = 23 add_district = district_pdshroudarc_temple }
			}
			if = {
				limit = { num_districts = { type = district_arcology_leisure value = 24 } }
				while = { count = 24 add_district = district_pdshroudarc_temple }
			}
			if = {
				limit = { num_districts = { type = district_arcology_leisure value = 25 } }
				while = { count = 25 add_district = district_pdshroudarc_temple }
			}
		}
		if = {
			limit = { is_planet_class = pc_city }
			change_pc = pc_shroudcity
		}
		if = {
			limit = { is_planet_class = pc_ecocity }
			set_planet_entity = {
				entity = ecoshroud_planet_01_entity
				picture = pc_shroudcity
			}
			set_planet_flag = shroudedarc
		}
		if = {
			limit = { is_planet_class = pc_milarc }
			set_planet_entity = {
				entity = milarcshroud_planet_01_entity
				picture = pc_shroudmilarc
			}
			set_planet_flag = shroudedarc
		}
	}

	ai_weight = {
        weight = 0
        modifier = {
            factor = 0
            or = {
                free_building_slots > 0
                owner = {
                    or = {
                        resource_stockpile_compare = { resource = energy value < 6000 } 
                        resource_stockpile_compare = { resource = sr_zro value < 500 }
					} 
				}
            }
        }
    }
}

# UnShroud World
decision_unshroud_world = {
	icon = decision_resort_colony
	owned_planets_only = yes

	enactment_time = 1800
	resources = {
		category = decisions
		cost = {
			energy =  2000
		}
	}
	
	potential = {
		owner = { has_technology = tech_psionic_theory NOT = { has_origin = origin_pd_shroud } }
		habitable_structure = no
		OR = {
			is_planet_class = pc_pdshroud
			is_planet_class = pc_shroudcity
			has_planet_flag = shroudedarc
		}
	}

	effect = {
		custom_tooltip = decision_unshroud_world_effects_custom
		hidden_effect = {
		if = {
			limit = { has_modifier = pdeater }
			remove_modifier = pdeater
		}
		if = {
			limit = { has_modifier = pdcomposer }
			remove_modifier = pdcomposer
		}
		if = {
			limit = { has_modifier = pddesire }
			remove_modifier = pddesire
		}
		if = {
			limit = { has_modifier = pdwhispers }
			remove_modifier = pdwhispers
		}
		if = {
			limit = { has_deposit = d_pdshroud_composer }
			remove_deposit = d_pdshroud_composer
		}
		if = {
			limit = { has_deposit = d_pdshroud_eater }
			remove_deposit = d_pdshroud_eater
		}
		if = {
			limit = { has_deposit = d_pdshroud_desire }
			remove_deposit = d_pdshroud_desire
		}
		if = {
			limit = { has_deposit = d_pdshroud_whispers }
			remove_deposit = d_pdshroud_whispers
		}
		if = {
			limit = { is_planet_class = pc_pdshroud }
			remove_deposit = d_pdshroud
			change_pc = pc_gaia
			add_deposit = d_pdgaia
		}
		if = {
			limit = { is_planet_class = pc_ecocity }
			remove_planet_flag = shroudedarc
			set_planet_entity = {
				picture = pc_ecocity
				entity = ecocity_planet_01_entity
			}
		}
		if = {
			limit = { is_planet_class = pc_milarc }
			remove_planet_flag = shroudedarc
			set_planet_entity = {
				picture = pc_milarc
				entity = milarc_planet_01_entity
			}
		}
		if = {
			limit = { is_planet_class = pc_shroudcity }
			change_pc = pc_city	
				#Housing
				if = {
					limit = { num_districts = { type = district_pdshroudarc_housing value = 1 } }
					add_district = district_arcology_housing
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_housing value = 2 } }
					while = { count = 2 add_district = district_arcology_housing }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_housing value = 3 } }
					while = { count = 3 add_district = district_arcology_housing }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_housing value = 4 } }
					while = { count = 4 add_district = district_arcology_housing }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_housing value = 5 } }
					while = { count = 5 add_district = district_arcology_housing }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_housing value = 6 } }
					while = { count = 6 add_district = district_arcology_housing }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_housing value = 7 } }
					while = { count = 7 add_district = district_arcology_housing }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_housing value = 8 } }
					while = { count = 8 add_district = district_arcology_housing }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_housing value = 9 } }
					while = { count = 9 add_district = district_arcology_housing }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_housing value = 10 } }
					while = { count = 10 add_district = district_arcology_housing }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_housing value = 11 } }
					while = { count = 11 add_district = district_arcology_housing }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_housing value = 12 } }
					while = { count = 12 add_district = district_arcology_housing }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_housing value = 13 } }
					while = { count = 13 add_district = district_arcology_housing }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_housing value = 14 } }
					while = { count = 14 add_district = district_arcology_housing }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_housing value = 15 } }
					while = { count = 15 add_district = district_arcology_housing }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_housing value = 16 } }
					while = { count = 16 add_district = district_arcology_housing }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_housing value = 17 } }
					while = { count = 17 add_district = district_arcology_housing }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_housing value = 18 } }
					while = { count = 18 add_district = district_arcology_housing }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_housing value = 19 } }
					while = { count = 19 add_district = district_arcology_housing }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_housing value = 20 } }
					while = { count = 20 add_district = district_arcology_housing }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_housing value = 21 } }
					while = { count = 21 add_district = district_arcology_housing }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_housing value = 22 } }
					while = { count = 22 add_district = district_arcology_housing }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_housing value = 23 } }
					while = { count = 23 add_district = district_arcology_housing }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_housing value = 24 } }
					while = { count = 24 add_district = district_arcology_housing }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_housing value = 25 } }
					while = { count = 25 add_district = district_arcology_housing }
				}
				#Alloys
				if = {
					limit = { num_districts = { type = district_pdshroudarc_arms_industry value = 1 } }
					add_district = district_arcology_arms_industry
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_arms_industry value = 2 } }
					while = { count = 2 add_district = district_arcology_arms_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_arms_industry value = 3 } }
					while = { count = 3 add_district = district_arcology_arms_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_arms_industry value = 4 } }
					while = { count = 4 add_district = district_arcology_arms_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_arms_industry value = 5 } }
					while = { count = 5 add_district = district_arcology_arms_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_arms_industry value = 6 } }
					while = { count = 6 add_district = district_arcology_arms_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_arms_industry value = 7 } }
					while = { count = 7 add_district = district_arcology_arms_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_arms_industry value = 8 } }
					while = { count = 8 add_district = district_arcology_arms_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_arms_industry value = 9 } }
					while = { count = 9 add_district = district_arcology_arms_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_arms_industry value = 10 } }
					while = { count = 10 add_district = district_arcology_arms_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_arms_industry value = 11 } }
					while = { count = 11 add_district = district_arcology_arms_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_arms_industry value = 12 } }
					while = { count = 12 add_district = district_arcology_arms_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_arms_industry value = 13 } }
					while = { count = 13 add_district = district_arcology_arms_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_arms_industry value = 14 } }
					while = { count = 14 add_district = district_arcology_arms_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_arms_industry value = 15 } }
					while = { count = 15 add_district = district_arcology_arms_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_arms_industry value = 16 } }
					while = { count = 16 add_district = district_arcology_arms_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_arms_industry value = 17 } }
					while = { count = 17 add_district = district_arcology_arms_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_arms_industry value = 18 } }
					while = { count = 18 add_district = district_arcology_arms_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_arms_industry value = 19 } }
					while = { count = 19 add_district = district_arcology_arms_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_arms_industry value = 20 } }
					while = { count = 20 add_district = district_arcology_arms_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_arms_industry value = 21 } }
					while = { count = 21 add_district = district_arcology_arms_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_arms_industry value = 22 } }
					while = { count = 22 add_district = district_arcology_arms_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_arms_industry value = 23 } }
					while = { count = 23 add_district = district_arcology_arms_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_arms_industry value = 24 } }
					while = { count = 24 add_district = district_arcology_arms_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_arms_industry value = 25 } }
					while = { count = 25 add_district = district_arcology_arms_industry }
				}
				#Consumer Goods
				if = {
					limit = { num_districts = { type = district_pdshroudarc_civilian_industry value = 1 } }
					add_district = district_arcology_civilian_industry
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_civilian_industry value = 2 } }
					while = { count = 2 add_district = district_arcology_civilian_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_civilian_industry value = 3 } }
					while = { count = 3 add_district = district_arcology_civilian_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_civilian_industry value = 4 } }
					while = { count = 4 add_district = district_arcology_civilian_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_civilian_industry value = 5 } }
					while = { count = 5 add_district = district_arcology_civilian_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_civilian_industry value = 6 } }
					while = { count = 6 add_district = district_arcology_civilian_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_civilian_industry value = 7 } }
					while = { count = 7 add_district = district_arcology_civilian_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_civilian_industry value = 8 } }
					while = { count = 8 add_district = district_arcology_civilian_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_civilian_industry value = 9 } }
					while = { count = 9 add_district = district_arcology_civilian_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_civilian_industry value = 10 } }
					while = { count = 10 add_district = district_arcology_civilian_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_civilian_industry value = 11 } }
					while = { count = 11 add_district = district_arcology_civilian_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_civilian_industry value = 12 } }
					while = { count = 12 add_district = district_arcology_civilian_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_civilian_industry value = 13 } }
					while = { count = 13 add_district = district_arcology_civilian_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_civilian_industry value = 14 } }
					while = { count = 14 add_district = district_arcology_civilian_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_civilian_industry value = 15 } }
					while = { count = 15 add_district = district_arcology_civilian_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_civilian_industry value = 16 } }
					while = { count = 16 add_district = district_arcology_civilian_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_civilian_industry value = 17 } }
					while = { count = 17 add_district = district_arcology_civilian_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_civilian_industry value = 18 } }
					while = { count = 18 add_district = district_arcology_civilian_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_civilian_industry value = 19 } }
					while = { count = 19 add_district = district_arcology_civilian_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_civilian_industry value = 20 } }
					while = { count = 20 add_district = district_arcology_civilian_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_civilian_industry value = 21 } }
					while = { count = 21 add_district = district_arcology_civilian_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_civilian_industry value = 22 } }
					while = { count = 22 add_district = district_arcology_civilian_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_civilian_industry value = 23 } }
					while = { count = 23 add_district = district_arcology_civilian_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_civilian_industry value = 24 } }
					while = { count = 24 add_district = district_arcology_civilian_industry }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_civilian_industry value = 25 } }
					while = { count = 25 add_district = district_arcology_civilian_industry }
				}
				#Lesuire
				if = {
					limit = { num_districts = { type = district_pdshroudarc_temple value = 1 } }
					add_district = district_arcology_leisure
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_temple value = 2 } }
					while = { count = 2 add_district = district_arcology_leisure }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_temple value = 3 } }
					while = { count = 3 add_district = district_arcology_leisure }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_temple value = 4 } }
					while = { count = 4 add_district = district_arcology_leisure }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_temple value = 5 } }
					while = { count = 5 add_district = district_arcology_leisure }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_temple value = 6 } }
					while = { count = 6 add_district = district_arcology_leisure }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_temple value = 7 } }
					while = { count = 7 add_district = district_arcology_leisure }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_temple value = 8 } }
					while = { count = 8 add_district = district_arcology_leisure }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_temple value = 9 } }
					while = { count = 9 add_district = district_arcology_leisure }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_temple value = 10 } }
					while = { count = 10 add_district = district_arcology_leisure }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_temple value = 11 } }
					while = { count = 11 add_district = district_arcology_leisure }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_temple value = 12 } }
					while = { count = 12 add_district = district_arcology_leisure }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_temple value = 13 } }
					while = { count = 13 add_district = district_arcology_leisure }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_temple value = 14 } }
					while = { count = 14 add_district = district_arcology_leisure }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_temple value = 15 } }
					while = { count = 15 add_district = district_arcology_leisure }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_temple value = 16 } }
					while = { count = 16 add_district = district_arcology_leisure }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_temple value = 17 } }
					while = { count = 17 add_district = district_arcology_leisure }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_temple value = 18 } }
					while = { count = 18 add_district = district_arcology_leisure }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_temple value = 19 } }
					while = { count = 19 add_district = district_arcology_leisure }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_temple value = 20 } }
					while = { count = 20 add_district = district_arcology_leisure }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_temple value = 21 } }
					while = { count = 21 add_district = district_arcology_leisure }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_temple value = 22 } }
					while = { count = 22 add_district = district_arcology_leisure }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_temple value = 23 } }
					while = { count = 23 add_district = district_arcology_leisure }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_temple value = 24 } }
					while = { count = 24 add_district = district_arcology_leisure }
				}
				if = {
					limit = { num_districts = { type = district_pdshroudarc_temple value = 25 } }
					while = { count = 25 add_district = district_arcology_leisure }
				}
			}
		}
	}   

	ai_weight = {
        weight = 0
        modifier = {
            factor = 0
            or = {
                free_building_slots > 0
                owner = { resource_stockpile_compare = { resource = energy value < 6000 } }
            }
        }
    }
}

# Call Upon Shroud Patron
decision_shroud_planet_patron = {
	icon = decision_shroud_planet_patron
	owned_planets_only = yes

	enactment_time = 1800
	resources = {
		category = decisions
		cost = {
			sr_zro =  2500
			influence = 250
		}
	}
	
	potential = {
		owner = { has_ascension_perk = ap_transcendence }
		habitable_structure = no
		OR = {
			is_planet_class = pc_pdshroud
			is_planet_class = pc_shroudcity
		}
		NOT = { 
			OR = {
				has_modifier = pdwhispers 
				has_modifier = pdcomposer 
				has_modifier = pdeater 
				has_modifier = pddesire 
			}
		}
		OWNER = {
			NOT = {
				AND = {
					any_owned_planet = { has_modifier = pdwhispers }
					any_owned_planet = { has_modifier = pdcomposer }
					any_owned_planet = { has_modifier = pdeater }
					any_owned_planet = { has_modifier = pddesire }
				}
			}
		}
	}

	effect = {
		custom_tooltip = decision_shroud_planet_patron_effects_custom
		hidden_effect = { planet_event = { id = pdshroud.99 days = 1 } }
	}   

	ai_weight = {
        weight = 0
        modifier = {
            factor = 0
            or = {
                free_building_slots > 0
                owner = { resource_stockpile_compare = { resource = sr_zro value < 500 } }
            }
        }
    }
}