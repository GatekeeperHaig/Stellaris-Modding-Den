namespace = nsc_flagship_warning

#Flagship Buildtime modifiers were removed because no penalties are needed now for second Flagship construction... the first only blows itself up if a new one is built.

# This event triggers whenever a new flagship is built.
ship_event = {
	id = nsc_flagship_warning.1
	title = captainx3.1.name
	desc = captainx3.1.desc
	picture = GFX_evt_NSC_event25
	show_sound = event_sensor_ping
	is_triggered_only = yes

	trigger = { is_ship_size = NSC_Flagship }
	
	immediate = {
		owner = {
			add_modifier = {
				modifier = nsc_flagship_bonus
				days = -1
			}
		}
	}
	
	option = { name = UNDERSTOOD }
}

# Flagship Destroyed/Dismissed
country_event = {
	id = nsc_flagship_warning.2
	title = captainx3.2.name
	desc = captainx3.2.desc
	picture = GFX_evt_NSC_event18
	show_sound = event_sensor_ping
	is_triggered_only = yes

	immediate = { remove_modifier = nsc_flagship_bonus }
	
	option = { name = EXCELLENT }
}

country_event = {
	id = nsc_flagship_warning.3
	hide_window = yes
	
	mean_time_to_happen = { days = 7 }
	
	trigger = {
		has_modifier = nsc_flagship_bonus
		count_owned_ships = {
			limit = { is_ship_size = NSC_Flagship }
			count = 0
		}
	}
	
	immediate = { remove_modifier = nsc_flagship_bonus }
}

# The AI doesnt trigger the build event
country_event = {
	id = nsc_flagship_warning.4
	hide_window = yes
	
	mean_time_to_happen = { days = 7 }
	
	trigger = {
		NOT = { has_modifier = nsc_flagship_bonus }
		count_owned_ships = {
			limit = { is_ship_size = NSC_Flagship }
			count > 0
		}
	}
	
	immediate = {
		add_modifier = {
			modifier = nsc_flagship_bonus
			days = -1
		}
	}
}

####################
# NAMESPACE CHANGE #
####################

namespace = nsc_flagship_check

# Prevents more than one
ship_event = {
	id = nsc_flagship_check.1
	hide_window = yes
	is_triggered_only = yes

	trigger = { is_ship_size = NSC_Flagship }

	immediate = {
		set_ship_flag = "nsc_keep"
		owner = {
			every_owned_ship = {
				limit = {
					is_ship_size = "NSC_Flagship"
					NOT = { has_ship_flag = "nsc_keep" }
				}
				reduce_hp_percent = 100 #This allows for destruction of the Flagship(s) "not" just built to be destroyed without wiping out the fleet it is in.
			}
		}
		remove_ship_flag = "nsc_keep"
	}
}

country_event = {
	# disbanded
	id = nsc_flagship_check.301
	is_triggered_only = yes
	hide_window = yes
	
	trigger = { from = { is_ship_size = NSC_Flagship } }
	
	immediate = { country_event = { id = nsc_flagship_warning.2 } }
}

country_event = {
	# Destroyed (country is the victim)
	id = nsc_flagship_check.302
	is_triggered_only = yes
	hide_window = yes
	
	trigger = { fromfrom = { is_ship_size = NSC_Flagship } }

	immediate = { country_event = { id = nsc_flagship_warning.2 } }
}
