namespace = landscaper_surveys

ship_event = {
	id = landscaper_surveys.1

	is_triggered_only = yes
	location = fromfrom
	hide_window = yes
	
	trigger = {
		fromfrom = {
			NOT = { has_planet_flag = alphamod_surveyed_land }
		}
	}
	
	immediate = {
		fromfrom = {
			set_planet_flag = alphamod_surveyed_land
			if = {
				limit = {
					OR = {
						is_planet_class = pc_continental
						is_planet_class = pc_alpine
						is_planet_class = pc_tundra
						is_planet_class = pc_ocean
						is_planet_class = pc_gaia
						is_planet_class = pc_arctic
					}
				}
				every_tile = {
					limit = { 
						has_blocker = no
						has_building = no
						has_grown_pop = no
						has_growing_pop = no
						has_building_construction = no
						num_adjacent_tiles = 1
					}
					random_list = {
						70 = {
							clear_deposits = yes
							set_blocker = "tb_alpha_ice_cap"
						}
						10 = {
							clear_deposits = yes
							set_blocker = "tb_alpha_mountain_range"
						}
						20 = {
						}
					}
				}
			}

			every_tile = {
				limit = { 
					OR = {
						has_blocker = "tb_alpha_mountain_range"
					}
				}
				random_neighboring_tile = {
					limit = { 
						NOR = {
							has_blocker = "tb_alpha_mountain_range"
							has_blocker = "tb_alpha_ocean_vortex"
							has_blocker = "tb_alpha_volcano_chain"
							has_blocker = "tb_massive_glacier"
							has_blocker = "tb_mountain_range"
							has_blocker = "tb_alpha_ice_cap"
							has_building = yes
							has_grown_pop = yes
							has_growing_pop = yes
							has_building_construction = yes 
						}
					}
					clear_deposits = yes
					remove_blocker = yes
					set_blocker = "tb_massive_glacier"
				}
				
				random_neighboring_tile = {
					limit = { 
						NOR = {
							has_blocker = "tb_alpha_mountain_range"
							has_blocker = "tb_alpha_ocean_vortex"
							has_blocker = "tb_alpha_volcano_chain"
							has_blocker = "tb_massive_glacier"
							has_blocker = "tb_mountain_range"
							has_blocker = "tb_alpha_ice_cap"
							has_building = yes
							has_grown_pop = yes
							has_growing_pop = yes
							has_building_construction = yes 
						}
					}
					clear_deposits = yes
					set_deposit = d_mountains_deposit
					remove_blocker = yes
					set_blocker = "tb_mountain_range"				
				}
			}
			
			every_tile = {
				limit = { 
					OR = {
						has_blocker = "tb_alpha_volcano_chain"
					}
				}
				random_neighboring_tile = {
					limit = { 
						NOR = {
							has_blocker = "tb_alpha_mountain_range"
							has_blocker = "tb_alpha_ocean_vortex"
							has_blocker = "tb_alpha_volcano_chain"
							has_blocker = "tb_active_volcano"
							has_blocker = "tb_alpha_ice_cap"
							has_building = yes
							has_grown_pop = yes
							has_growing_pop = yes
							has_building_construction = yes 
						}
					}
					clear_deposits = yes
					set_deposit = d_volcano_deposit
					remove_blocker = yes
					set_blocker = "tb_active_volcano"
				}
				
				random_neighboring_tile = {
					limit = { 
						NOR = {
							has_blocker = "tb_alpha_mountain_range"
							has_blocker = "tb_alpha_ocean_vortex"
							has_blocker = "tb_alpha_volcano_chain"
							has_blocker = "tb_active_volcano"
							has_blocker = "tb_alpha_ice_cap"
						}
					}
					clear_deposits = yes
					set_deposit = d_geothermal_deposit
				}
				random_neighboring_tile = {
					limit = { 
						NOR = {
							has_blocker = "tb_alpha_mountain_range"
							has_blocker = "tb_alpha_ocean_vortex"
							has_blocker = "tb_alpha_volcano_chain"
							has_blocker = "tb_active_volcano"
							has_blocker = "tb_alpha_ice_cap"
						}
					}
					clear_deposits = yes
					set_deposit = d_geothermal_deposit		
				}
			}
			
			every_tile = {
				limit = { 
					OR = {
						has_blocker = "tb_alpha_ocean_vortex"
					}
				}
				every_neighboring_tile = {
					clear_deposits = yes
					set_deposit = d_volcano_deposit
					remove_blocker = yes
				}
			}
			
			every_tile = {
				limit = { 
					has_deposit = "d_great_oasis_deposit"
					has_building = no
					has_grown_pop = no
					has_growing_pop = no
					has_building_construction = no
				}
				remove_blocker = yes
				set_blocker = "tb_great_oasis"
			}
			
			every_tile = {
				limit = { 
					has_deposit = "d_geothermalsprings_deposit"
					has_building = no
					has_grown_pop = no
					has_growing_pop = no
					has_building_construction = no
				}
				remove_blocker = yes
				set_blocker = "tb_geothermal_springs"
			}
			
			every_tile = {
				limit = { 
					has_deposit = "d_jurassicvalley_deposit"
					has_building = no
					has_grown_pop = no
					has_growing_pop = no
					has_building_construction = no
				}
				remove_blocker = yes
				set_blocker = "tb_jurrasic_valley"
			}
			
			every_tile = {
				limit = { 
					has_deposit = "d_jungleofriches_deposit"
					has_building = no
					has_grown_pop = no
					has_growing_pop = no
					has_building_construction = no
				}
				remove_blocker = yes
				set_blocker = "tb_jungle_riches"
			}
			
			every_tile = {
				limit = { 
					has_deposit = "d_precursorruins_deposit"
					has_building = no
					has_grown_pop = no
					has_growing_pop = no
					has_building_construction = no
				}
				remove_blocker = yes
				set_blocker = "tb_ancient_ruins"
			}
			
			every_tile = {
				limit = { 
					has_deposit = "d_massivecaverns_deposit"
					has_building = no
					has_grown_pop = no
					has_growing_pop = no
					has_building_construction = no
				}
				remove_blocker = yes
				set_blocker = "tb_massive_caverns"
			}
		
			every_tile = {
				limit = {
					OR = {
						has_blocker = "tb_alpha_mountain_range"
						has_blocker = "tb_alpha_ocean_vortex"
						has_blocker = "tb_alpha_volcano_chain"
						has_blocker = "tb_alpha_ice_cap"
					}
				}
				clear_deposits = yes
			}
		}
	}
}

event = {
	id = landscaper_surveys.2

	is_triggered_only = yes
	location = ROOT
	hide_window = yes
	
	trigger = {
		ROOT = {
			has_planet_flag = alphamod_surveyed_land
		}
	}
	
	immediate = {
		ROOT = {
			every_tile = {
				limit = {
					OR = {
						has_blocker = "tb_alpha_mountain_range"
						has_blocker = "tb_alpha_ocean_vortex"
						has_blocker = "tb_alpha_volcano_chain"
						has_blocker = "tb_alpha_ice_cap"
					}
				}
				clear_deposits = yes
			}
		}
	}
}

country_event = {
	id = landscaper_surveys.3
	hide_window = yes

	is_triggered_only = false
	
	trigger = {
		not = { has_country_flag = cf_homesystem_barrens }
		has_technology = tech_alpha_survey_corps
		or = {
			is_country_type = default
			is_ai = no
		}
	}
	
	immediate = {
		set_country_flag = cf_homesystem_barrens
		
		owner_species = {
			home_planet = {
				random_moon = {
					limit = {
						is_planet_class = pc_barren
						planet_size > 5
					}
					make_barren_habitable = yes
				}
			}
			
			home_planet = {
				solar_system = {
					random_system_planet = {
						limit = {
							is_planet_class = pc_barren
							planet_size > 4
						}
						make_barren_habitable = yes
					}				
				}
			}
			
			home_planet = {
				solar_system = {
					random_system_planet = {
						limit = {
							is_planet_class = pc_asteroid
							planet_size > 4
						}
						random_list = {
							50 = {
								make_asteroid_habitable = yes
							}
							50 = {}
						}
					}
				}
			}
			
			home_planet = {
				solar_system = {
					random_system_planet = {
						limit = {
							is_planet_class = pc_asteroid
							planet_size > 6
						}
						random_list = {
							25 = {
								make_asteroid_habitable = yes
							}
							75 = {}
						}
					}
				}
			}
		}
	}
}