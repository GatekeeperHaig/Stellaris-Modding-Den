### This file changes vanlla leviathans. It includes only pertinent events.

namespace = guardian

@tier1influencecontact = 7
@tier1influencecontactxenophile = 8
@tier1influencecontactmin = 20
@tier1influencecontactmax = 80

@tier2influencecontact = 10
@tier2influencecontactxenophile = 12
@tier2influencecontactmin = 40
@tier2influencecontactmax = 100

@tier1materialreward = 6
@tier1materialmin = 100
@tier1materialmax = 500
@tier2materialreward = 12
@tier2materialmin = 150
@tier2materialmax = 1000
@tier3materialreward = 18
@tier3materialmin = 250
@tier3materialmax = 1500
@tier4materialreward = 24
@tier4materialmin = 350
@tier4materialmax = 2000
@tier5materialreward = 48
@tier5materialmin = 700
@tier5materialmax = 4000

@tier1influencereward = 6
@tier1influencemin = 40
@tier1influencemax = 100
@tier2influencereward = 12
@tier2influencemin = 80
@tier2influencemax = 175
@tier3influencereward = 18
@tier3influencemin = 125
@tier3influencemax = 250
@tier4influencereward = 24
@tier4influencemin = 150
@tier4influencemax = 300
@tier5influencereward = 36
@tier5influencemin = 250
@tier5influencemax = 500
@tier6influencereward = 48
@tier6influencemin = 300
@tier6influencemax = 600

@tier1researchreward = 6
@tier1researchmin = 60
@tier1researchmax = 150
@tier2researchreward = 12
@tier2researchmin = 90
@tier2researchmax = 250
@tier3researchreward = 18
@tier3researchmin = 120
@tier3researchmax = 350
@tier4researchreward = 24
@tier4researchmin = 150
@tier4researchmax = 500
@tier5researchreward = 48
@tier5researchmin = 300
@tier5researchmax = 1000

# Stellarite system is updated and Gaia world unlocks
ship_event = {
	id = guardian.1018
	title = guardian.1000.name
	desc = {
		trigger = {
			hidden:owner = {
				switch = {
					trigger = has_country_flag
					stellarite_project_success = { text = guardian.1018.desc }
					default = { text = guardian.1018.alt.desc }
				}
			}
		}
	}
	picture = GFX_evt_star_yellow
	show_sound = event_radio_chatter
	location = root

	is_triggered_only = yes

	immediate = {
		random_system = {
			limit = {
				has_star_flag = guardians_stellarite_system
			}
			save_event_target_as = guardians_stellarite_home_system
			random_system_planet = {
				limit = {
					is_planet_class = pc_frozen
				}
				save_event_target_as = stellarite_rich_planet
			}
		}
		random_list = { #chance increased from 70 to 80
			80 = { owner = { set_country_flag = stellarite_project_success } }
			20 = {
				root = {
					kill_leader = { type = scientist show_notification = no }
					fleet = {
						destroy_fleet = this
					}
				}
			}
		}
	}

	option = {
		name = EXCELLENT
		custom_tooltip = guardian.1018.a.tooltip
		trigger = {
			owner = {
				has_country_flag = stellarite_project_success
			}
		}
		hidden_effect = {
			owner = { remove_country_flag = stellarite_project_success }
			random_system = {
				limit = {
					has_star_flag = guardians_stellarite_system
				}
				random_system_planet = {
					limit = {
						is_star = yes
					}
					change_planet_size = 12
					spawn_sun_temperature_effect = yes
				}
				every_system_planet = {
					limit = {
						is_star = no
						is_asteroid = no
					}
					spawn_planet_temperature_effect = yes
					remove_modifier = stellarite_low_temp
					if = {
						limit = {
							is_planet_class = pc_frozen
							NOT = { has_planet_flag = stellarite_terraformed }
							solar_system = {
								NOT = { has_star_flag = gaia_planet_gained }
							}
						}
						change_pc = pc_gaia
						change_planet_size = 25 #added size increase
						set_planet_flag = stellarite_terraformed
						reroll_planet = yes
						solar_system = { set_star_flag = gaia_planet_gained }
						else = {
							if = {
								limit = {
									is_planet_class = pc_frozen
									NOT = { has_planet_flag = stellarite_terraformed }
									solar_system = {
										has_star_flag = gaia_planet_gained
									}
								}
								increase_planet_temperature = yes
								set_planet_flag = stellarite_terraformed
								else = {
									increase_planet_temperature = yes
									set_planet_flag = stellarite_terraformed
								}
							}
						}
					}
				}
			}
		}
	}
	option = {
		name = UNFORTUNATE
		custom_tooltip = guardian.1018.b.tooltip
		trigger = {
			owner = {
				NOT = { has_country_flag = stellarite_project_success }
			}
		}
		hidden_effect = {
			random_system = {
				limit = {
					has_star_flag = guardians_stellarite_system
				}
				random_system_planet = {
					limit = {
						is_star = yes
					}
					change_planet_size = 8
					planet_event = { id = guardian.1019 }
				}
				every_system_planet = {
					limit = {
						is_star = no
						is_asteroid = no
					}
					spawn_planet_temperature_effect = yes
					remove_modifier = stellarite_low_temp
					if = {
						limit = {
							is_planet_class = pc_frozen
							NOT = { has_planet_flag = stellarite_terraformed }
						}
						change_pc = pc_tundra
						change_planet_size = 25 #added size increase
						set_planet_flag = stellarite_terraformed
						reroll_planet = yes
						else = {
							if = {
								limit = {
									is_planet_class = pc_frozen
									NOT = { has_planet_flag = stellarite_terraformed }
									solar_system = {
										has_star_flag = gaia_planet_gained
									}
								}
								increase_planet_temperature = yes
								set_planet_flag = stellarite_terraformed
								reroll_planet = yes
								else = {
									increase_planet_temperature = yes
									set_planet_flag = stellarite_terraformed
									reroll_planet = yes
								}
							}
						}
					}
				}
			}
		}
	}
}

#Hacking the technosphere - success ##changed the computer tech given
country_event = {
	id = guardian.1052
	title = guardian.1050.name
	desc = {
		trigger = {
			NOT = { has_ethic = ethic_gestalt_consciousness }
		}
		text = guardian.1052.desc
	}
	desc = {
		trigger = { has_ethic = ethic_gestalt_consciousness }
		text = guardian.1052.gestalt.desc
	}
	picture = GFX_evt_technosphere
	show_sound = event_ai_started
	location = event_target:technosphere_ship
	is_triggered_only = yes

	trigger = {
		exists = event_target:technosphere_ship
	}

	immediate = {
		event_target:guardian_technosphere_country = {
			random_owned_ship = {
				limit = {
					is_ship_size = sphere
				}
				save_event_target_as = technosphere_location
			}
		}
	}
	after = {
		add_modifier = {
			modifier = infinity_calculations_hacked
			days = -1
		}
		event_target:technosphere_location = {
			solar_system = {
				save_event_target_as = slain_guardian_system
			}
			fleet = {
				destroy_fleet = this
			}
		}
		hidden_effect = {
			country_event = { id = guardian.1039 }
		}
	}
	option = {
		name = guardian.1052.a
		give_technology = { tech = tech_zero_point_power }
		trigger = {
			NOT = {
				has_technology = tech_zero_point_power
			}
		}
	}
	option = {
		name = guardian.1052.a
		trigger = {
			has_technology = tech_zero_point_power
			NOT = {
				has_technology = tech_sentient_computer
			}
		}
		give_technology = { tech = tech_sentient_computer }
	}
	option = {
		name = guardian.1052.a
		trigger = {
			has_technology = tech_zero_point_power
			has_technology = tech_sentient_computer
		}
		add_monthly_resource_mult = {
			resource = society_research
			value = 24
			min = 1000
			max = 5000
		}
	}
}


#Researching the black hole - success
country_event = {
	id = guardian.1061
	title = sphere
	desc = guardian.1061.desc
	is_triggered_only = yes
	diplomatic = yes

	trigger = { exists = event_target:technosphere_ship }

	picture_event_data = {
		room = technosphere_room
	}

	immediate = {
		random_system = {
			limit = {
				has_star_flag = guardians_technosphere_system
			}
			random_system_planet = {
				limit = {
					is_star = yes
				}
				save_event_target_as = technosphere_blackhole
			}
		}
	}

	option = {
		name = guardian.1061.a
		response_text = guardian.1061.a.reply
		give_technology = { tech = tech_zero_point_power }
		add_influence = 150
		trigger = {
			NOT = {
				has_technology = tech_zero_point_power
			}
		}
	}
	option = {
		name = guardian.1061.a
		response_text = guardian.1061.a.reply
		give_technology = { tech = tech_sentient_computer }
		add_influence = 150
		trigger = {
			has_technology = tech_zero_point_power
			NOT = {
				has_technology = tech_sentient_computer
			}
		}
	}
	option = {
		name = guardian.1061.b
		response_text = guardian.1061.b.reply
		add_modifier = {
			modifier = infinity_calculations
			days = -1
		}
		trigger = {
			NOR = {
				has_technology = tech_zero_point_power
				has_technology = tech_sentient_computer
			}
		}
	}
	option = {
		name = guardian.1061.b.alt
		response_text = guardian.1061.b.reply
		add_modifier = {
			modifier = infinity_calculations
			days = -1
		}
		trigger = {
			has_technology = tech_zero_point_power
			has_technology = tech_sentient_computer
		}
	}
}

#The technosphere submerges itself into the hole - FAIL
country_event = {
	id = guardian.1063
	title = sphere
	desc = guardian.1063.desc
	is_triggered_only = yes
	picture = GFX_evt_technosphere
	show_sound = event_mystic_reveal
	location = event_target:technosphere_ship

	is_triggered_only = yes

	trigger = { exists = event_target:technosphere_ship }

	option = {
		name = PECULIAR
		custom_tooltip = guardian.1063.a.tooltip
		add_influence = 150
		if = {
			limit = {
				NOT = {
					has_technology = tech_zero_point_power
				}
			}
			give_technology = { tech = tech_zero_point_power }
			else = {
				if = {
					limit = {
						NOT = { has_technology = tech_sentient_computer }
					}
					give_technology = { tech = tech_sentient_computer }
					else = {
						add_influence = 150
					}
				}
			}
		}
		hidden_effect = {
			event_target:technosphere_ship = {
				solar_system = {
					random_system_planet = {
						limit = { is_star = yes }
						orbital_deposit_tile = {
							add_deposit =  d_immense_physics_deposit
							add_deposit =  d_immense_engineering_deposit
							add_deposit =  d_immense_society_deposit
						}
					}
				}
			}
			event_target:technosphere_ship = {
				solar_system = {
					save_event_target_as = slain_guardian_system
				}
				delete_fleet = this
			}
			country_event = { id = guardian.1039 }
		}
	}
}

# Ship destroyed perp port
country_event = {
	id = guardian.2099
	title = "guardian.2101.name"
	desc = {
		text = "guardian.2101.desc"
		trigger = { NOT = { owner = { has_ethic = ethic_gestalt_consciousness } } }
	}
	desc = {
		text = "guardian.2101.desc.gesta"
		trigger = { owner = { has_ethic = ethic_gestalt_consciousness } }
	}
	picture = GFX_evt_enigmatic_fortress
	show_sound = event_space_battle
	location = fromfrom

	is_triggered_only = yes

	trigger = {
		exists = event_target:fortress_country
		from = { is_same_value = event_target:fortress_country }
		exists = event_target:fortress_vault_core
		event_target:fortress_country = {
			count_owned_ships = { # Check that all ships are disabled
				limit = { is_disabled = no }
				count < 1
			}
		}
	}

	immediate = {
		establish_communications_no_message = event_target:fortress_country
		#event_target:fortress_country = {
			event_target:fortress_vault_core = {
				#limit = { has_ship_flag = fortress_vault }
				save_global_event_target_as = disabled_enigmatic_fortress
			}
		#}
		every_playable_country = {
			limit = { has_event_chain = "enigmatic_fortress_chain" }
			end_event_chain = "enigmatic_fortress_chain"
		}
	}

	option = {
		name = "guardian.2101.a"
		begin_event_chain = {
			event_chain = "enigmatic_fortress_chain"
			target = root
		}
		hidden_effect = { country_event = { id = guardian.2111 } }
		trigger = { NOT = { has_ethic = ethic_gestalt_consciousness } }
	}

	option = {
		name = "guardian.2101.b"
		hidden_effect = { country_event = { id = guardian.2160 days = 360 } }
		trigger = { NOT = { has_ethic = ethic_gestalt_consciousness } }
	}

	option = {
		name = guardian.2101.c.gesta
		trigger = { has_ethic = ethic_gestalt_consciousness }
		owner = {
			add_monthly_resource_mult = {
				resource = engineering_research
				value = 24
				min = 1000
				max = 5000
			}
			add_monthly_resource_mult = {
				resource = physics_research
				value = 24
				min = 1000
				max = 5000
			}
			add_monthly_resource_mult = {
				resource = society_research
				value = 24
				min = 1000
				max = 5000
			}
			random_list = { # event weights changed to make different combinations possible, and more random
				15 = {
					add_research_option = tech_enigmatic_deflector
					add_tech_progress = {
						tech = tech_enigmatic_deflector
						progress = 0.30
					}
				}
				15 = {
					add_research_option = tech_enigmatic_power_core
					add_tech_progress = {
						tech = tech_enigmatic_power_core
						progress = 0.30
					}
				}
				15 = {
					add_research_option = tech_enigmatic_decoder
					add_tech_progress = {
						tech = tech_enigmatic_decoder
						progress = 0.30
					} 
				}					
				15 = {
					add_research_option = tech_enigmatic_encoder
					add_tech_progress = {
						tech = tech_enigmatic_encoder
						progress = 0.30
					} 
				}			
				10 = {
					add_research_option = tech_enigmatic_encoder
					add_tech_progress = {
						tech = tech_enigmatic_encoder
						progress = 0.30
					} 
					add_research_option = tech_enigmatic_decoder
					add_tech_progress = {
						tech = tech_enigmatic_decoder
						progress = 0.30
					}				
				}
				6 = {
					add_research_option = tech_enigmatic_encoder
					add_tech_progress = {
						tech = tech_enigmatic_encoder
						progress = 0.30
					}
					add_research_option = tech_enigmatic_power_core
					add_tech_progress = {
						tech = tech_enigmatic_power_core
						progress = 0.30
					}				
				}			
				6 = {
					add_research_option = tech_enigmatic_encoder
					add_tech_progress = {
						tech = tech_enigmatic_encoder
						progress = 0.30
					}
					add_research_option = tech_enigmatic_deflector
					add_tech_progress = {
						tech = tech_enigmatic_deflector
						progress = 0.30
					}				
				}		
				6 = {
					add_research_option = tech_enigmatic_decoder
					add_tech_progress = {
						tech = tech_enigmatic_decoder
						progress = 0.30
					}
					add_research_option = tech_enigmatic_power_core
					add_tech_progress = {
						tech = tech_enigmatic_power_core
						progress = 0.30
					}				
				}			
				6 = {
					add_research_option = tech_enigmatic_decoder
					add_tech_progress = {
						tech = tech_enigmatic_decoder
						progress = 0.30
					}
					add_research_option = tech_enigmatic_deflector
					add_tech_progress = {
						tech = tech_enigmatic_deflector
						progress = 0.30
					}				
				}									
				6 = {
					add_research_option = tech_enigmatic_power_core
					add_tech_progress = {
						tech = tech_enigmatic_power_core
						progress = 0.30
					}
					add_research_option = tech_enigmatic_deflector
					add_tech_progress = {
						tech = tech_enigmatic_deflector
						progress = 0.30
					}				
				}				
			}
			}
		}
		hidden_effect = {
			# scuttle fortress
			event_target:fortress_vault_core = {
				fleet = {
					set_event_locked = no
					destroy_fleet = this
				}
			}
			#event_target:fortress_country = {
			#	every_owned_fleet = {
			#		delete_fleet = this
			#	}
			#}
			#event_target:fortress_vault_core = {
			#	solar_system = {
			#		random_system_planet = {
			#			limit = { is_star = yes }
			#			create_ambient_object = {
			#				type = "dead_enigmatic_fortress_object"
			#				location = solar_system
			#			}
			#			last_created_ambient_object = {
			#				save_global_event_target_as = fortress_ambient
			#				set_location = {
			#					target = PREV
			#					distance = 110
			#					angle = 110
			#				}
			#			}
			#		}
			#	}
			#	fleet = {
			#		delete_fleet = this
			#	}
			#}
		}
	}
}

# The Heart of Dark Matter
country_event = {
	id = guardian.2151
	title = "guardian.2151.name"
	desc = "guardian.2151.desc"
	picture = GFX_evt_enigmatic_fortress
	show_sound = event_laboratory_sound
	location = from
	
	is_triggered_only = yes

	immediate = {
		set_country_flag = fortress_solved
		event_target:disabled_enigmatic_fortress = {
			save_event_target_as = slain_guardian_system
		}
		every_country = {
			limit = {
				is_country_type = default
				has_event_chain = curator_poi_chain
				event_target:slain_guardian_system = {
					is_point_of_interest = {
						id = curator_poi_fortress
						event_chain = curator_poi_chain
						owner = prev
					}
				}
			}
			remove_point_of_interest = curator_poi_fortress
			end_curator_chain = yes
		}
		event_target:disabled_enigmatic_fortress = {
			solar_system = {
				random_system_planet = {
					limit = { is_star = yes }
					create_ambient_object = {
						type = "dead_enigmatic_fortress_object"
						location = solar_system
					}
					last_created_ambient_object = {
						save_global_event_target_as = fortress_ambient
						set_location = {
							target = PREV
							distance = 110
							angle = 110
						}
					}
				}

			}
			fleet = {
				delete_fleet = this
			}
		}
	}
	
	option = {
		name = "guardian.2151.a"
		add_monthly_resource_mult = {
			resource = engineering_research
			value = 24
			min = 1000
			max = 5000
		}
		add_monthly_resource_mult = {
			resource = physics_research
			value = 24
			min = 1000
			max = 5000
		}
		add_monthly_resource_mult = {
			resource = society_research
			value = 24
			min = 1000
			max = 5000
		}
		random_list = { # event weights changed to make different combinations possible, and more random
			15 = {
				add_research_option = tech_enigmatic_deflector
				add_tech_progress = {
					tech = tech_enigmatic_deflector
					progress = 0.30
				}
			}
			15 = {
				add_research_option = tech_enigmatic_power_core
				add_tech_progress = {
					tech = tech_enigmatic_power_core
					progress = 0.30
				}
			}
			15 = {
				add_research_option = tech_enigmatic_decoder
				add_tech_progress = {
					tech = tech_enigmatic_decoder
					progress = 0.30
				} 
			}					
			15 = {
				add_research_option = tech_enigmatic_encoder
				add_tech_progress = {
					tech = tech_enigmatic_encoder
					progress = 0.30
				} 
			}			
			10 = {
				add_research_option = tech_enigmatic_encoder
				add_tech_progress = {
					tech = tech_enigmatic_encoder
					progress = 0.30
				} 
				add_research_option = tech_enigmatic_decoder
				add_tech_progress = {
					tech = tech_enigmatic_decoder
					progress = 0.30
				}				
			}
			6 = {
				add_research_option = tech_enigmatic_encoder
				add_tech_progress = {
					tech = tech_enigmatic_encoder
					progress = 0.30
				}
				add_research_option = tech_enigmatic_power_core
				add_tech_progress = {
					tech = tech_enigmatic_power_core
					progress = 0.30
				}				
			}			
			6 = {
				add_research_option = tech_enigmatic_encoder
				add_tech_progress = {
					tech = tech_enigmatic_encoder
					progress = 0.30
				}
				add_research_option = tech_enigmatic_deflector
				add_tech_progress = {
					tech = tech_enigmatic_deflector
					progress = 0.30
				}				
			}		
			6 = {
				add_research_option = tech_enigmatic_decoder
				add_tech_progress = {
					tech = tech_enigmatic_decoder
					progress = 0.30
				}
				add_research_option = tech_enigmatic_power_core
				add_tech_progress = {
					tech = tech_enigmatic_power_core
					progress = 0.30
				}				
			}			
			6 = {
				add_research_option = tech_enigmatic_decoder
				add_tech_progress = {
					tech = tech_enigmatic_decoder
					progress = 0.30
				}
				add_research_option = tech_enigmatic_deflector
				add_tech_progress = {
					tech = tech_enigmatic_deflector
					progress = 0.30
				}				
			}									
			6 = {
				add_research_option = tech_enigmatic_power_core
				add_tech_progress = {
					tech = tech_enigmatic_power_core
					progress = 0.30
				}
				add_research_option = tech_enigmatic_deflector
				add_tech_progress = {
					tech = tech_enigmatic_deflector
					progress = 0.30
				}				
			}				
		}
		end_event_chain = "enigmatic_fortress_chain"
	}
}

# The Middle Path
country_event = {
	id = guardian.2154
	title = "guardian.2154.name"
	desc = "guardian.2154.desc"
	picture = GFX_evt_enigmatic_fortress
	show_sound = event_laboratory_sound
	location = event_target:disabled_enigmatic_fortress
	
	is_triggered_only = yes

	immediate = {
		set_country_flag = fortress_solved
		event_target:disabled_enigmatic_fortress = {
			save_event_target_as = slain_guardian_system
		}
		every_country = {
			limit = {
				is_country_type = default
				has_event_chain = curator_poi_chain
				event_target:slain_guardian_system = {
					is_point_of_interest = {
						id = curator_poi_fortress
						event_chain = curator_poi_chain
						owner = prev
					}
				}
			}
			remove_point_of_interest = curator_poi_fortress
			end_curator_chain = yes
		}
		event_target:disabled_enigmatic_fortress = {
			solar_system = {
				random_system_planet = {
					limit = { is_star = yes }
					create_ambient_object = {
						type = "dead_enigmatic_fortress_object"
						location = solar_system
					}
					last_created_ambient_object = {
						save_global_event_target_as = fortress_ambient
						set_location = {
							target = PREV
							distance = 110
							angle = 110
						}
					}
					#create_ambient_object = {
					#	type = explosion_particle_object
					#	location = this
					#	use_3d_location = yes
					#	duration = 10
					#	scale = 20
					#}
					#last_created_ambient_object = {
					#	set_location = {
					#		target = PREV
					#		distance = 110
					#		angle = 110
					#	}
					#}
				}
			}
			fleet = {
				delete_fleet = this
			}
		}
	}
	
	option = {
		name = "guardian.2154.a"
		add_monthly_resource_mult = {
			resource = engineering_research
			value = 24
			min = 1000
			max = 5000
		}
		add_monthly_resource_mult = {
			resource = physics_research
			value = 24
			min = 1000
			max = 5000
		}
		add_monthly_resource_mult = {
			resource = society_research
			value = 24
			min = 1000
			max = 5000
		}
		random_list = { # event weights changed to make different combinations possible, and more random
			15 = {
				add_research_option = tech_enigmatic_deflector
				add_tech_progress = {
					tech = tech_enigmatic_deflector
					progress = 0.30
				}
			}
			15 = {
				add_research_option = tech_enigmatic_power_core
				add_tech_progress = {
					tech = tech_enigmatic_power_core
					progress = 0.30
				}
			}
			15 = {
				add_research_option = tech_enigmatic_decoder
				add_tech_progress = {
					tech = tech_enigmatic_decoder
					progress = 0.30
				} 
			}					
			15 = {
				add_research_option = tech_enigmatic_encoder
				add_tech_progress = {
					tech = tech_enigmatic_encoder
					progress = 0.30
				} 
			}			
			10 = {
				add_research_option = tech_enigmatic_encoder
				add_tech_progress = {
					tech = tech_enigmatic_encoder
					progress = 0.30
				} 
				add_research_option = tech_enigmatic_decoder
				add_tech_progress = {
					tech = tech_enigmatic_decoder
					progress = 0.30
				}				
			}
			6 = {
				add_research_option = tech_enigmatic_encoder
				add_tech_progress = {
					tech = tech_enigmatic_encoder
					progress = 0.30
				}
				add_research_option = tech_enigmatic_power_core
				add_tech_progress = {
					tech = tech_enigmatic_power_core
					progress = 0.30
				}				
			}			
			6 = {
				add_research_option = tech_enigmatic_encoder
				add_tech_progress = {
					tech = tech_enigmatic_encoder
					progress = 0.30
				}
				add_research_option = tech_enigmatic_deflector
				add_tech_progress = {
					tech = tech_enigmatic_deflector
					progress = 0.30
				}				
			}		
			6 = {
				add_research_option = tech_enigmatic_decoder
				add_tech_progress = {
					tech = tech_enigmatic_decoder
					progress = 0.30
				}
				add_research_option = tech_enigmatic_power_core
				add_tech_progress = {
					tech = tech_enigmatic_power_core
					progress = 0.30
				}				
			}			
			6 = {
				add_research_option = tech_enigmatic_decoder
				add_tech_progress = {
					tech = tech_enigmatic_decoder
					progress = 0.30
				}
				add_research_option = tech_enigmatic_deflector
				add_tech_progress = {
					tech = tech_enigmatic_deflector
					progress = 0.30
				}				
			}									
			6 = {
				add_research_option = tech_enigmatic_power_core
				add_tech_progress = {
					tech = tech_enigmatic_power_core
					progress = 0.30
				}
				add_research_option = tech_enigmatic_deflector
				add_tech_progress = {
					tech = tech_enigmatic_deflector
					progress = 0.30
				}				
			}				
		}
		end_event_chain = "enigmatic_fortress_chain"
	}
}

# Dark Matter Gambit
country_event = {
	id = guardian.2156
	title = "guardian.2156.name"
	desc = "guardian.2156.desc"
	picture = GFX_evt_enigmatic_fortress
	show_sound = event_laboratory_sound
	location = event_target:disabled_enigmatic_fortress
	
	is_triggered_only = yes

	immediate = {
		set_country_flag = fortress_solved
		event_target:disabled_enigmatic_fortress = {
			save_event_target_as = slain_guardian_system
		}
		every_country = {
			limit = {
				is_country_type = default
				has_event_chain = curator_poi_chain
				event_target:slain_guardian_system = {
					is_point_of_interest = {
						id = curator_poi_fortress
						event_chain = curator_poi_chain
						owner = prev
					}
				}
			}
			remove_point_of_interest = curator_poi_fortress
			end_curator_chain = yes
		}
		event_target:disabled_enigmatic_fortress = {
			solar_system = {
				random_system_planet = {
					limit = { is_star = yes }
					create_ambient_object = {
						type = "dead_enigmatic_fortress_object"
						location = solar_system
					}
					last_created_ambient_object = {
						save_global_event_target_as = fortress_ambient
						set_location = {
							target = PREV
							distance = 110
							angle = 110
						}
					}
				}

			}
			fleet = {
				delete_fleet = this
			}
		}
	}
	
	option = {
		name = "guardian.2156.a"
		add_monthly_resource_mult = {
			resource = engineering_research
			value = 24
			min = 1000
			max = 5000
		}
		add_monthly_resource_mult = {
			resource = physics_research
			value = 24
			min = 1000
			max = 5000
		}
		add_monthly_resource_mult = {
			resource = society_research
			value = 24
			min = 1000
			max = 5000
		}
		random_list = { # event weights changed to make different combinations possible, and more random
			15 = {
				add_research_option = tech_enigmatic_deflector
				add_tech_progress = {
					tech = tech_enigmatic_deflector
					progress = 0.30
				}
			}
			15 = {
				add_research_option = tech_enigmatic_power_core
				add_tech_progress = {
					tech = tech_enigmatic_power_core
					progress = 0.30
				}
			}
			15 = {
				add_research_option = tech_enigmatic_decoder
				add_tech_progress = {
					tech = tech_enigmatic_decoder
					progress = 0.30
				} 
			}					
			15 = {
				add_research_option = tech_enigmatic_encoder
				add_tech_progress = {
					tech = tech_enigmatic_encoder
					progress = 0.30
				} 
			}			
			10 = {
				add_research_option = tech_enigmatic_encoder
				add_tech_progress = {
					tech = tech_enigmatic_encoder
					progress = 0.30
				} 
				add_research_option = tech_enigmatic_decoder
				add_tech_progress = {
					tech = tech_enigmatic_decoder
					progress = 0.30
				}				
			}
			6 = {
				add_research_option = tech_enigmatic_encoder
				add_tech_progress = {
					tech = tech_enigmatic_encoder
					progress = 0.30
				}
				add_research_option = tech_enigmatic_power_core
				add_tech_progress = {
					tech = tech_enigmatic_power_core
					progress = 0.30
				}				
			}			
			6 = {
				add_research_option = tech_enigmatic_encoder
				add_tech_progress = {
					tech = tech_enigmatic_encoder
					progress = 0.30
				}
				add_research_option = tech_enigmatic_deflector
				add_tech_progress = {
					tech = tech_enigmatic_deflector
					progress = 0.30
				}				
			}		
			6 = {
				add_research_option = tech_enigmatic_decoder
				add_tech_progress = {
					tech = tech_enigmatic_decoder
					progress = 0.30
				}
				add_research_option = tech_enigmatic_power_core
				add_tech_progress = {
					tech = tech_enigmatic_power_core
					progress = 0.30
				}				
			}			
			6 = {
				add_research_option = tech_enigmatic_decoder
				add_tech_progress = {
					tech = tech_enigmatic_decoder
					progress = 0.30
				}
				add_research_option = tech_enigmatic_deflector
				add_tech_progress = {
					tech = tech_enigmatic_deflector
					progress = 0.30
				}				
			}									
			6 = {
				add_research_option = tech_enigmatic_power_core
				add_tech_progress = {
					tech = tech_enigmatic_power_core
					progress = 0.30
				}
				add_research_option = tech_enigmatic_deflector
				add_tech_progress = {
					tech = tech_enigmatic_deflector
					progress = 0.30
				}				
			}				
		}		
		end_event_chain = "enigmatic_fortress_chain"
	}
}

# Special Project Completed
ship_event = { #the horror was changed to drop extra-dimensional weapons instead of jump drive tech
	id = guardian.3004
	title = "PROJECT_COMPLETE"
	picture = GFX_evt_dimensional_horror
	show_sound = event_laboratory_sound
	
	desc = {
		text = "guardian.3004a.desc"
		trigger = {
			owner = {
				NOT = { has_technology = tech_extradimensional_weapon_1	}
			}
		}
	}
	desc = {
		text = "guardian.3004b.desc"
		trigger = {
			owner = {
				has_technology = tech_extradimensional_weapon_1
			}
		}
	}
	
	is_triggered_only = yes
	
	immediate = {
		random_ambient_object = {
			limit = { has_ambient_object_flag = horror_energy }
			destroy_ambient_object = this
		}
	}
	
	option = {
		name = "EXCELLENT"
		trigger = {
			owner = {
				NOT = { has_technology = tech_extradimensional_weapon_1	}
			}
		}
		owner = {
			add_research_option = tech_extradimensional_weapon_1
			add_tech_progress = {
				tech = tech_extradimensional_weapon_1
				progress = 0.5
			}
			add_monthly_resource_mult = {
				resource = physics_research
				value = 24
				min = 4000
				max = 6000
			}
			add_monthly_resource_mult = {
				resource = society_research
				value = 24
				min = 4000
				max = 6000
			}
		}
	}
	option = {
		name = "EXCELLENT"
		trigger = {
			owner = {
				has_technology = tech_extradimensional_weapon_1
			}
		}
		owner = {
			add_monthly_resource_mult = {
				resource = physics_research
				value = 24
				min = 4000
				max = 6000
			}
			add_monthly_resource_mult = {
				resource = society_research
				value = 24
				min = 4000
				max = 6000
			}
		}
	}
}

# Dreadnought Rebuilt
ship_event = { ###this event needs to be rebuilt properly. point!
	id = guardian.3103
	title = "guardian.3103"
	desc = {
		trigger = { owner = { NOT = { has_authority = auth_machine_intelligence } } }
		text = guardian.3103.desc
	}
	desc = {
		trigger = { owner = { has_authority = auth_machine_intelligence } }
		text = guardian.3103.desc.mach
	}
	picture = GFX_evt_automated_dreadnought
	show_sound = event_construction
	location = event_target:guardians_dreadnought_system
	
	is_triggered_only = yes
	
	immediate = {
		owner = {
			save_event_target_as = project_owner
			set_country_flag = restored_dreadnought
		}
	}
	
	option = {
		name = "guardian.3103.a"
		
		# Psi Jump Dreadnought if owner has it
		if = {
			limit = {
				owner = { has_technology = "tech_psi_jump_drive_1" }
			}
			create_fleet = {
				name = "NAME_Dreadnought"
				effect = {
					set_owner = event_target:project_owner
					create_ship = {
						name = random
						design = "NAME_Type_37" # Psi Jump Dreadnought
						graphical_culture = "npf_01"
						upgradable = no
					}
					set_location = {
						target = event_target:disabled_dreadnought_object
						distance = 0
						angle = random
					}
				}
			}
			hidden_effect = {
				event_target:disabled_dreadnought_object = { destroy_ambient_object = this }
				solar_system = {
					random_system_ambient_object = {
						limit = { has_ambient_object_flag = dreadnought_debris }
						destroy_ambient_object = this
					}
				}
			}
			break = yes
		}
		# Jump Dreadnought if owner has it
		if = {
			limit = {
				owner = { has_technology = "tech_jump_drive_1" }
			}
			create_fleet = {
				name = "NAME_Dreadnought"
				effect = {
					set_owner = event_target:project_owner
					create_ship = {
						name = random
						design = "NAME_Type_46" # Jump Dreadnought
						graphical_culture = "npf_01"
						upgradable = no
					}
					set_location = {
						target = event_target:disabled_dreadnought_object
						distance = 0
						angle = random
					}
				}
			}
			hidden_effect = {
				event_target:disabled_dreadnought_object = { destroy_ambient_object = this }
				solar_system = {
					random_system_ambient_object = {
						limit = { has_ambient_object_flag = dreadnought_debris }
						destroy_ambient_object = this
					}
				}
			}
			break = yes
		}
		# Warp Dreadnought if owner has it
		if = {
			limit = {
				owner = { 
					OR = {
						has_technology = "tech_warp_drive_1"
						has_technology = "tech_warp_drive_2"
						has_technology = "tech_warp_drive_3"
					}
				}
			}
			create_fleet = {
				name = "NAME_Dreadnought"
				effect = {
					set_owner = event_target:project_owner
					create_ship = {
						name = random
						design = "NAME_Type_14" # Warp Dreadnought
						graphical_culture = "npf_01"
						upgradable = no
					}
					set_location = {
						target = event_target:disabled_dreadnought_object
						distance = 0
						angle = random
					}
				}
			}
			hidden_effect = {
				event_target:disabled_dreadnought_object = { destroy_ambient_object = this }
				solar_system = {
					random_system_ambient_object = {
						limit = { has_ambient_object_flag = dreadnought_debris }
						destroy_ambient_object = this
					}
				}
			}
			break = yes
		}
		# Hyper Dreadnought if owner has it
		if = {
			limit = {
				owner = { 
					OR = {
						has_technology = "tech_hyper_drive_1"
						has_technology = "tech_hyper_drive_2"
						has_technology = "tech_hyper_drive_3"
					}
				}
			}
			create_fleet = {
				name = "NAME_Dreadnought"
				effect = {
					set_owner = event_target:project_owner
					create_ship = {
						name = random
						design = "NAME_Type_92" # Hyper Dreadnought
						graphical_culture = "npf_01"
						upgradable = no
					}
					set_location = {
						target = event_target:disabled_dreadnought_object
						distance = 0
						angle = random
					}
				}
			}
			hidden_effect = {
				event_target:disabled_dreadnought_object = { destroy_ambient_object = this }
				solar_system = {
					random_system_ambient_object = {
						limit = { has_ambient_object_flag = dreadnought_debris }
						destroy_ambient_object = this
					}
				}
			}
			break = yes
		}
		# Wormhole Dreadnought if owner has it
		if = {
			limit = {
				owner = { 
					OR = {
						has_technology = "tech_wormhole_generation_1"
						has_technology = "tech_wormhole_generation_2"
						has_technology = "tech_wormhole_generation_3"
					}
				}
			}
			create_fleet = {
				name = "NAME_Dreadnought"
				effect = {
					set_owner = event_target:project_owner
					create_ship = {
						name = random
						design = "NAME_Type_69" # Wormhole Dreadnought
						graphical_culture = "npf_01"
						upgradable = no
					}
					set_location = {
						target = event_target:disabled_dreadnought_object
						distance = 0
						angle = random
					}
				}
			}
			hidden_effect = {
				event_target:disabled_dreadnought_object = { destroy_ambient_object = this }
				solar_system = {
					random_system_ambient_object = {
						limit = { has_ambient_object_flag = dreadnought_debris }
						destroy_ambient_object = this
					}
				}
			}
			break = yes
		}
	}
}