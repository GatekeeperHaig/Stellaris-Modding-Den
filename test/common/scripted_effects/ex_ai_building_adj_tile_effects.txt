calculate_adjcancy_weights = { #this runs on tile scope, and it saves the variables into each tile's scope.
	if = { 
		limit = { any_neighboring_tile = { has_building = yes } } 
		check_neighboring_adj_bonus_buildings = yes 
		if = { 
			limit = { planets_enhanced_enabled = yes } 
			check_planets_enhanced_sr_buildings = yes 
		}		
		if = {
			limit = { alpha_mod_enabled = yes }
			check_neighboring_adj_bonus_buildings_am = yes
		}				
	}		
	if = { 
		limit = { any_neighboring_tile = { has_blocker = yes } } 
		check_adj_bonus_blockers = yes
		if = {
			limit = { alpha_mod_enabled = yes }
			check_adj_bonus_blockers_am = yes
		}
		if = {
			limit = { guillis_planet_modifiers_enabled = yes }
			check_adj_bonus_blockers_gpm = yes
		}	
	}		
}		

check_neighboring_adj_bonus_buildings = {
	if = {
		limit = { any_neighboring_tile = { has_capital_building = yes } }
		if = { 
			limit = { any_neighboring_tile = { has_capital_1 = yes } }
			change_variable = { which = energy_weight value = 1 }
			change_variable = { which = minerals_weight value = 1 }				
			change_variable = { which = unity_weight value = 1 }
			change_variable = { which = society_research_weight value = 1 }
			change_variable = { which = physics_research_weight value = 1 }
			change_variable = { which = engineering_research_weight value = 1 }
			break = yes
		}		
		if = { 
			limit = { any_neighboring_tile = { has_capital_2 = yes } }
			change_variable = { which = energy_weight value = 4 }
			change_variable = { which = minerals_weight value = 4 }				
			change_variable = { which = unity_weight value = 4 }
			change_variable = { which = society_research_weight value = 4 }
			change_variable = { which = physics_research_weight value = 4 }
			change_variable = { which = engineering_research_weight value = 4 }
			break = yes
		}			
		if = { 
			limit = { any_neighboring_tile = { has_capital_3 = yes } }
			change_variable = { which = energy_weight value = 9 }
			change_variable = { which = minerals_weight value = 9 }				
			change_variable = { which = unity_weight value = 9 }
			change_variable = { which = society_research_weight value = 9 }
			change_variable = { which = physics_research_weight value = 9 }
			change_variable = { which = engineering_research_weight value = 9 } 
			break = yes
		}	
	}	
	if = { 
		limit = { any_neighboring_tile = { has_hyperstorage_building = yes } } 
		if = { 
			limit = { any_neighboring_tile = { has_building = building_mineral_silo_1 } }
			change_variable = { which = energy_weight value = 1 }
			change_variable = { which = minerals_weight value = 1 }				
			change_variable = { which = food_weight value = 1 }
			break = yes
		}
		if = { 
			limit = { any_neighboring_tile = { has_building = building_mineral_silo_2 } }
			change_variable = { which = energy_weight value = 4 }
			change_variable = { which = minerals_weight value = 4 }				
			change_variable = { which = food_weight value = 4 }
			break = yes
		}	
		if = { 
			limit = { any_neighboring_tile = { has_building = building_mineral_silo_3 } }
			change_variable = { which = energy_weight value = 4 }
			change_variable = { which = minerals_weight value = 4 }				
			change_variable = { which = food_weight value = 4 }
			break = yes			
		}	
	}
	if = { 
		limit = { any_neighboring_tile = { has_polytechnic_building = yes } }
		change_variable = { which = society_research_weight value = 1 }
		change_variable = { which = physics_research_weight value = 1 }
		change_variable = { which = engineering_research_weight value = 1 }
		break = yes			
	}	
}			

check_adj_bonus_blockers = {
	every_neighboring_tile = {
		limit = {
			has_blocker = tb_wandering_forest_reserve
		}
		prev = {
			change_variable = { which = society_research_weight value = 9 }
		}	
	}		
	every_neighboring_tile = {
		limit = {
			has_blocker = tb_tribal_settlement
		}
		prev = {
			change_variable = { which = society_research_weight value = 1 }
		}	
	}			
}		