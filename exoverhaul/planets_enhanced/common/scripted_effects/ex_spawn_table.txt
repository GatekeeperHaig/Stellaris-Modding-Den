#### ExOverhaul Spawn Engine Effects, coded by ExNihil

roll_planetary_resource_loop = {
	if = { 
		limit = { NOT = { has_planet_flag = spawn_loop_terminus } } 
		if = {
			limit = { check_variable = { which = "sr_count" value = 0 } }
			planetary_resource_spawn = yes
		}	
		if = {
			limit = { check_variable = { which = "sr_count" value = 1 } }
			random_list = { 75 = { planetary_resource_spawn = yes } 25 = { set_planet_flag = spawn_loop_terminus } }
		}
		if = {
			limit = { check_variable = { which = "sr_count" value = 2 } }
			random_list = { 50 = { planetary_resource_spawn = yes } 50 = { set_planet_flag = spawn_loop_terminus } }
		}			
		if = {
			limit = { check_variable = { which = "sr_count" value = 3 } }
			random_list = { 25 = { planetary_resource_spawn = yes } 75 = { set_planet_flag = spawn_loop_terminus } }
		}			
		if = {
			limit = { check_variable = { which = "sr_count" value > 3 } }
			set_planet_flag = spawn_loop_terminus
			break = yes
		}	
		else = { break = yes } 
	}
}			


orbital_resource_spawn = { 
 #Orbital Resources
	 #- set disbale_spawn = no to enable a resource, change to yes to disable	
	 #- set for each resource conditions like they are set below. No conditions for it to roll on all planets.
	 #- the conditions themselves need to be defined in a file stored under /common/scripted_triggers
	 #- place the strategic resource under set_deposit. The deposit itself needs to be defined under deposits, with a weight of 0 {see ex files for example) 	
	 #- add a random list modifier field for each factor that should increase or decrease occurance - use fractions to decrease.
	if = {
		limit = { 
			disable_spawn = no 			
			orbital_sr_conditions = yes
			is_asteroid = yes #this limits it to a single planet class	
		}		
		random_list = {
			1 = {
				orbital_deposit_tile = { add_deposit = d_sr_ex_1_deposit }	
				modifier = { factor = 2 is_inside_nebula = yes } 
			}
			99 = {}
		}	
	}
	if = {
		limit = { 
			disable_spawn = no 			
			orbital_sr_conditions = yes	
			is_barren = yes			
		}		
		random_list = {
			2 = {
				orbital_deposit_tile = { add_deposit = d_sr_ex_2_deposit }	
				modifier = { factor = 2 is_inside_nebula = yes } 
			}
			98 = {}
		}	
	}
	if = {
		limit = { 
			disable_spawn = no 			
			orbital_sr_conditions = yes						
			is_toxic = yes
		}		
		random_list = {
			1 = {
				orbital_deposit_tile = { add_deposit = d_sr_ex_3_deposit }	
				modifier = { factor = 2 is_inside_nebula = yes } 
			}
			98 = {}
		}	
	}
	if = {
		limit = { 
			disable_spawn = no 			
			orbital_sr_conditions = yes	
			is_collapsed_star = yes	
		}		
		random_list = {
			3 = {
				orbital_deposit_tile = { add_deposit = d_sr_ex_4_deposit }	
				modifier = { factor = 2 is_inside_nebula = yes } 
			}
			97 = {}
		}	
	}
	if = {
		limit = { 
			disable_spawn = no 			
			orbital_sr_conditions = yes						
			is_frozen = yes
		}		
		random_list = {
			2 = {
				orbital_deposit_tile = { add_deposit = d_sr_ex_5_deposit }					
				modifier = { factor = 2 is_inside_nebula = yes } 
			}
			98 = {}
		}	
	}
	if = {
		limit = { 
			disable_spawn = no 			
			orbital_sr_conditions = yes						
			OR = {
				is_toxic = yes
				is_gas_giant = yes
			}			
		}		
		random_list = {
			2 = {
				orbital_deposit_tile = { add_deposit = d_sr_ex_6_deposit }
				modifier = { factor = 2 is_inside_nebula = yes } 
			}
			98 = {}
		}	
	}
	if = {
		limit = { 
			disable_spawn = no 			
			orbital_sr_conditions = yes						
			is_asteroid = yes				
		}		
		random_list = {
			4 = {
				orbital_deposit_tile = { add_deposit = d_sr_ex_7_deposit }	
				modifier = { factor = 2 is_inside_nebula = yes } 
			}
			96 = {}
		}	
	}
	if = {
		limit = { 
			disable_spawn = no 			
			orbital_sr_conditions = yes						
			is_barren_cold = yes
		}		
		random_list = {
			1 = {
				orbital_deposit_tile = { add_deposit = d_sr_ex_8_deposit }
				modifier = { factor = 2 is_inside_nebula = yes } 
			}
			99 = {}
		}	
	}
	if = {
		limit = { 
			disable_spawn = no 			
			orbital_sr_conditions = yes						
			is_frozen = yes				
		}		
		random_list = {
			1 = {
				orbital_deposit_tile = { add_deposit = d_sr_ex_9_deposit }
				modifier = { factor = 2 is_inside_nebula = yes } 
			}
			99 = {}
		}	
	}
	if = {
		limit = { 
			disable_spawn = no 			
			orbital_sr_conditions = yes						
			OR = {
				is_gas_giant = yes
				is_collapsed_star = yes
			}
		}		
		random_list = {
			1.75 = {
				orbital_deposit_tile = { add_deposit = d_sr_ex_10_deposit }
				modifier = { factor = 2 is_inside_nebula = yes } 
			}
			98.25 = {}
		}	
	}	
}

planetary_resource_spawn = {
	
 #Planetary Resources
	 #- set disbale_spawn = no to enable a resource, change to yes to disable	
	 #- set for each resource conditions like they are set below. No conditions for it to roll on all planets.
	 #- the conditions themselves need to be defined in a file stored under /common/scripted_triggers
	 #- place the strategic resource under set_deposit. The deposit itself needs to be defined under deposits, with a weight of 0 {see ex files for example) 	
	 #- add a random list modifier field for each factor that should increase or decrease occurance - use fractions to decrease.
	if = {
		limit = { 
			disable_spawn = no 			
			planetary_sr_conditions = yes						
		}		
		random_list = {
			2 = {				
				random_tile = { limit = { is_free_planetary_tile = yes }			 
					set_deposit = d_sr_ex_planetary_1_deposit					
				}
				change_variable = { which = "sr_count" value = 1 }				
				modifier = { factor = 2 is_dry_planet_class = yes }
				modifier = { factor = 2 is_planet_class = pc_gaia }				
			}
			98 = {}
		}	
	}
	
	
	if = {
		limit = { 
			disable_spawn = no 			
			planetary_sr_conditions = yes						
		}		
		random_list = {
			2 = { 
				random_tile = { limit = { is_free_planetary_tile = yes }			
					set_deposit = d_sr_ex_planetary_2_deposit						
				}	
				change_variable = { which = "sr_count" value = 1 }
				modifier = { factor = 2 is_wet_planet_class = yes }
				modifier = { factor = 2 is_planet_class = pc_gaia }				
			}
			98 = {}
		}	
	}			
	if = {
		limit = { 
			disable_spawn = no 			
			planetary_sr_conditions = yes						
		}		
		random_list = {
			2 = { 
				random_tile = { limit = { is_free_planetary_tile = yes }			
					set_deposit = d_sr_ex_planetary_3_deposit						
				}	
				change_variable = { which = "sr_count" value = 1 }
				modifier = { factor = 2 has_planet_flag = planet_group_7 }
				modifier = { factor = 2 is_planet_class = pc_gaia }				 
			}
			98 = {}
		}	
	}		
	if = {
		limit = { 
			disable_spawn = no 			
			planetary_sr_conditions = yes						
		}		
		random_list = {
			2 = { 
				random_tile = { limit = { is_free_planetary_tile = yes }			
					set_deposit = d_sr_ex_planetary_4_deposit
				}	
				change_variable = { which = "sr_count" value = 1 }
				modifier = { factor = 2 is_dry_planet_class = yes }
				modifier = { factor = 2 is_planet_class = pc_gaia }				 
			}
			98 = {}
		}	
	}	
	if = {
		limit = { 
			disable_spawn = no 			
			planetary_sr_conditions = yes						
		}		
		random_list = {
			2 = { 
				random_tile = { limit = { is_free_planetary_tile = yes }			
					set_deposit = d_sr_ex_planetary_5_deposit 						
				}	
				change_variable = { which = "sr_count" value = 1 }
				modifier = { factor = 2 is_wet_planet_class = yes }
				modifier = { factor = 2 is_planet_class = pc_gaia }				 
			}
			98 = {}
		}	
	}		
	if = {
		limit = { 
			disable_spawn = no 			
			planetary_sr_conditions = yes						
		}		
		random_list = {
			2 = { 
				random_tile = { limit = { is_free_planetary_tile = yes }			
					set_deposit = d_sr_ex_engos_deposit 						
				}	
				change_variable = { which = "sr_count" value = 1 }
				modifier = { factor = 2 is_dry_planet_class = yes }
				modifier = { factor = 2 is_planet_class = pc_gaia }				 
			}
			98 = {}
		}	
	}		
	if = {
		limit = { 
			disable_spawn = no 			
			planetary_sr_conditions = yes						
		}		
		random_list = {
			2 = { 
				random_tile = { limit = { is_free_planetary_tile = yes }			
					set_deposit = d_sr_ex_pitharan_deposit						
				}	
				change_variable = { which = "sr_count" value = 1 }
				modifier = { factor = 2 is_wet_planet_class = yes }
				modifier = { factor = 2 is_planet_class = pc_gaia }				 
			}
			98 = {}
		}	
	}	
	if = {
		limit = { 
			disable_spawn = no 			
			planetary_sr_conditions = yes						
		}		
		random_list = {
			2 = { 
				random_tile = { limit = { is_free_planetary_tile = yes }			
					set_deposit = d_sr_ex_satramene_deposit						
				}	
				change_variable = { which = "sr_count" value = 1 }
				modifier = { factor = 2 has_planet_flag = planet_group_7 }
				modifier = { factor = 2 is_planet_class = pc_gaia }				 
			}
			98 = {}
		}	
	}	
	if = {
		limit = { 
			disable_spawn = no 			
			planetary_sr_conditions = yes						
		}		
		random_list = {
			2 = { 
				random_tile = { limit = { is_free_planetary_tile = yes }			
					set_deposit = d_sr_ex_satramene_deposit						
				}	
				change_variable = { which = "sr_count" value = 1 }
				modifier = { factor = 2 has_planet_flag = planet_group_7 }
				modifier = { factor = 2 is_planet_class = pc_gaia }				 
			}
			98 = {}
		}	
	}	
	if = {
		limit = { 
			disable_spawn = no 			
			planetary_sr_conditions = yes						
		}		
		random_list = {
			2 = { 
				random_tile = { limit = { is_free_planetary_tile = yes }			
					set_deposit = d_archeological_remains_deposit					
				}	
				change_variable = { which = "sr_count" value = 1 }
				modifier = { factor = 10 is_planet_class = pc_nuked }
				modifier = { factor = 2 is_planet_class = pc_gaia }				 
			}
			98 = {}
		}	
	}
	roll_planetary_resource_loop = yes # this makes sure there are multiple rolls for each planet. 	
}

unique_planetary_resource_spawn = {
	if = {
		limit = { 
			disable_spawn = no 			
			is_colony = no		
			NOT = { has_global_flag = sr_ex_unique_1 }
		}		
		random_tile = { 				
			if = { limit = { has_building = yes } remove_building = yes }
			if = { limit = { has_blocker = yes } remove_blocker = yes }
			if = { limit = { has_deposit = yes } clear_deposits = yes }
			add_deposit = d_sr_ex_unique_1_deposit									
		}		
		change_variable = { which = "sr_count" value = 1 }	
		set_global_flag = sr_ex_unique_1
		break = yes
	}			
	if = {
		limit = { 
			disable_spawn = no 			
			is_colony = no				
			NOT = { has_global_flag = sr_ex_unique_2 }
		}		
		random_tile = { 				
			if = { limit = { has_building = yes } remove_building = yes }
			if = { limit = { has_blocker = yes } remove_blocker = yes }
			if = { limit = { has_deposit = yes } clear_deposits = yes }
			add_deposit = d_sr_ex_unique_2_deposit
		}		
		change_variable = { which = "sr_count" value = 1 }	
		set_global_flag = sr_ex_unique_2
		break = yes
	}			
	if = {
		limit = { 
			disable_spawn = no 			
			is_colony = no		
			NOT = { has_global_flag = sr_ex_unique_3 }
		}		
		random_tile = { 				
			if = { limit = { has_building = yes } remove_building = yes }
			if = { limit = { has_blocker = yes } remove_blocker = yes }
			if = { limit = { has_deposit = yes } clear_deposits = yes }
			add_deposit = d_sr_ex_unique_3_deposit				
		}		
		change_variable = { which = "sr_count" value = 1 }	
		set_global_flag = sr_ex_unique_3
		break = yes
	}		
	if = {
		limit = { 
			disable_spawn = no 			
			is_colony = no		
			NOT = { has_global_flag = sr_ex_unique_4 }
		}		
		random_tile = { 				
			if = { limit = { has_building = yes } remove_building = yes }
			if = { limit = { has_blocker = yes } remove_blocker = yes }
			if = { limit = { has_deposit = yes } clear_deposits = yes }
			add_deposit = d_sr_ex_unique_4_deposit				
		}		
		change_variable = { which = "sr_count" value = 1 }	
		set_global_flag = sr_ex_unique_4
		break = yes			
	}		
	if = {
		limit = { 
			disable_spawn = no 			
			is_colony = no		
			NOT = { has_global_flag = sr_ex_unique_5 }
		}		
		random_tile = { 				
			if = { limit = { has_building = yes } remove_building = yes }
			if = { limit = { has_blocker = yes } remove_blocker = yes }
			if = { limit = { has_deposit = yes } clear_deposits = yes }			
			set_deposit = d_sr_ex_unique_5_deposit	
		}		
		change_variable = { which = "sr_count" value = 1 }	
		set_global_flag = sr_ex_unique_5
		break = yes			
	}	
	if = {
		limit = { 
			disable_spawn = no 			
			is_colony = no		
			NOT = { has_global_flag = sr_ex_unique_6 }
		}		
		random_tile = { 				
			if = { limit = { has_building = yes } remove_building = yes }
			if = { limit = { has_blocker = yes } remove_blocker = yes }
			if = { limit = { has_deposit = yes } clear_deposits = yes }			
			set_deposit = d_sr_ex_unique_6_deposit		
		}		
		change_variable = { which = "sr_count" value = 1 }	
		set_global_flag = sr_ex_unique_6
		break = yes			
	}		
}	

modifier_spawn_table = {
	if = {
		limit = { 
			is_planet_class = pc_nuked
			NOR = {
				has_modifier = ex_tw
				has_modifier = ex_necropolis
			}				
		}		
		random_list = {
			25 = { add_modifier = { modifier = "ex_tw" days = -1 } }
			25 = { add_modifier = { modifier = "ex_necropolis" days = -1 } }
			25 = { add_modifier = { modifier = "ex_necropolis" days = -1 } add_modifier = { modifier = "ex_tw" days = -1 } }
			25 = { } 
		}	
	}
	if = {
		limit = { 
			is_planet_class = pc_gaia
			NOT = {	has_modifier = ex_gaia_world }
		}		
		add_modifier = { modifier = "ex_gaia_world" days = -1 }
	}
	if = {
		limit = { 
			is_planet_class = pc_ringworld_habitable
			NOT = {	has_modifier = ex_ring_world }
		}		
		add_modifier = { modifier = "ex_ring_world" days = -1 }
	}		
}	