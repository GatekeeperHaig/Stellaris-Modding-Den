# scope = planet
gpm_set_shipyards_objects = {
    if = {
        limit = {
            NOT = { has_global_flag = "has_real_space_mod" } 
        }
        if = {
            limit = {
                has_modifier = Precursor_Shipyards
                gpm_is_planet_ALL = yes
                NOT = { has_planet_flag = gpm_precursor_shipyards_ambient }
            }
            save_event_target_as = gpm_orbit_shipyards
			
            if = {
                limit = {
                    planet_size > 20
                }
                create_ambient_object = {
                    type = gpm_shipyards_object_large
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_orbit_shipyards
                    }
                    set_ambient_object_flag = gpm_precursor_shipyard_flag
                }
            }
            
            if = {
                limit = {
                    AND = {
                        planet_size < 21
                        planet_size > 14
                    }
                }
                create_ambient_object = {
                    type = gpm_shipyards_object_medium
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_orbit_shipyards
                    }
                    set_ambient_object_flag = gpm_precursor_shipyard_flag
                }
            }
            
            if = {
                limit = {
                    planet_size < 15
                }
                create_ambient_object = {
                    type = gpm_shipyards_object_small
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_orbit_shipyards
                    }
                    set_ambient_object_flag = gpm_precursor_shipyard_flag
                }
            }
                                
            set_planet_flag = gpm_precursor_shipyards_ambient
        }
    }
    if = {
        limit = { 
            has_global_flag = "has_real_space_mod"
        }
        if = {
            limit = {
                has_modifier = Precursor_Shipyards
                gpm_is_planet_ALL = yes
                NOT = { has_planet_flag = gpm_precursor_shipyards_ambient }
            }
            save_event_target_as = gpm_orbit_shipyards
		
            if = {
                limit = {
                    planet_size > 20
                }
                create_ambient_object = {
                    type = gpm_shipyards_RS_object_large
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_orbit_shipyards
                    }
                    set_ambient_object_flag = gpm_precursor_shipyard_flag
                }
            }
            
            if = {
                limit = {
                    AND = {
                        planet_size < 21
                        planet_size > 14
                    }
                }
                create_ambient_object = {
                    type = gpm_shipyards_RS_object_medium
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_orbit_shipyards
                    }
                    set_ambient_object_flag = gpm_precursor_shipyard_flag
                }
            }
            
            if = {
                limit = {
                    planet_size < 15
                }
                create_ambient_object = {
                    type = gpm_shipyards_RS_object_small
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_orbit_shipyards
                    }
                    set_ambient_object_flag = gpm_precursor_shipyard_flag
                }
            }
                                
            set_planet_flag = gpm_precursor_shipyards_ambient
        }
    }
}
# scope = planet
gpm_set_precursor_planetary_shields = {
    if = {
        limit = { 
            NOT = { has_global_flag = "has_real_space_mod" } 
        }
        if = {
            limit = {
                has_modifier = Precursor_Planetary_Shield
                gpm_is_planet_ALL = yes
                NOT = { has_planet_flag = gpm_precursor_shield_ambient }
            }
            save_event_target_as = gpm_precursor_shield_location
			
            if = {
                limit = {
                    planet_size > 24
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_25
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 24
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_24
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 23
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_23
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 22
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_22
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 21
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_21
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 20
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_20
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 19
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_19
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 18
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_18
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 17
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_17
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 16
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_16
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 15
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_15
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 14
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_14
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 13
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_13
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 12
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_12
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 11
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_11
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 10
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_10
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 9
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_09
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 8
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_08
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size < 8
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_07
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            set_planet_flag = gpm_precursor_shield_ambient
        }
    }
    if = {
        limit = { 
            has_global_flag = "has_real_space_mod"
        }
        if = {
            limit = {
                has_modifier = Precursor_Planetary_Shield
                gpm_is_planet_ALL = yes
                NOT = { has_planet_flag = gpm_precursor_shipyards_ambient }
            }
            save_event_target_as = gpm_precursor_shield_location
		
            if = {
                limit = {
                    planet_size > 24
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_RS_25
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 24
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_RS_24
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 23
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_RS_23
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 22
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_RS_22
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 21
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_RS_21
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 20
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_RS_20
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 19
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_RS_19
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 18
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_RS_18
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 17
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_RS_17
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 16
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_RS_16
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 15
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_RS_15
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 14
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_RS_14
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 13
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_RS_13
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 12
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_RS_12
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 11
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_RS_11
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 10
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_RS_10
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 9
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_RS_09
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 8
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_RS_08
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size < 8
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_RS_07
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_precursor_shield_location
                    }
                    set_ambient_object_flag = gpm_precursor_shield_flag
                }
            }
            set_planet_flag = gpm_precursor_shield_ambient
        }
    }
}
# scope = planet
gpm_set_fallen_empire_planetary_shields = {
    if = {
        limit = { 
            NOT = { has_global_flag = "has_real_space_mod" } 
        }
        if = {
            limit = {
                has_modifier = Planetary_Shielding_FE
                gpm_is_planet_ALL = yes
                NOT = { has_planet_flag = gpm_fallen_empire_shield_ambient }
            }
            save_event_target_as = gpm_FE_shield_location
		
            if = {
                limit = {
                    planet_size > 24
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_25
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 24
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_24
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 23
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_23
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 22
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_22
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 21
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_21
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 20
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_20
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 19
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_19
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 18
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_18
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 17
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_17
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 16
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_16
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 15
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_15
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 14
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_14
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 13
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_13
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 12
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_12
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 11
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_11
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 10
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_10
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 9
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_09
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 8
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_08
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size < 8
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_07
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            set_planet_flag = gpm_fallen_empire_shield_ambient
        }
    }
    if = {
        limit = { 
            has_global_flag = "has_real_space_mod"
        }
        if = {
            limit = {
                has_modifier = Planetary_Shielding_FE
                gpm_is_planet_ALL = yes
                NOT = { has_planet_flag = gpm_fallen_empire_shield_ambient }
            }
            save_event_target_as = gpm_FE_shield_location
		
            if = {
                limit = {
                    planet_size > 24
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_RS_25
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 24
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_RS_24
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 23
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_RS_23
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 22
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_RS_22
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 21
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_RS_21
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 20
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_RS_20
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 19
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_RS_19
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 18
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_RS_18
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 17
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_RS_17
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 16
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_RS_16
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 15
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_RS_15
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 14
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_RS_14
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 13
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_RS_13
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 12
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_RS_12
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 11
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_RS_11
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 10
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_RS_10
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 9
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_RS_09
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size = 8
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_RS_08
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            
            if = {
                limit = {
                    planet_size < 8
                }
                create_ambient_object = {
                    type = gpm_planetary_shield_FE_RS_07
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = event_target:gpm_FE_shield_location
                    }
                    set_ambient_object_flag = gpm_fallen_empire_shield_flag
                }
            }
            set_planet_flag = gpm_fallen_empire_shield_ambient
        }
    }
}

gpm_set_precursor_energy_grid = {
    if = {
		limit = { is_planet_class = pc_continental }
		set_planet_entity = { entity = "gpm_continental_planet_energy_grid_entity" }
	}
	if = {
		limit = { is_planet_class = pc_gaia }
		set_planet_entity = { entity = "gpm_gaia_planet_energy_grid_entity" }
	}
	if = {
		limit = { is_planet_class = pc_arctic }
		set_planet_entity = { entity = "gpm_arctic_planet_energy_grid_entity" }
	}
	if = {
		limit = { is_planet_class = pc_alpine }
		set_planet_entity = { entity = "gpm_alpine_planet_energy_grid_entity" }
	}
	if = {
		limit = { is_planet_class = pc_savannah }
		set_planet_entity = { entity = "gpm_savannah_planet_energy_grid_entity" }
	}
	if = {
		limit = { is_planet_class = pc_arid }
		set_planet_entity = { entity = "gpm_arid_planet_energy_grid_entity" }
	}
	if = {
		limit = { is_planet_class = pc_barren }
		set_planet_entity = { entity = "gpm_barren_planet_energy_grid_entity" }
	}
	if = {
		limit = { is_planet_class = pc_barren_cold }
		set_planet_entity = { entity = "gpm_cold_barren_planet_energy_grid_entity" }
	}
	if = {
		limit = { is_planet_class = pc_desert }
		set_planet_entity = { entity = "gpm_desert_planet_energy_grid_entity" }
	}
	if = {
		limit = { is_planet_class = pc_frozen }
		set_planet_entity = { entity = "gpm_frozen_planet_energy_grid_entity" }
	}
	if = {
		limit = { is_planet_class = pc_molten }
		set_planet_entity = { entity = "gpm_molten_planet_energy_grid_entity" }
	}
	if = {
		limit = { is_planet_class = pc_ocean }
		set_planet_entity = { entity = "gpm_ocean_planet_energy_grid_entity" }
	}
	if = {
		limit = { is_planet_class = pc_toxic }
		set_planet_entity = { entity = "gpm_toxic_planet_energy_grid_entity" }
	}
	if = {
		limit = { is_planet_class = pc_tropical }
		set_planet_entity = { entity = "gpm_tropical_planet_energy_grid_entity" }
	}
	if = {
		limit = { is_planet_class = pc_tundra }
		set_planet_entity = { entity = "gpm_tundra_planet_energy_grid_entity" }
	}
	if = {
		limit = { is_planet_class = pc_nuked }
		set_planet_entity = { entity = "gpm_nuked_planet_energy_grid_entity" }
	}
}

# Duplicate asteroid 
# scope = planet
gpm_set_binary_asteroid = {
	save_event_target_as = gpm_double_asteroid
	solar_system = {
		spawn_planet = {
			class = "pc_asteroid"
			location = event_target:gpm_double_asteroid
			orbit_location = no
			orbit_angle_offset = 5
			orbit_distance_offset = -4.0
			size = 20
			has_ring = no
			
			init_effect = {
				set_name = gpm_binary_asteroids
				set_planet_entity = {
					entity = "asteroid_entity"
				}
				surveyed = {
					set_surveyed = no
				}
				reroll_planet = yes
				set_planet_flag = gpm_binary_asteroid
				if = {
					limit= { NOT = { has_modifier = Binary_Asteroids } }
					add_modifier = { modifier = Binary_Asteroids days = -1 }
				}
			}
		}
	}
}

# Duplicate pulsar 
# scope = planet
gpm_set_binary_pulsar = {
	save_event_target_as = gpm_double_pulsar
	solar_system = {
		spawn_planet = {
			class = "pc_pulsar"
			location = event_target:gpm_double_pulsar
			orbit_location = yes
			orbit_angle = { min = 0 max = 360 }
			orbit_distance_offset = 30.0
			size = 25
			has_ring = no
			
			init_effect = {
				set_name = gpm_binary_pulsars
				set_planet_entity = {
					entity = "pulsar_entity"
				}
				surveyed = {
					set_surveyed = no
				}
				set_planet_flag = gpm_binary_pulsar
				if = {
					limit= { NOT = { has_modifier = Resonant_Twins } }
					add_modifier = { modifier = Resonant_Twins days = -1 }
				}
			}
		}
	}
}
