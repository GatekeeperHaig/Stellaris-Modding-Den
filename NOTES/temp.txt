planet_event = { # this event runs on every tick (day), checking and adding/removing planet flags/modifiers as necessary. 
	id = ex_spaceport_events.10
	hide_window = yes
	
	trigger = { 
		NOT = { has_planet_flag = level_check_delay }
		has_spaceport = yes
		has_free_module_slot = yes		
	}
	
	immediate = {
		if = {
			limit = { is_spaceport_module_slot_free = 9	}
			if = { 
				limit = { 
					NOT = { has_planet_flag = ex_spaceport_9 }
				}
				set_planet_flag = ex_spaceport_9
				update_spaceport_modifiers = yes				
			}			
			if = { limit = { NOT = { has_planet_flag = slot_9_free } } set_planet_flag = slot_9_free }
		}	
		if = {
			limit = { is_spaceport_module_slot_free = 8	}
			if = { 
				limit = { 
					NOR = { 
						has_planet_flag = ex_spaceport_8 
						has_planet_flag = ex_spaceport_9
					}
				}
				set_planet_flag = ex_spaceport_8
				update_spaceport_modifiers = yes				
			}			
			if = { limit = { NOT = { has_planet_flag = slot_8_free } } set_planet_flag = slot_8_free }
		}	
		if = {
			limit = { is_spaceport_module_slot_free = 7	}
			if = { 
				limit = { 
					NOR = { 
						has_planet_flag = ex_spaceport_7 
						has_planet_flag = ex_spaceport_8 
						has_planet_flag = ex_spaceport_9
					}
				}
				set_planet_flag = ex_spaceport_7
				update_spaceport_modifiers = yes				
			}			
			if = { limit = { NOT = { has_planet_flag = slot_7_free } } set_planet_flag = slot_7_free }
		}		
		if = {
			limit = { is_spaceport_module_slot_free = 6	}
			if = { 
				limit = { 
					NOR = { 
						has_planet_flag = ex_spaceport_6 
						has_planet_flag = ex_spaceport_7 
						has_planet_flag = ex_spaceport_8 
						has_planet_flag = ex_spaceport_9
					}
				}
				set_planet_flag = ex_spaceport_6
				update_spaceport_modifiers = yes	
			}			
			if = { limit = { NOT = { has_planet_flag = slot_7_free } } set_planet_flag = slot_6_free }
		}	
		if = {
			limit = { is_spaceport_module_slot_free = 5	}
			if = { 
				limit = { 
					NOR = { 
						has_planet_flag = ex_spaceport_5 
						has_planet_flag = ex_spaceport_6 
						has_planet_flag = ex_spaceport_7 
						has_planet_flag = ex_spaceport_8 
						has_planet_flag = ex_spaceport_9
					}
				}
				set_planet_flag = ex_spaceport_5	
			}			
			if = { limit = { NOT = { has_planet_flag = slot_5_free } } set_planet_flag = slot_5_free }
		}	
		if = {
			limit = { is_spaceport_module_slot_free = 4	}
			if = { 
				limit = { 
					NOR = { 
						has_planet_flag = ex_spaceport_4
						has_planet_flag = ex_spaceport_5 
						has_planet_flag = ex_spaceport_6 
						has_planet_flag = ex_spaceport_7 
						has_planet_flag = ex_spaceport_8 
						has_planet_flag = ex_spaceport_9
					}
				}
				set_planet_flag = ex_spaceport_4
				update_spaceport_modifiers = yes				
			}			
			if = { limit = { NOT = { has_planet_flag = slot_4_free } } set_planet_flag = slot_4_free }
		}	
		if = {
			limit = { is_spaceport_module_slot_free = 3	}
			if = { 
				limit = { 
					NOR = { 
						has_planet_flag = ex_spaceport_3
						has_planet_flag = ex_spaceport_4
						has_planet_flag = ex_spaceport_5 
						has_planet_flag = ex_spaceport_6 
						has_planet_flag = ex_spaceport_7 
						has_planet_flag = ex_spaceport_8 
						has_planet_flag = ex_spaceport_9
					}
				}
				set_planet_flag = ex_spaceport_3	
				update_spaceport_modifiers = yes
			}			
			if = { limit = { NOT = { has_planet_flag = slot_3_free } } set_planet_flag = slot_3_free }
		}	
		if = {
			limit = { is_spaceport_module_slot_free = 2	}
			if = { 
				limit = { 
					NOR = { 
						has_planet_flag = ex_spaceport_2
						has_planet_flag = ex_spaceport_3
						has_planet_flag = ex_spaceport_4
						has_planet_flag = ex_spaceport_5 
						has_planet_flag = ex_spaceport_6 
						has_planet_flag = ex_spaceport_7 
						has_planet_flag = ex_spaceport_8 
						has_planet_flag = ex_spaceport_9
					}
				}
				set_planet_flag = ex_spaceport_2
				update_spaceport_modifiers = yes				
			}			
			if = { limit = { NOT = { has_planet_flag = slot_2_free } } set_planet_flag = slot_2_free }
		}
		if = {
			limit = { is_spaceport_module_slot_free = 1	}
			if = { 
				limit = { 
					NOR = { 
						has_planet_flag = ex_spaceport_1
						has_planet_flag = ex_spaceport_2
						has_planet_flag = ex_spaceport_3
						has_planet_flag = ex_spaceport_4
						has_planet_flag = ex_spaceport_5 
						has_planet_flag = ex_spaceport_6 
						has_planet_flag = ex_spaceport_7 
						has_planet_flag = ex_spaceport_8 
						has_planet_flag = ex_spaceport_9
					}
				}
				set_planet_flag = ex_spaceport_1	
				update_spaceport_modifiers = yes
			}			
			if = { 
				limit = { 
					NOT = { has_policy_flag = spaceport_automation_disabled }					
					OR = {
						AND = {
							sector_controlled = no
							owner = { has_policy_flag = full_automation } 
						}
						sector_controlled = yes
					}	
				}
				set_base_weapon = yes
			}
			else = { set_planet_flag = slot_1_free }
		}			
		set_timed_planet_flag = { flag = level_check_delay days = 180 }
	}
}	