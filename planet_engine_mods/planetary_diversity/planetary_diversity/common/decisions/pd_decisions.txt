##########################################################################
# Decisions
##########################################################################

# Adapted Environment
decision_engineered_environment = {
	icon = decision_engineered_environment
	owned_planets_only = yes
	
	prerequisites = {
		"tech_terrestrial_sculpting"		
	}

	enactment_time = 1800
	resources = {
		category = decisions
		cost = {
			influence = 50
			energy = 2500
		}
	}
	
	potential = {
		habitable_structure = no
		NOT = { is_planet_class = pc_pdshroud }
		NOT = { is_planet_class = pc_gaia }
		NOT = { is_planet_class = pc_city }
		NOT = { is_planet_class = pc_ecocity }
		NOT = { is_planet_class = pc_relic }
		NOT = { is_planet_class = pc_crystal }
		NOT = { is_planet_class = pc_graveyard }
		NOT = { is_planet_class = pc_floating }
		NOT = { is_planet_class = pc_archive }
		NOT = { is_planet_class = pc_technoorganic }
		NOT = { is_planet_class = pc_pd_gas_giant_hab }
		NOT = { is_planet_class = pc_pd_barren_hab }
		NOT = { is_planet_class = pc_pd_barren_cold_hab }
		NOT = { is_planet_class = pc_pd_frozen_hab }
		NOT = { is_planet_class = pc_pd_molten_hab }
		NOT = { is_planet_class = pc_pd_toxic_hab }
		NOT = { is_planet_class = pc_pd_hothouse_hab }
		NOT = { is_planet_class = pc_pd_asteroid_hab }
		NOT = { is_planet_class = pc_hive }
		NOT = { is_planet_class = pc_pdhive1 }
		NOT = { is_planet_class = pc_pdhive2 }
		NOT = { has_modifier = engineered_environment }
		NOT = { has_modifier = engineered_environment_gaia }
	}

	effect = {
		add_modifier = {
			modifier = engineered_environment
			days = -1
		}
		if = {
			limit = { has_modifier = bleak_planet }
			remove_modifier = bleak_planet
		}
		if = {
			limit = { has_modifier = high_gravity }
			remove_modifier = high_gravity
		}
		if = {
			limit = { has_modifier = irradiated_planet }
			remove_modifier = irradiated_planet
		}
		if = {
			limit = { has_modifier = mineral_poor }
			remove_modifier = mineral_poor
		}
		if = {
			limit = { has_modifier = unstable_tectonics }
			remove_modifier = unstable_tectonics
		}
		if = {
			limit = { has_modifier = weak_magnetic_field }
			remove_modifier = weak_magnetic_field
		}
		if = {
			limit = { has_modifier = exofungus }
			remove_modifier = exofungus
		}
	}    
	
	ai_weight = {
        weight = 3
        modifier = {
            factor = 0
            or = {
            		num_pops < 15
                and = {
                  # By late game, AI will likely keep some open building slots
                  # This is mostly harmless if there are still jobs available
                  # Otherwise, don't let them take this over building a building
                  free_building_slots > 0
                  free_jobs <= 0
                }
                free_building_slots > 2
                owner = {
                    or = {
                        resource_stockpile_compare = { resource = energy value < 6000 } 
                        resource_stockpile_compare = { resource = influence value < 150 }
                    }
                }
            }
        }
        modifier = {
        	# Will still be above 1
          factor = 0.5
          # We want to move along to perfect world shaping for its 10% jobs bonus if we have world shaper
          NOT = { owner = { has_ascension_perk = ap_world_shaper } }
          NOT = { any_owned_pop = {
            prev = {
              habitability = { who = prev value < 1.0 }
            }
          } }
        }
        modifier = {
          factor = 0
				  owner = {
            or = {
              has_civic = civic_barbaric_despoilers
              has_civic = civic_fanatic_purifiers
              has_origin = origin_post_apocalyptic
              has_civic = civic_hive_devouring_swarm			
            }
          }
        }
        modifier = {
          factor = 0
          owner = { is_machine_empire = yes }
        }
    }
}

# Adapted Environment Gaia
decision_engineered_environment_gaia = {
	icon = decision_engineered_environment_gaia
	owned_planets_only = yes

	enactment_time = 1800
	resources = {
		category = decisions
		cost = {
			influence = 50
			energy = 5000
		}
	}
	
	potential = {
		habitable_structure = no
		NOT = { is_planet_class = pc_pdshroud }
		NOT = { is_planet_class = pc_gaia }
		NOT = { is_planet_class = pc_city }
		NOT = { is_planet_class = pc_ecocity }
		NOT = { is_planet_class = pc_relic }
		NOT = { is_planet_class = pc_crystal }
		NOT = { is_planet_class = pc_graveyard }
		NOT = { is_planet_class = pc_floating }
		NOT = { is_planet_class = pc_archive }
		NOT = { is_planet_class = pc_technoorganic }
		NOT = { is_planet_class = pc_pd_gas_giant_hab }
		NOT = { is_planet_class = pc_pd_barren_hab }
		NOT = { is_planet_class = pc_pd_barren_cold_hab }
		NOT = { is_planet_class = pc_pd_frozen_hab }
		NOT = { is_planet_class = pc_pd_molten_hab }
		NOT = { is_planet_class = pc_pd_toxic_hab }
		NOT = { is_planet_class = pc_pd_hothouse_hab }
		NOT = { is_planet_class = pc_pd_asteroid_hab }
		NOT = { is_planet_class = pc_hive }
		NOT = { is_planet_class = pc_pdhive1 }
		NOT = { is_planet_class = pc_pdhive2 }
		has_modifier = engineered_environment
		owner = { has_ascension_perk = ap_world_shaper }
	}

	effect = {
		add_modifier = {
			modifier = engineered_environment_gaia
			days = -1
		}
		hidden_effect = {
			remove_modifier = engineered_environment
		}
	}   
	
	ai_weight = {
        weight = 3
        modifier = {
            factor = 0
            or = {
                num_pops < 20
                and = {
                  # By late game, AI will likely keep some open building slots
                  # This is mostly harmless if there are still jobs available
                  # Otherwise, don't let them take this over building a building
                  free_building_slots > 0
                  free_jobs <= 0
                }
                free_building_slots > 2
                owner = {
                    or = {
                        resource_stockpile_compare = { resource = energy value < 10000 }
                        resource_stockpile_compare = { resource = influence value < 150 }
                    }
                }
            }
        }
  }
}

# Any Planet to Radiotrophic
decision_radiotrophic = {
	icon = decision_radiotrophic
	owned_planets_only = yes

	enactment_time = 1800
	resources = {
		category = decisions
		cost = {
			energy = 2000
			sr_rad_bloom = 500
		}
	}
	
	potential = {
		habitable_structure = no
		owner = { 
			any_owned_planet = { is_planet_class = pc_irradiated }
		}
		NOT = { is_planet_class = pc_irradiated }
	}

	effect = {
		change_pc = pc_irradiated
		
		hidden_effect = {
			remove_modifier = radiotrophic
			add_modifier = {
				modifier = radiotrophic
				days = -1
			}
			add_deposit = d_rad_blooms
		}
	}
	
	ai_weight = {
		weight = 1
		modifier = {
			factor = 0
		}
	}
}

# Change Ocean Picture
decision_removeocean = {
	icon = decision_removeocean
	owned_planets_only = yes

	#enactment_time = 1800
	resources = {
		category = decisions
		cost = {
			influence = 25
		}
	}
	
	potential = {
		NOT = { is_planet_class = pc_relic }
		NOT = { owner = { has_trait = trait_pc_aquatic_preference } }
		NOT = { is_planet_class = pc_city }
		NOT = { is_planet_class = pc_pdshroud }
		NOT = { is_planet_class = pc_ecocity }
		NOT = { is_planet_class = pc_pd_gas_giant_hab }
		NOT = { is_planet_class = pc_pd_barren_hab }
		NOT = { is_planet_class = pc_pd_barren_cold_hab }
		NOT = { is_planet_class = pc_pd_frozen_hab }
		NOT = { is_planet_class = pc_pd_molten_hab }
		NOT = { is_planet_class = pc_pd_toxic_hab }
		NOT = { is_planet_class = pc_pd_hothouse_hab }
		NOT = { is_planet_class = pc_pd_asteroid_hab }
		has_planet_flag = pdaquapicture
	}

	effect = {
		custom_tooltip = decision_removeocean_tooltip
		hidden_effect = {
			remove_planet_flag = pdaquapicture
			IF = { limit = { is_planet_class = pc_ocean } set_planet_entity = { picture = pc_ocean } }
			IF = { limit = { is_planet_class = pc_continental } set_planet_entity = { picture = pc_continental } }
			IF = { limit = { is_planet_class = pc_tropical } set_planet_entity = { picture = pc_tropical } }
			IF = { limit = { is_planet_class = pc_cascadian } set_planet_entity = { picture = pc_cascadian } }
			IF = { limit = { is_planet_class = pc_retinal } set_planet_entity = { picture = pc_retinal } }
			IF = { limit = { is_planet_class = pc_forest } set_planet_entity = { picture = pc_forest } }
			IF = { limit = { is_planet_class = pc_lake } set_planet_entity = { picture = pc_lake } }
			IF = { limit = { is_planet_class = pc_desertislands } set_planet_entity = { picture = pc_desertislands } }
			IF = { limit = { is_planet_class = pc_subarctic } set_planet_entity = { picture = pc_subarctic } }
			IF = { limit = { is_planet_class = pc_mangrove } set_planet_entity = { picture = pc_mangrove } }
			IF = { limit = { is_planet_class = pc_wetswamp } set_planet_entity = { picture = pc_wetswamp } }
			IF = { limit = { is_planet_class = pc_hajungle } set_planet_entity = { picture = pc_hajungle } }
			IF = { limit = { is_planet_class = pc_gaia } set_planet_entity = { picture = pc_gaia } }
			IF = { limit = { is_planet_class = pc_prairie } set_planet_entity = { picture = pc_prairie } }
			IF = { limit = { is_planet_class = pc_steppe } set_planet_entity = { picture = pc_steppe } }
			IF = { limit = { is_planet_class = pc_swamp } set_planet_entity = { picture = pc_swamp } }
			IF = { limit = { is_planet_class = pc_glacial } set_planet_entity = { picture = pc_glacial } }
			IF = { limit = { is_planet_class = pc_boreal } set_planet_entity = { picture = pc_boreal } }
			IF = { limit = { is_planet_class = pc_arctic } set_planet_entity = { picture = pc_arctic } }
			IF = { limit = { is_planet_class = pc_alpine } set_planet_entity = { picture = pc_alpine } }
			IF = { limit = { is_planet_class = pc_mushroom } set_planet_entity = { picture = pc_mushroom } }
			IF = { limit = { is_planet_class = pc_med } set_planet_entity = { picture = pc_med } }
			IF = { limit = { is_planet_class = pc_savannah } set_planet_entity = { picture = pc_savannah } }
			IF = { limit = { is_planet_class = pc_city } set_planet_entity = { picture = pc_city } }
			IF = { limit = { is_planet_class = pc_geothermal } set_planet_entity = { picture = pc_geothermal } }
			IF = { limit = { is_planet_class = pc_superhabitable } set_planet_entity = { picture = pc_superhabitable } }
			IF = { limit = { is_planet_class = pc_tidallylocked } set_planet_entity = { picture = pc_tidallylocked } }
			IF = { limit = { is_planet_class = pc_biolumen } set_planet_entity = { picture = pc_biolumen } }
			IF = { limit = { is_planet_class = pc_primal } set_planet_entity = { picture = pc_primal } }
			IF = { limit = { is_planet_class = pc_salt } set_planet_entity = { picture = pc_salt } }
		}
	}
	
	ai_weight = {
		weight = 1
		modifier = {
			factor = 0
		}
	}
}

# Change Ocean Picture
decision_oceancapital = {
	icon = decision_oceancapital
	owned_planets_only = yes

	#enactment_time = 1800
	resources = {
		category = decisions
		cost = {
			influence = 25
		}
	}
	
	potential = {
		owner = { has_trait = trait_pc_aquatic_preference }
		NOT = { is_planet_class = pc_pdshroud }
		NOT = { is_planet_class = pc_aquatic }
		NOT = { has_planet_flag = pdaquapicture }
		NOT = { is_planet_class = pc_relic }
		NOT = { is_planet_class = pc_city }
		NOT = { is_planet_class = pc_ecocity }
		NOT = { is_planet_class = pc_pd_gas_giant_hab }
		NOT = { is_planet_class = pc_pd_barren_hab }
		NOT = { is_planet_class = pc_pd_barren_cold_hab }
		NOT = { is_planet_class = pc_pd_frozen_hab }
		NOT = { is_planet_class = pc_pd_molten_hab }
		NOT = { is_planet_class = pc_pd_toxic_hab }
		NOT = { is_planet_class = pc_pd_hothouse_hab }
		NOT = { is_planet_class = pc_pd_asteroid_hab }
		NOT = { is_planet_class = pc_hadesert }
		NOT = { is_planet_class = pc_antarctic }
		NOT = { is_planet_class = pc_snow }
		NOT = { is_planet_class = pc_highland }
		NOT = { is_planet_class = pc_tundra }
		NOT = { is_planet_class = pc_frozen_desert }
		NOT = { is_planet_class = pc_mesa }
		NOT = { is_planet_class = pc_outback }
		NOT = { is_planet_class = pc_desert }
		NOT = { is_planet_class = pc_arid }
		NOT = { is_planet_class = pc_sandsea }
	}

	effect = {
		custom_tooltip = decision_oceancapital_tooltip
		hidden_effect = {
			set_planet_flag = pdaquapicture
			IF = { limit = { is_planet_class = pc_ocean } set_planet_entity = { picture = pc_aquatic } set_planet_flag = pdaquapicture }
			IF = { limit = { is_planet_class = pc_continental } set_planet_entity = { picture = pc_aquatic } set_planet_flag = pdaquapicture }
			IF = { limit = { is_planet_class = pc_forest } set_planet_entity = { picture = pc_aquatic } set_planet_flag = pdaquapicture }
			IF = { limit = { is_planet_class = pc_lake } set_planet_entity = { picture = pc_aquatic } set_planet_flag = pc_lake }
			IF = { limit = { is_planet_class = pc_cascadian } set_planet_entity = { picture = pc_aquatic } set_planet_flag = pdaquapicture } 
			IF = { limit = { is_planet_class = pc_retinal } set_planet_entity = { picture = pc_aquatic } set_planet_flag = pdaquapicture }
			IF = { limit = { is_planet_class = pc_steppe } set_planet_entity = { picture = pc_aquatic } set_planet_flag = pdaquapicture }
			IF = { limit = { is_planet_class = pc_city } set_planet_entity = { picture = pc_aquaticcity } set_planet_flag = pdaquapicture }
			#IF = { limit = { is_planet_class = pc_hadesert } set_planet_entity = { picture = pc_aquatic } set_planet_flag = pdaquapicture }
			IF = { limit = { is_planet_class = pc_tidallylocked } set_planet_entity = { picture = pc_aquatic } set_planet_flag = pdaquapicture }
			#IF = { limit = { is_planet_class = pc_karst } set_planet_entity = { picture = pc_aquatic } set_planet_flag = pdaquapicture }
			#Cold
			IF = { limit = { is_planet_class = pc_subarctic } set_planet_entity = { picture = pc_aquaticcold } set_planet_flag = pdaquapicture }
			IF = { limit = { is_planet_class = pc_swamp } set_planet_entity = { picture = pc_aquaticcold } set_planet_flag = pdaquapicture }
			IF = { limit = { is_planet_class = pc_glacial } set_planet_entity = { picture = pc_aquaticcold } set_planet_flag = pdaquapicture }
			IF = { limit = { is_planet_class = pc_boreal } set_planet_entity = { picture = pc_aquaticcold } set_planet_flag = pdaquapicture }
			IF = { limit = { is_planet_class = pc_arctic } set_planet_entity = { picture = pc_aquaticcold } set_planet_flag = pdaquapicture }
			IF = { limit = { is_planet_class = pc_alpine } set_planet_entity = { picture = pc_aquaticcold } set_planet_flag = pdaquapicture }
			IF = { limit = { is_planet_class = pc_mushroom } set_planet_entity = { picture = pc_aquaticcold } set_planet_flag = pdaquapicture }
			#IF = { limit = { is_planet_class = pc_antarctic } set_planet_entity = { picture = pc_aquaticcold } set_planet_flag = pdaquapicture }
			#IF = { limit = { is_planet_class = pc_snow } set_planet_entity = { picture = pc_aquaticcold } set_planet_flag = pdaquapicture }
			#IF = { limit = { is_planet_class = pc_highland } set_planet_entity = { picture = pc_aquaticcold } set_planet_flag = pdaquapicture }
			#IF = { limit = { is_planet_class = pc_tundra } set_planet_entity = { picture = pc_aquaticcold } set_planet_flag = pdaquapicture }
			#IF = { limit = { is_planet_class = pc_frozen_desert } set_planet_entity = { picture = pc_aquaticcold } set_planet_flag = pdaquapicture }
			#Tropical
			IF = { limit = { is_planet_class = pc_desertislands } set_planet_entity = { picture = pc_aquatichot } set_planet_flag = pdaquapicture }
			IF = { limit = { is_planet_class = pc_tropical } set_planet_entity = { picture = pc_aquatichot } set_planet_flag = pdaquapicture }
			IF = { limit = { is_planet_class = pc_mangrove } set_planet_entity = { picture = pc_aquatichot } set_planet_flag = pdaquapicture }
			IF = { limit = { is_planet_class = pc_wetswamp } set_planet_entity = { picture = pc_aquatichot } set_planet_flag = pdaquapicture }
			IF = { limit = { is_planet_class = pc_hajungle } set_planet_entity = { picture = pc_aquatichot } set_planet_flag = pdaquapicture }
			IF = { limit = { is_planet_class = pc_oasis } set_planet_entity = { picture = pc_aquatichot } set_planet_flag = pdaquapicture }
			IF = { limit = { is_planet_class = pc_med } set_planet_entity = { picture = pc_aquatichot } set_planet_flag = pdaquapicture }
			IF = { limit = { is_planet_class = pc_savannah } set_planet_entity = { picture = pc_aquatichot } set_planet_flag = pdaquapicture }
			IF = { limit = { is_planet_class = pc_gaia } set_planet_entity = { picture = pc_aquatichot } set_planet_flag = pdaquapicture }
			IF = { limit = { is_planet_class = pc_ringworld_habitable } set_planet_entity = { picture = pc_aquatichot } set_planet_flag = pdaquapicture }
			#IF = { limit = { is_planet_class = pc_mesa } set_planet_entity = { picture = pc_aquatichot } set_planet_flag = pdaquapicture }
			#IF = { limit = { is_planet_class = pc_outback } set_planet_entity = { picture = pc_aquatichot } set_planet_flag = pdaquapicture }
			#IF = { limit = { is_planet_class = pc_desert } set_planet_entity = { picture = pc_aquatichot } set_planet_flag = pdaquapicture }
			#IF = { limit = { is_planet_class = pc_arid } set_planet_entity = { picture = pc_aquatichot } set_planet_flag = pdaquapicture }
			#IF = { limit = { is_planet_class = pc_sandsea } set_planet_entity = { picture = pc_aquatichot } set_planet_flag = pdaquapicture }
			IF = { limit = { is_planet_class = pc_geothermal } set_planet_entity = { picture = pc_aquatichot } set_planet_flag = pdaquapicture }
			IF = { limit = { is_planet_class = pc_superhabitable } set_planet_entity = { picture = pc_aquatichot } set_planet_flag = pdaquapicture }
			IF = { limit = { is_planet_class = pc_biolumen } set_planet_entity = { picture = pc_aquatichot } set_planet_flag = pdaquapicture }
			IF = { limit = { is_planet_class = pc_primal } set_planet_entity = { picture = pc_aquatichot } set_planet_flag = pdaquapicture }
		}
	}
	
	ai_weight = {
		weight = 1
		modifier = {
			factor = 0
		}
	}
}

# Add Acean Crystal Patch
decision_pdcrystalpatch = {
	icon = decision_pdcrystalpatch
	owned_planets_only = yes

	enactment_time = 900
	resources = {
		category = decisions
		cost = {
			sr_acean = 500
		}
	}
		
	prerequisites = {
		"tech_crystal_propagation"		
	}
	
	potential = {
		NOT = { is_planet_class = pc_crystal }
		NOT = { has_planet_flag = pdcrystalpatch }
		NOT = { is_planet_class = pc_city }
		NOT = { is_planet_class = pc_ecocity }
		NOT = { is_planet_class = pc_hive }
		NOT = { is_planet_class = pc_bioforge }
		NOT = { is_planet_class = pc_machine }
		NOT = { is_planet_class = pc_machine_factory }
		NOT = { has_modifier = resort_colony }
		NOT = { has_modifier = penal_colony }
		NOT = { has_modifier = slave_colony }
		habitable_structure = no
	}

	effect = {
		add_deposit = d_pdcrystalpatch
		hidden_effect = { set_planet_flag = pdcrystalpatch }
	}
	
	ai_weight = {
		weight = 1
    modifier = {
        factor = 0
        or = {
            num_pops < 15
            and = {
              # By late game, AI will likely keep some open building slots
              # This is mostly harmless if there are still jobs available
              # Otherwise, don't let them take this over building a building
              free_building_slots > 0
              free_jobs <= 0
            }
            free_building_slots > 2
            owner = {
                or = {
                    resource_stockpile_compare = { resource = sr_acean value < 2500 }
                    resource_income_compare = { resource = sr_acean value < 0 }
                }
            }
            AND = {
            	free_district_slots <= 0
            	owner = { resource_income_compare = { resource = rare_crystals value > 2 } }
          	}
            AND = {
		          num_free_districts = {
		            type = district_mining
		            value > 1
		          }
		          num_free_districts = {
		            type = district_farming
		            value > 1
		          }
	          }
          	owner = { resource_income_compare = { resource = rare_crystals value > 2 } }
        }
    }
	}
}

# Tiyanki Prospecting
decision_tiyanki_prospecting = {
	icon = decision_tiyanki_prospecting
	owned_planets_only = yes

	enactment_time = 500
	resources = {
		category = decisions
		cost = {
			energy = 1000
		}
	}
		
	prerequisites = { "tech_tiyanki_prospecting" }
	
	potential = {
		NOT = { is_planet_class = pc_graveyard }
		NOT = { has_planet_flag = tiyanki_prospected }
		NOT = { is_planet_class = pc_city }
		NOT = { is_planet_class = pc_ecocity }
		NOT = { is_planet_class = pc_hive }
		NOT = { is_planet_class = pc_bioforge }
		NOT = { is_planet_class = pc_machine }
		NOT = { is_planet_class = pc_machine_factory }
		NOT = { has_modifier = resort_colony }
		NOT = { has_modifier = penal_colony }
		NOT = { has_modifier = slave_colony }
		habitable_structure = no
	}

	effect = {
		custom_tooltip = decision_tiyanki_prospect_effects_short
		hidden_effect = {
			set_planet_flag = tiyanki_prospected
			random_list = {
				40 = { add_deposit = d_tiyanki_small }
				30 = { add_deposit = d_bubbling_swamp }
				20 = { add_deposit = d_fuming_bog }
				10 = { add_deposit = d_tiyanki_large }
			}
		}
	}
	
	ai_weight = {
		weight = 2
    modifier = {
        factor = 0
        or = {
            # Deliberately start not on a multiple of 5 boundary, so hopefully this
            # will be done by the time the next building slot opens up.
            num_pops < 13
            and = {
              # By late game, AI will likely keep some open building slots
              # This is mostly harmless if there are still jobs available
              # Otherwise, don't let them take this over building a building
              free_building_slots > 0
              free_jobs <= 0
            }
            free_building_slots > 2
            owner = {
                or = {
                    resource_stockpile_compare = { resource = energy value < 8000 }
                }
            }
        }
    }
	}
}

# Techno Canal
decision_techno_canal = {
	icon = decision_techno_canal
	owned_planets_only = yes

	enactment_time = 900
	resources = {
		category = decisions
		cost = {
			energy = 1000
			minerals = 1000
		}
	}
		
	prerequisites = {
		"tech_techno_canal"		
	}
	
	potential = {
		NOT = { is_planet_class = pc_technoorganic }
		NOT = { has_planet_flag = pdtechnocanal }
		NOT = { is_planet_class = pc_city }
		NOT = { is_planet_class = pc_ecocity }
		NOT = { is_planet_class = pc_hive }
		NOT = { is_planet_class = pc_bioforge }
		NOT = { is_planet_class = pc_machine }
		NOT = { is_planet_class = pc_machine_factory }
		NOT = { has_modifier = resort_colony }
		NOT = { has_modifier = penal_colony }
		NOT = { has_modifier = slave_colony }
		habitable_structure = no
	}

	effect = {
		add_deposit = d_technocanal
		hidden_effect = { set_planet_flag = pdtechnocanal }
	}
	
	ai_weight = {
		weight = 1
    modifier = {
        factor = 0
        or = {
            num_pops < 15
            and = {
              # By late game, AI will likely keep some open building slots
              # This is mostly harmless if there are still jobs available
              # Otherwise, don't let them take this over building a building
              free_building_slots > 0
              free_jobs <= 0
            }
            free_building_slots > 2
            owner = {
                or = {
                    resource_stockpile_compare = { resource = energy value < 8000 } 
                    resource_stockpile_compare = { resource = minerals value < 8000 } 
                }
            }
            free_district_slots <= 0
            num_free_districts = {
              type = district_farming
              value > 1
            }
        }
    }
	}
}

# Hive Infestation
decision_pdhive_infest1 = {
	icon = decision_pdhive_infest1
	owned_planets_only = yes

	enactment_time = 1200
	resources = {
		category = decisions
		cost = {
			energy = 1500
		}
	}
		
	#prerequisites = {
	#	"tech_pdhive_infest1"		
	#}
		
	#allow = {
	#	num_uncleared_blockers < 1
	#}
	
	potential = {
		owner = { has_origin = origin_pd_hive }
		NOT = { is_planet_class = pc_hive }
		NOT = { is_planet_class = pc_archive }
		NOT = { is_planet_class = pc_pdhive1 }
		NOT = { is_planet_class = pc_pdhive2 }
		NOT = { is_planet_class = pc_bioforge }
		NOT = { is_planet_class = pc_machine }
		NOT = { is_planet_class = pc_machine_factory }
		NOT = { is_planet_class = pc_city }
		NOT = { is_planet_class = pc_ecocity }
		NOT = { habitable_structure = yes }
		NOT = { is_a_planet_megastructure = yes }
		NOT = { has_planet_flag = pd_ignore }
	}

	effect = {
		hidden_effect = {
			#Wet
			if = { limit = { is_planet_class = pc_continental } set_planet_flag = pdhive_continental }
			if = { limit = { is_planet_class = pc_tropical } set_planet_flag = pdhive_tropical }
			if = { limit = { is_planet_class = pc_ocean } set_planet_flag = pdhive_ocean }
			if = { limit = { is_planet_class = pc_cascadian } set_planet_flag = pdhive_cascadian }
			if = { limit = { is_planet_class = pc_retinal } set_planet_flag = pdhive_retinal }
			if = { limit = { is_planet_class = pc_forest } set_planet_flag = pdhive_forest }
			if = { limit = { is_planet_class = pc_lake } set_planet_flag = pdhive_lake }
			if = { limit = { is_planet_class = pc_wetswamp } set_planet_flag = pdhive_wetswamp }
			if = { limit = { is_planet_class = pc_subarctic } set_planet_flag = pdhive_subarctic }
			if = { limit = { is_planet_class = pc_desertislands } set_planet_flag = pdhive_desertislands }
			if = { limit = { is_planet_class = pc_mangrove } set_planet_flag = pdhive_mangrove }
			if = { limit = { is_planet_class = pc_hajungle } set_planet_flag = pdhive_hajungle }
			#Dry
			if = { limit = { is_planet_class = pc_desert } set_planet_flag = pdhive_desert }
			if = { limit = { is_planet_class = pc_arid } set_planet_flag = pdhive_arid }
			if = { limit = { is_planet_class = pc_savannah } set_planet_flag = pdhive_savannah }
			if = { limit = { is_planet_class = pc_sandsea } set_planet_flag = pdhive_sandsea }
			if = { limit = { is_planet_class = pc_steppe } set_planet_flag = pdhive_steppe }
			if = { limit = { is_planet_class = pc_oasis } set_planet_flag = pdhive_oasis }
			if = { limit = { is_planet_class = pc_mesa } set_planet_flag = pdhive_mesa }
			if = { limit = { is_planet_class = pc_hadesert } set_planet_flag = pdhive_hadesert }
			if = { limit = { is_planet_class = pc_prairie } set_planet_flag = pdhive_prairie }
			if = { limit = { is_planet_class = pc_med } set_planet_flag = pdhive_med }
			if = { limit = { is_planet_class = pc_outback } set_planet_flag = pdhive_outback }
			#Cold
			if = { limit = { is_planet_class = pc_arctic } set_planet_flag = pdhive_arctic }
			if = { limit = { is_planet_class = pc_tundra } set_planet_flag = pdhive_tundra }
			if = { limit = { is_planet_class = pc_alpine } set_planet_flag = pdhive_alpine }
			if = { limit = { is_planet_class = pc_swamp } set_planet_flag = pdhive_swamp }
			if = { limit = { is_planet_class = pc_frozen_desert } set_planet_flag = pdhive_frozen_desert }
			if = { limit = { is_planet_class = pc_boreal } set_planet_flag = pdhive_boreal }
			if = { limit = { is_planet_class = pc_mushroom } set_planet_flag = pdhive_mushroom }
			if = { limit = { is_planet_class = pc_antarctic } set_planet_flag = pdhive_antarctic }
			if = { limit = { is_planet_class = pc_snow } set_planet_flag = pdhive_snow }
			if = { limit = { is_planet_class = pc_glacial } set_planet_flag = pdhive_glacial }
			if = { limit = { is_planet_class = pc_highland } set_planet_flag = pdhive_highland }
			#Rare
			if = { limit = { is_planet_class = pc_geothermal } set_planet_flag = pdhive_geothermal }
			if = { limit = { is_planet_class = pc_superhabitable } set_planet_flag = pdhive_superhabitable }
			if = { limit = { is_planet_class = pc_tidallylocked } set_planet_flag = pdhive_tidallylocked }
			if = { limit = { is_planet_class = pc_biolumen } set_planet_flag = pdhive_biolumen }
			if = { limit = { is_planet_class = pc_karst } set_planet_flag = pdhive_karst }
			if = { limit = { is_planet_class = pc_primal } set_planet_flag = pdhive_primal }
			if = { limit = { is_planet_class = pc_aquatic } set_planet_flag = pdhive_aquatic }
			if = { limit = { is_planet_class = pc_salt } set_planet_flag = pdhive_salt }
			#Exotic
			if = { limit = { is_planet_class = pc_ammonia } set_planet_flag = pdhive_ammonia }
			if = { limit = { is_planet_class = pc_methane } set_planet_flag = pdhive_methane }
			if = { limit = { is_planet_class = pc_ash } set_planet_flag = pdhive_ash }
			if = { limit = { is_planet_class = pc_irradiated } set_planet_flag = pdhive_irradiated }
			#Unique
			if = { limit = { is_planet_class = pc_floating } set_planet_flag = pdhive_floating }
			if = { limit = { is_planet_class = pc_crystal } set_planet_flag = pdhive_crystal }
			if = { limit = { is_planet_class = pc_technoorganic } set_planet_flag = pdhive_technoorganic }
			if = { limit = { is_planet_class = pc_graveyard } set_planet_flag = pdhive_graveyard }
			if = {
				limit = { has_deposit = d_crystalline_caverns }
				set_planet_flag = pd_hive_crystal1
			}
			if = {
				limit = { has_deposit = d_crystal_reef }
				set_planet_flag = pd_hive_crystal2
			}
			if = {
				limit = { has_deposit = d_crystal_forest }
				set_planet_flag = pd_hive_crystal2
			}
			if = {
				limit = { has_deposit = d_fuming_bog }
				set_planet_flag = pd_hive_gas2
			}
			if = {
				limit = { has_deposit = d_bubbling_swamp }
				set_planet_flag = pd_hive_gas1
			}
			if = {
				limit = { has_deposit = d_dust_caverns }
				set_planet_flag = pd_hive_motes1
			}
			if = {
				limit = { has_deposit = d_dust_desert }
				set_planet_flag = pd_hive_motes2
			}
			if = {
				limit = { has_deposit = d_betharian_deposit }
				set_planet_flag = pd_betharian_deposit
			}

			if = {
				limit = { has_deposit = d_eludium_centre }
				set_planet_flag = pd_hive_motes2
			}
			if = {
				limit = { has_deposit = d_crystal_guild }
				set_planet_flag = pd_hive_crystal2
			}
			if = {
				limit = { has_deposit = d_graveyard_well }
				set_planet_flag = pd_hive_gas2
			}
			if = {
				limit = { has_deposit = d_geothermal_slurry_site }
				set_planet_flag = pd_hive_gas2
			}
			if = {
				limit = { has_deposit = d_ancient_motes }
				set_planet_flag = pd_hive_motes2
			}
			if = {
				limit = { has_deposit = d_nightside_mining_operations }
				set_planet_flag = pd_hive_crystal2
			}
			if = {
				limit = { has_deposit = d_aquatic_trench }
				set_planet_flag = pd_hive_gas2
			}
			if = {
				limit = { has_deposit = d_karst_cave }
				set_planet_flag = pd_hive_crystal2
			}
			if = {
				limit = { has_deposit = d_lava_lakes }
				set_planet_flag = pd_hive_motes2
			}
			if = {
				limit = { has_deposit = d_salt_caves }
				set_planet_flag = pd_hive_crystal2
			}
			if = {
				limit = { has_deposit = d_ammonia_sea }
				set_planet_flag = pd_hive_motes2
			}
			if = {
				limit = { has_deposit = d_frozen_gas_mountain }
				set_planet_flag = pd_hive_gas2
			}

			clear_deposits = yes
			
			IF = {
				limit = {
					planet_size <= 25
					planet_size >= 21
				}
				add_deposit = d_pdhive10
			}
			IF = {
				limit = {
					planet_size <= 20
					planet_size >= 16
				}
				add_deposit = d_pdhive8
			}
			IF = {
				limit = {
					planet_size <= 15
					planet_size >= 11
				}
				add_deposit = d_pdhive6
			}
			IF = {
				limit = {
					planet_size <= 10
				}
				add_deposit = d_pdhive4
			}

			if = {
				limit = { has_planet_flag = pd_hive_gas2 }
				add_deposit = d_hive_gas2
				remove_planet_flag = pd_hive_gas2
			}
			if = {
				limit = { has_planet_flag = pd_hive_gas1 }
				add_deposit = d_hive_gas1
				remove_planet_flag = pd_hive_gas1
			}
			if = {
				limit = { has_planet_flag = pd_hive_motes2 }
				add_deposit = d_hive_motes2
				remove_planet_flag = pd_hive_motes2
			}
			if = {
				limit = { has_planet_flag = pd_hive_motes1 }
				add_deposit = d_hive_motes1
				remove_planet_flag = pd_hive_motes1
			}
			if = {
				limit = { has_planet_flag = pd_hive_crystal1 }
				add_deposit = d_hive_crystal1
				remove_planet_flag = pd_hive_crystal1
			}
			if = {
				limit = { has_planet_flag = pd_hive_crystal2 }
				add_deposit = d_hive_crystal2
				remove_planet_flag = pd_hive_crystal2
			}
		}
		change_pc = pc_pdhive1
	}
	
	ai_weight = {
		weight = 10000
	}
}

decision_pdhive_infest2 = {
	icon = decision_pdhive_infest1
	owned_planets_only = yes

	enactment_time = 2400
	resources = {
		category = decisions
		cost = {
			energy = 3500
		}
	}
		
	#prerequisites = {
	#	"tech_pdhive_infest1"		
	#}
		
	allow = {
		num_pops >= 40
	}
	
	potential = {
		owner = { has_origin = origin_pd_hive }
		is_planet_class = pc_pdhive1
		habitable_structure = no
	}

	effect = {
		change_pc = pc_pdhive2
		hidden_effect = { 
			if = { limit = { has_deposit = d_pdhive10 } remove_deposit = d_pdhive10 add_deposit = d_pdhive5 }
			if = { limit = { has_deposit = d_pdhive8 } remove_deposit = d_pdhive8 add_deposit = d_pdhive4 }
			if = { limit = { has_deposit = d_pdhive6 } remove_deposit = d_pdhive6 add_deposit = d_pdhive3 }
			if = { limit = { has_deposit = d_pdhive4 } remove_deposit = d_pdhive4 add_deposit = d_pdhive2 }
		}
	}
	
	ai_weight = {
		weight = 10000
	}
}

decision_pdhive_infest3 = {
	icon = decision_pdhive_infest1
	owned_planets_only = yes

	enactment_time = 3600
	resources = {
		category = decisions
		cost = {
			energy = 5000
		}
	}
		
	allow = {
		num_pops > 40
	}
	
	potential = {
		owner = { has_origin = origin_pd_hive }
		is_planet_class = pc_pdhive2
		habitable_structure = no
		owner = { has_ascension_perk = ap_hive_worlds }
	}

	effect = {
		change_pc = pc_hive
		clear_planet_modifiers = yes
		hidden_effect = {
			remove_deposit = d_pdhive2
			remove_deposit = d_pdhive3
			remove_deposit = d_pdhive4
			remove_deposit = d_pdhive5
			remove_deposit = d_pdhive6
			remove_deposit = d_pdhive8
			remove_deposit = d_pdhive10
		}
	}
	
	ai_weight = {
		weight = 10000
	}
}

#Uninfest Hive
decision_pdhive_uninfest = {
	icon = decision_pdhive_uninfest
	owned_planets_only = yes

	enactment_time = 3000
	resources = {
		category = decisions
		cost = {
			energy = 5000
		}
	}
		
	#prerequisites = {
	#	"tech_pdhive_infest1"		
	#}
	
	potential = {
		NOT = { owner = { has_origin = origin_pd_hive } }
		OR = {
		is_planet_class = pc_pdhive1
		is_planet_class = pc_pdhive2
		}
		habitable_structure = no
	}

	effect = {
		custom_tooltip = decision_uninfesthivepd_tooltip
		hidden_effect = {
			#Wet
			if = { limit = { has_planet_flag = pdhive_continental } change_pc = pc_continental remove_planet_flag = pdhive_continental }
			if = { limit = { has_planet_flag = pdhive_tropical } change_pc = pc_tropical remove_planet_flag = pdhive_tropical }
			if = { limit = { has_planet_flag = pdhive_ocean } change_pc = pc_ocean remove_planet_flag = pdhive_ocean }
			if = { limit = { has_planet_flag = pdhive_cascadian } change_pc = pc_cascadian remove_planet_flag = pdhive_cascadian }
			if = { limit = { has_planet_flag = pdhive_retinal } change_pc = pc_retinal remove_planet_flag = pdhive_retinal }
			if = { limit = { has_planet_flag = pdhive_forest } change_pc = pc_forest remove_planet_flag = pdhive_forest }
			if = { limit = { has_planet_flag = pdhive_lake } change_pc = pc_lake remove_planet_flag = pdhive_lake }
			if = { limit = { has_planet_flag = pdhive_wetswamp } change_pc = pc_wetswamp remove_planet_flag = pdhive_wetswamp }
			if = { limit = { has_planet_flag = pdhive_subarctic } change_pc = pc_subarctic remove_planet_flag = pdhive_subarctic }
			if = { limit = { has_planet_flag = pdhive_desertislands } change_pc = pc_desertislands remove_planet_flag = pdhive_desertislands }
			if = { limit = { has_planet_flag = pdhive_mangrove } change_pc = pc_mangrove remove_planet_flag = pdhive_mangrove }
			if = { limit = { has_planet_flag = pdhive_hajungle } change_pc = pc_hajungle remove_planet_flag = pdhive_hajungle }
			#Dry
			if = { limit = { has_planet_flag = pdhive_desert } change_pc = pc_desert remove_planet_flag = pdhive_desert }
			if = { limit = { has_planet_flag = pdhive_arid } change_pc = pc_arid remove_planet_flag = pdhive_arid }
			if = { limit = { has_planet_flag = pdhive_savannah } change_pc = pc_savannah remove_planet_flag = pdhive_savannah }
			if = { limit = { has_planet_flag = pdhive_sandsea } change_pc = pc_sandsea remove_planet_flag = pdhive_sandsea }
			if = { limit = { has_planet_flag = pdhive_steppe } change_pc = pc_steppe remove_planet_flag = pdhive_steppe }
			if = { limit = { has_planet_flag = pdhive_oasis } change_pc = pc_oasis remove_planet_flag = pdhive_oasis }
			if = { limit = { has_planet_flag = pdhive_mesa } change_pc = pc_mesa remove_planet_flag = pdhive_mesa }
			if = { limit = { has_planet_flag = pdhive_hadesert } change_pc = pc_hadesert remove_planet_flag = pdhive_hadesert }
			if = { limit = { has_planet_flag = pdhive_prairie } change_pc = pc_prairie remove_planet_flag = pdhive_prairie }
			if = { limit = { has_planet_flag = pdhive_med } change_pc = pc_med remove_planet_flag = pdhive_med }
			if = { limit = { has_planet_flag = pdhive_outback } change_pc = pc_outback remove_planet_flag = pdhive_outback }
			#Cold
			if = { limit = { has_planet_flag = pdhive_arctic } change_pc = pc_arctic remove_planet_flag = pdhive_arctic }
			if = { limit = { has_planet_flag = pdhive_tundra } change_pc = pc_tundra remove_planet_flag = pdhive_tundra }
			if = { limit = { has_planet_flag = pdhive_alpine } change_pc = pc_alpine remove_planet_flag = pdhive_alpine }
			if = { limit = { has_planet_flag = pdhive_swamp } change_pc = pc_swamp remove_planet_flag = pdhive_swamp }
			if = { limit = { has_planet_flag = pdhive_frozen_desert } change_pc = pc_frozen_desert remove_planet_flag = pdhive_frozen_desert }
			if = { limit = { has_planet_flag = pdhive_boreal } change_pc = pc_boreal remove_planet_flag = pdhive_boreal }
			if = { limit = { has_planet_flag = pdhive_mushroom } change_pc = pc_mushroom remove_planet_flag = pdhive_mushroom }
			if = { limit = { has_planet_flag = pdhive_antarctic } change_pc = pc_antarctic remove_planet_flag = pdhive_antarctic }
			if = { limit = { has_planet_flag = pdhive_snow } change_pc = pc_snow remove_planet_flag = pdhive_snow }
			if = { limit = { has_planet_flag = pdhive_glacial } change_pc = pc_glacial remove_planet_flag = pdhive_glacial }
			if = { limit = { has_planet_flag = pdhive_highland } change_pc = pc_highland remove_planet_flag = pdhive_highland }
			#Rare
			if = { limit = { has_planet_flag = pdhive_geothermal } change_pc = pc_geothermal remove_planet_flag = pdhive_geothermal }
			if = { limit = { has_planet_flag = pdhive_superhabitable } change_pc = pc_superhabitable remove_planet_flag = pdhive_superhabitable }
			if = { limit = { has_planet_flag = pdhive_tidallylocked } change_pc = pc_tidallylocked remove_planet_flag = pdhive_tidallylocked }
			if = { limit = { has_planet_flag = pdhive_biolumen } change_pc = pc_biolumen remove_planet_flag = pdhive_biolumen }
			if = { limit = { has_planet_flag = pdhive_karst } change_pc = pc_karst remove_planet_flag = pdhive_karst }
			if = { limit = { has_planet_flag = pdhive_primal } change_pc = pc_primal remove_planet_flag = pdhive_primal }
			if = { limit = { has_planet_flag = pdhive_aquatic } change_pc = pc_aquatic remove_planet_flag = pdhive_aquatic }
			if = { limit = { has_planet_flag = pdhive_salt } change_pc = pc_salt remove_planet_flag = pdhive_salt }
			#Exotic
			if = { limit = { has_planet_flag = pdhive_ammonia } change_pc = pc_ammonia remove_planet_flag = pdhive_ammonia }
			if = { limit = { has_planet_flag = pdhive_methane } change_pc = pc_methane remove_planet_flag = pdhive_methane }
			if = { limit = { has_planet_flag = pdhive_ash } change_pc = pc_ash remove_planet_flag = pdhive_ash }
			if = { limit = { has_planet_flag = pdhive_irradiated } change_pc = pc_irradiated remove_planet_flag = pdhive_irradiated }
			#Unique
			if = { limit = { has_planet_flag = pdhive_floating } change_pc = pc_floating remove_planet_flag = pdhive_floating }
			if = { limit = { has_planet_flag = pdhive_crystal } change_pc = pc_crystal remove_planet_flag = pdhive_crystal }
			if = { limit = { has_planet_flag = pdhive_technoorganic } change_pc = pc_technoorganic remove_planet_flag = pdhive_technoorganic }
			if = { limit = { has_planet_flag = pdhive_graveyard } change_pc = pc_graveyard remove_planet_flag = pdhive_graveyard }
			reroll_planet = yes 
			remove_deposit = d_pdhive2
			remove_deposit = d_pdhive3
			remove_deposit = d_pdhive4
			remove_deposit = d_pdhive5
			remove_deposit = d_pdhive6
			remove_deposit = d_pdhive8
			remove_deposit = d_pdhive10
			clear_blockers = yes
		}
	}
	
	ai_weight = {
		weight = 10000
	}
}

decision_pd_transplant_tree = {
	owned_planets_only = yes
	sound = event_laboratory_sound
	icon = decision_pd_transplant_tree

	enactment_time = 180

	resources = {
		category = decisions
		cost = {
			food = 500
		}
	}

	potential = {
		has_modifier = no_pd_lifetree
		NOT = {
			OR = {
				has_deposit = d_pd_tree_of_life_habitat
				has_deposit = d_pd_tree_of_life_ringworld
				has_deposit = d_pd_tree_of_life_special
			}
		}
	}

	allow = { }

	effect = {
		remove_modifier = no_pd_lifetree
		hidden_effect = {
		remove_deposit = d_pd_tree_of_life_dead
		IF = {
			limit = { 
				NOT = { has_planet_flag = pd_tol1 }
				NOT = { has_planet_flag = pd_tol2 }
				NOT = { has_planet_flag = pd_tol3 }
				NOT = { habitable_structure = yes }
				NOT = { is_planet_class = pc_ecocity }
				NOT = { is_planet_class = pc_relic }
				NOT = { is_planet_class = pc_city }
				NOT = { is_planet_class = pc_floating }
				NOT = { is_planet_class = pc_crystal }
				NOT = { is_planet_class = pc_technoorganic }
				NOT = { is_planet_class = pc_graveyard }
			 }
			add_deposit = d_pd_tree_of_life_1
			set_planet_flag = pd_tol1	
			IF = {
				limit = { owner = { NOT = { has_technology = tech_pdtoltech } } }
				planet_event = { id = pdengine.40 days = 7200 random = 7200 } #TODO test
			}
			IF = {
				limit = { owner = { has_technology = tech_pdtoltech } }
				planet_event = { id = pdengine.40 days = 3600 random = 3600 } #TODO test
			}
		}
		ELSE_IF = {
			limit = { 
				habitable_structure = yes
				NOT = { is_planet_class = pc_ringworld_habitable }
			 }
		add_deposit = d_pd_tree_of_life_habitat
		}
		ELSE_IF = {
			limit = { 
				is_planet_class = pc_ringworld_habitable
			 }
		add_deposit = d_pd_tree_of_life_ringworld
		}
		ELSE_IF = {
			limit = { 
				OR = {
				is_planet_class = pc_ecocity
				is_planet_class = pc_relic
				is_planet_class = pc_city
				is_planet_class = pc_floating
				is_planet_class = pc_crystal
				is_planet_class = pc_technoorganic
				is_planet_class = pc_graveyard
				}
			 }
		add_deposit = d_pd_tree_of_life_special
			}
		}
	}

	ai_weight = {
		weight = 1
	}
}

#Ammonia Hab (No Colony)
decision_ammoniahabsnocolony = {
	#owned_planets_only = no
	sound = event_alien_nature_02
	icon = decision_ammoniahabs

	#enactment_time = 180

	resources = {
		category = decisions
		cost = {
			energy = 1000
		}
	}

	potential = {
		has_owner = no
		OR = {
		is_planet_class = pc_habitat
		is_planet_class = pc_ringworld_habitable
		is_planet_class = pc_relic
		is_planet_class = pc_habitat 
		is_planet_class = pc_pd_barren_hab
		is_planet_class = pc_pd_barren_cold_hab
		is_planet_class = pc_pd_frozen_hab
		is_planet_class = pc_pd_molten_hab
		is_planet_class = pc_pd_hothouse_hab
		is_planet_class = pc_pd_toxic_hab
		is_planet_class = pc_pd_gas_giant_hab
		is_planet_class = pc_pd_asteroid_hab
		is_planet_class = pc_city
		is_planet_class = pc_ecocity
		}
		NOT = { has_modifier = pdammoniaatmosphere }
		from = { has_trait = trait_pc_ammonia_preference }
	}

	allow = {
	}

	effect = {
		add_modifier = { modifier = pdammoniaatmosphere days = -1 }
		#set_planet_entity = { picture = pc_ammoniahab }
		custom_tooltip = changehabatsomphereeffect
		hidden_effect = { 
			remove_modifier = pdmethaneatmosphere
			remove_modifier = pdashatmosphere
			if = {
				limit = { is_planet_class = pc_ringworld_habitable }
				set_planet_entity = { picture = pc_ammoniaring entity = ammoniaring_habitable_entity_01_entity }
			}
			if = {
				limit = { 
					OR = { 
						is_planet_class = pc_city 
						is_planet_class = pc_ecocity 
					} 
				}
				set_planet_entity = { picture = pc_ammoniacity }
			}
		}
	}

	ai_weight = {
		weight = 1
	}
}

#Ammonia Hab (Colony)
decision_ammoniahabs = {
	owned_planets_only = yes
	sound = event_alien_nature_02
	icon = decision_ammoniahabs

	enactment_time = 360

	resources = {
		category = decisions
		cost = {
			energy = 1000
		}
	}

	potential = {
		OR = {
		is_planet_class = pc_habitat
		is_planet_class = pc_ringworld_habitable
		is_planet_class = pc_relic
		is_planet_class = pc_pd_barren_hab
		is_planet_class = pc_pd_barren_cold_hab
		is_planet_class = pc_pd_frozen_hab
		is_planet_class = pc_pd_molten_hab
		is_planet_class = pc_pd_hothouse_hab
		is_planet_class = pc_pd_toxic_hab
		is_planet_class = pc_pd_gas_giant_hab
		is_planet_class = pc_pd_asteroid_hab
		is_planet_class = pc_city
		is_planet_class = pc_ecocity
		}
		NOT = { has_modifier = pdammoniaatmosphere }
		owner = { has_trait = trait_pc_ammonia_preference }
	}

	allow = { 
	}

	effect = {
		add_modifier = { modifier = pdammoniaatmosphere days = -1 }
		#set_planet_entity = { picture = pc_ammoniahab }
		custom_tooltip = changehabatsomphereeffect
		hidden_effect = { 
			remove_modifier = pdmethaneatmosphere
			remove_modifier = pdashatmosphere
			if = {
				limit = { is_planet_class = pc_ringworld_habitable }
				set_planet_entity = { picture = pc_ammoniaring entity = ammoniaring_habitable_entity_01_entity }
			}
			if = {
				limit = { OR = { is_planet_class = pc_city is_planet_class = pc_ecocity } }
				set_planet_entity = { picture = pc_ammoniacity }
			}
		}
	}

	ai_weight = {
		weight = 1
	}
}

#Methane Hab (No Colony)
decision_methanehabsnocolony = {
	#owned_planets_only = no
	sound = event_alien_nature_02
	icon = decision_methanehabs

	#enactment_time = 180

	resources = {
		category = decisions
		cost = {
			energy = 1000
		}
	}

	potential = {
		has_owner = no
		OR = {
		is_planet_class = pc_habitat
		is_planet_class = pc_ringworld_habitable
		is_planet_class = pc_relic
		is_planet_class = pc_pd_barren_hab
		is_planet_class = pc_pd_barren_cold_hab
		is_planet_class = pc_pd_frozen_hab
		is_planet_class = pc_pd_molten_hab
		is_planet_class = pc_pd_hothouse_hab
		is_planet_class = pc_pd_toxic_hab
		is_planet_class = pc_pd_gas_giant_hab
		is_planet_class = pc_pd_asteroid_hab
		is_planet_class = pc_city
		is_planet_class = pc_ecocity
		}
		NOT = { has_modifier = pdmethaneatmosphere }
		from = { has_trait = trait_pc_methane_preference }
	}

	allow = {
	}

	effect = {
		add_modifier = { modifier = pdmethaneatmosphere days = -1 }
		#set_planet_entity = { picture = pc_methanehab }
		custom_tooltip = changehabatsomphereeffect
		hidden_effect = { 
			remove_modifier = pdammoniaatmosphere
			remove_modifier = pdashatmosphere
			if = {
				limit = { is_planet_class = pc_ringworld_habitable }
				set_planet_entity = { picture = pc_methanering entity = methanering_habitable_entity_01_entity }
			}
			if = {
				limit = { OR = { is_planet_class = pc_city is_planet_class = pc_ecocity } }
				set_planet_entity = { picture = pc_methanecity }
			}
		}
	}

	ai_weight = {
		weight = 1
	}
}

#Methane Hab (Colony)
decision_methanehabs = {
	owned_planets_only = yes
	sound = event_alien_nature_02
	icon = decision_methanehabs

	enactment_time = 360

	resources = {
		category = decisions
		cost = {
			energy = 1000
		}
	}

	potential = {
		OR = {
		is_planet_class = pc_habitat
		is_planet_class = pc_ringworld_habitable
		is_planet_class = pc_relic
		is_planet_class = pc_pd_barren_hab
		is_planet_class = pc_pd_barren_cold_hab
		is_planet_class = pc_pd_frozen_hab
		is_planet_class = pc_pd_molten_hab
		is_planet_class = pc_pd_hothouse_hab
		is_planet_class = pc_pd_toxic_hab
		is_planet_class = pc_pd_gas_giant_hab
		is_planet_class = pc_pd_asteroid_hab
		is_planet_class = pc_city
		is_planet_class = pc_ecocity
		}
		NOT = { has_modifier = pdmethaneatmosphere }
		owner = { has_trait = trait_pc_methane_preference }
	}

	allow = { 
	}

	effect = {
		add_modifier = { modifier = pdmethaneatmosphere days = -1 }
		#set_planet_entity = { picture = pc_methanehab }
		custom_tooltip = changehabatsomphereeffect
		hidden_effect = { 
			remove_modifier = pdammoniaatmosphere
			remove_modifier = pdashatmosphere
			if = {
				limit = { is_planet_class = pc_ringworld_habitable }
				set_planet_entity = { picture = pc_methanering entity = methanering_habitable_entity_01_entity }
			}
			if = {
				limit = { OR = { is_planet_class = pc_city is_planet_class = pc_ecocity } }
				set_planet_entity = { picture = pc_methanecity }
			}
		}
	}

	ai_weight = {
		weight = 1
	}
}

#Ash Hab (No Colony)
decision_ashhabsnocolony = {
	#owned_planets_only = no
	sound = event_alien_nature_02
	icon = decision_ashhabs

	#enactment_time = 180

	resources = {
		category = decisions
		cost = {
			energy = 1000
		}
	}

	potential = {
		has_owner = no
		OR = {
		is_planet_class = pc_habitat
		is_planet_class = pc_ringworld_habitable
		is_planet_class = pc_relic
		is_planet_class = pc_pd_barren_hab
		is_planet_class = pc_pd_barren_cold_hab
		is_planet_class = pc_pd_frozen_hab
		is_planet_class = pc_pd_molten_hab
		is_planet_class = pc_pd_hothouse_hab
		is_planet_class = pc_pd_toxic_hab
		is_planet_class = pc_pd_gas_giant_hab
		is_planet_class = pc_pd_asteroid_hab
		is_planet_class = pc_city
		is_planet_class = pc_ecocity
		}
		NOT = { has_modifier = pdashatmosphere }
		from = { has_trait = trait_pc_ash_preference }
	}

	allow = {
	}

	effect = {
		add_modifier = { modifier = pdashatmosphere days = -1 }
		#set_planet_entity = { picture = pc_ashhab }
		custom_tooltip = changehabatsomphereeffect
		hidden_effect = { 
			remove_modifier = pdammoniaatmosphere
			remove_modifier = pdmethaneatmosphere
			IF = {
				limit = { is_planet_class = pc_ringworld_habitable }
				set_planet_entity = { picture = pc_ashring entity = ashring_habitable_entity_01_entity }
			}
			if = {
				limit = { OR = { is_planet_class = pc_city is_planet_class = pc_ecocity } }
				set_planet_entity = { picture = pc_ashcity }
			}
		}
	}

	ai_weight = {
		weight = 1
	}
}

#Ash Hab (Colony)
decision_ashhabs = {
	owned_planets_only = yes
	sound = event_alien_nature_02
	icon = decision_ashhabs

	enactment_time = 360

	resources = {
		category = decisions
		cost = {
			energy = 1000
		}
	}

	potential = {
		OR = {
		is_planet_class = pc_habitat
		is_planet_class = pc_ringworld_habitable
		is_planet_class = pc_relic
		is_planet_class = pc_pd_barren_hab
		is_planet_class = pc_pd_barren_cold_hab
		is_planet_class = pc_pd_frozen_hab
		is_planet_class = pc_pd_molten_hab
		is_planet_class = pc_pd_hothouse_hab
		is_planet_class = pc_pd_toxic_hab
		is_planet_class = pc_pd_gas_giant_hab
		is_planet_class = pc_pd_asteroid_hab
		is_planet_class = pc_city
		is_planet_class = pc_ecocity
		}
		NOT = { has_modifier = pdashatmosphere }
		owner = { has_trait = trait_pc_ash_preference }
	}

	allow = { 
	}

	effect = {
		add_modifier = { modifier = pdashatmosphere days = -1 }
		#set_planet_entity = { picture = pc_ashhab }
		custom_tooltip = changehabatsomphereeffect
		hidden_effect = { 
			remove_modifier = pdammoniaatmosphere
			remove_modifier = pdmethaneatmosphere
			IF = {
				limit = { is_planet_class = pc_ringworld_habitable }
				set_planet_entity = { picture = pc_ashring entity = ashring_habitable_entity_01_entity }
			}
			if = {
				limit = { OR = { is_planet_class = pc_city is_planet_class = pc_ecocity } }
				set_planet_entity = { picture = pc_ashcity }
			}
		}
	}

	ai_weight = {
		weight = 1
	}
}

#Remove Exotic Hab (No Colony)
decision_noexoitchabsnocolony = {
	#owned_planets_only = yes
	sound = event_alien_nature_02
	icon = decision_noexoitchabs

	#enactment_time = 180

	resources = {
		category = decisions
		cost = {
			energy = 1000
		}
	}

	potential = {
		has_owner = no
		OR = {
		is_planet_class = pc_habitat
		is_planet_class = pc_ringworld_habitable
		is_planet_class = pc_relic
		is_planet_class = pc_pd_barren_hab
		is_planet_class = pc_pd_barren_cold_hab
		is_planet_class = pc_pd_frozen_hab
		is_planet_class = pc_pd_molten_hab
		is_planet_class = pc_pd_hothouse_hab
		is_planet_class = pc_pd_toxic_hab
		is_planet_class = pc_pd_gas_giant_hab
		is_planet_class = pc_pd_asteroid_hab
		is_planet_class = pc_city
		is_planet_class = pc_ecocity
		}
		OR = {
		has_modifier = pdammoniaatmosphere
		has_modifier = pdmethaneatmosphere
		has_modifier = pdashatmosphere
		}
		from = { 
			NOT = { 
				OR = {
					has_trait = trait_pc_ash_preference
					has_trait = trait_pc_methane_preference
					has_trait = trait_pc_ammonia_preference
				}
			}
		}
	}

	allow = {
	}

	effect = {
		custom_tooltip = changehabatsomphereeffect
		hidden_effect = { 
			remove_modifier = pdammoniaatmosphere
			remove_modifier = pdmethaneatmosphere
			remove_modifier = pdashatmosphere
			IF = {
				limit = { is_planet_class = pc_ringworld_habitable }
				set_planet_entity = { picture = pc_ringworld_habitable }
			}
			IF = {
				limit = { is_planet_class = pc_city }
				set_planet_entity = { picture = pc_city }
			}
			IF = {
				limit = { is_planet_class = pc_ecocity }
				set_planet_entity = { picture = pc_ecocity }
			}
		}
	}

	ai_weight = {
		weight = 1
	}
}

#No Exotic Hab (Colony)
decision_noexoitchabs = {
	owned_planets_only = yes
	sound = event_alien_nature_02
	icon = decision_noexoitchabs

	enactment_time = 360

	resources = {
		category = decisions
		cost = {
			energy = 1000
		}
	}

	potential = {
		OR = {
		is_planet_class = pc_habitat
		is_planet_class = pc_ringworld_habitable
		is_planet_class = pc_relic
		is_planet_class = pc_city
		is_planet_class = pc_ecocity
		is_planet_class = pc_pd_barren_hab
		is_planet_class = pc_pd_barren_cold_hab
		is_planet_class = pc_pd_frozen_hab
		is_planet_class = pc_pd_molten_hab
		is_planet_class = pc_pd_hothouse_hab
		is_planet_class = pc_pd_toxic_hab
		is_planet_class = pc_pd_gas_giant_hab
		is_planet_class = pc_pd_asteroid_hab
		}
		OR = {
		has_modifier = pdammoniaatmosphere
		has_modifier = pdmethaneatmosphere
		has_modifier = pdashatmosphere
		}
		owner = { 
			NOT = { 
				OR = {
					has_trait = trait_pc_ash_preference
					has_trait = trait_pc_methane_preference
					has_trait = trait_pc_ammonia_preference
				}
			}
		}
	}

	allow = { 
	}

	effect = {
		custom_tooltip = changehabatsomphereeffect
		hidden_effect = { 
			remove_modifier = pdammoniaatmosphere
			remove_modifier = pdmethaneatmosphere
			remove_modifier = pdashatmosphere
			IF = {
				limit = { is_planet_class = pc_ringworld_habitable }
				set_planet_entity = { picture = pc_ringworld_habitable }
			}
			IF = {
				limit = { is_planet_class = pc_city }
				set_planet_entity = { picture = pc_city }
			}
			IF = {
				limit = { is_planet_class = pc_ecocity }
				set_planet_entity = { picture = pc_ecocity }
			}
		}
	}

	ai_weight = {
		weight = 1
	}
}



