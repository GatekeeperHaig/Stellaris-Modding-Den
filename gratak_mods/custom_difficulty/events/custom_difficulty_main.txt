namespace = custom_difficulty

#advanced menu
country_event = {
  id = custom_difficulty.0
  is_triggered_only = yes
  title = custom_difficulty.0.name
  picture = "GFX_evt_towel"
  desc = {
    trigger = {
      success_text = {
        text = custom_difficulty.0.desc
        not = { has_global_flag = custom_difficulty_locked }
      }
      success_text = {
        text = custom_difficulty.0.lock.desc
        has_global_flag = custom_difficulty_locked
      }
    }
  }
  option = {
    name = custom_difficulty.predefined_difficulties
    hidden_effect = {
      country_event = { id = custom_difficulty.1 }
    }
  }
  option = {
    name = custom_difficulty_ai.name
    trigger = {
      not = { has_global_flag = custom_difficulty_locked }
    }
    hidden_effect = {
      country_event = { id = custom_difficulty.1000 }
    }
  }
  option = {
    name = custom_difficulty_ai_yearly.name
    trigger = {
      not = { has_global_flag = custom_difficulty_locked }
    }
    hidden_effect = {
      country_event = { id = custom_difficulty.2000 }
    }
  }
  option = {
    name = custom_difficulty_fe.name
    trigger = {
      not = { has_global_flag = custom_difficulty_locked }
    }
    hidden_effect = {
      country_event = { id = custom_difficulty.3000 }
    }
  }
  option = {
    name = custom_difficulty_leviathan.name
    trigger = {
      not = { has_global_flag = custom_difficulty_locked }
    }
    hidden_effect = {
      country_event = { id = custom_difficulty.4000 }
    }
  }
  option = {
    name = custom_difficulty_player.name
    trigger = {
      not = { has_global_flag = custom_difficulty_locked }
    }
    hidden_effect = {
      country_event = { id = custom_difficulty.5000 }
    }
  }
  option = {
    name = custom_difficulty.0.lock.name
    desc = custom_difficulty.0.lock.desc
    trigger = {
      not = { has_global_flag = custom_difficulty_locked }
    }
    hidden_effect = {
      country_event = { id = custom_difficulty.9999 }
      country_event = { id = custom_difficulty.9 }
    }
  }
  option = {
    name = custom_difficulty.0.unlock.name
    hidden_effect = {
      country_event = { id = custom_difficulty.9999 }
      remove_global_flag = custom_difficulty_locked
    }
  }
  #option = {
    #name = custom_difficulty.back
  #  hidden_effect = {
  #    country_event = { id = custom_difficulty.1 }
  #  }
  #}
  option = {
    name = close_custom_difficulty.name
    hidden_effect = {
      country_event = { id = custom_difficulty.9999 }
    }
  }
}

#main menu
country_event = {
  id = custom_difficulty.1
  is_triggered_only = yes
  title = custom_difficulty.1.name
  picture = "GFX_evt_towel"
  desc = {
    trigger = {
      #success_text = {
      #  text = custom_difficulty.0.desc
      #  not = { has_global_flag = custom_difficulty_locked }
      #}
      success_text = {
        text = custom_difficulty.0.locked.desc
        has_global_flag = custom_difficulty_locked
      }
      text = custom_difficulty_currently_active
      success_text = {
        text = custom_difficulty_advanced_configuration_player.name
        has_global_flag = custom_difficulty_advanced_configuration_player
      }
      success_text = {
        text = custom_difficulty_easy.name
        has_global_flag = custom_difficulty_easy
      }
      success_text = {
        text = custom_difficulty_ensign.name
        has_global_flag = custom_difficulty_ensign
      }
      success_text = {
        text = custom_difficulty_captain.name
        has_global_flag = custom_difficulty_captain
      }
      success_text = {
        text = custom_difficulty_admiral.name
        has_global_flag = custom_difficulty_admiral
      }
      success_text = {
        text = custom_difficulty_grand_admiral.name
        has_global_flag = custom_difficulty_grand_admiral
      }
      success_text = {
        text = custom_difficulty_scaling.name
        has_global_flag = custom_difficulty_scaling
      }
      success_text = {
        text = custom_difficulty_advanced_configuration.name
        has_global_flag = custom_difficulty_advanced_configuration
      }
      text= custom_difficulty_choose
    }
  }

  option = {
    name = custom_difficulty_easy.name
    trigger = {
      not = { has_global_flag = custom_difficulty_locked }
    }
    hidden_effect = {
      country_event = { id = custom_difficulty.10 }
      country_event = { id = custom_difficulty.1 }
    }
  }
  option = {
    name = custom_difficulty_ensign.name
    trigger = {
      not = { has_global_flag = custom_difficulty_locked }
    }
    hidden_effect = {
      country_event = { id = custom_difficulty.11 }
      country_event = { id = custom_difficulty.1 }
    }
  }
  option = {
    name = custom_difficulty_captain.name
    trigger = {
      not = { has_global_flag = custom_difficulty_locked }
    }
    hidden_effect = {
      country_event = { id = custom_difficulty.12 }
      country_event = { id = custom_difficulty.1 }
    }
  }
  option = {
    name = custom_difficulty_commodore.name
    trigger = {
      not = { has_global_flag = custom_difficulty_locked }
    }
    hidden_effect = {
      country_event = { id = custom_difficulty.13 }
      country_event = { id = custom_difficulty.1 }
    }
  }
  option = {
    name = custom_difficulty_admiral.name
    trigger = {
      not = { has_global_flag = custom_difficulty_locked }
    }
    hidden_effect = {
      country_event = { id = custom_difficulty.14 }
      country_event = { id = custom_difficulty.1 }
    }
  }
  option = {
    name = custom_difficulty_grand_admiral.name
    trigger = {
      not = { has_global_flag = custom_difficulty_locked }
    }
    hidden_effect = {
      country_event = { id = custom_difficulty.15 }
      country_event = { id = custom_difficulty.1 }
    }
  }
  option = {
    name = custom_difficulty_scaling.name
    trigger = {
      not = { has_global_flag = custom_difficulty_locked }
    }
    hidden_effect = {
      country_event = { id = custom_difficulty.16 }
      country_event = { id = custom_difficulty.1 }
    }
  }
  option = {
   # name = custom_difficulty_advanced_configuration.name
    name = custom_difficulty.back
    trigger = {
      not = { has_global_flag = custom_difficulty_locked }
    }
    hidden_effect = {
      country_event = { id = custom_difficulty.0 }
    }
  }
  #option = {
  #  name = custom_difficulty_reset.name
  #  trigger = {
  #    not = { has_global_flag = custom_difficulty_locked }
  #  }
  #  hidden_effect = {
  #    country_event = { id = custom_difficulty.8 }
  #  }
  #}
  option = {
    name = close_custom_difficulty.name
    hidden_effect = {
      country_event = { id = custom_difficulty.9999 }
    }
  }
}

#game start init
country_event = {
  id = custom_difficulty.2
  #is_triggered_only = yes
  fire_only_once = yes
  hide_window = yes
  trigger = {
    is_ai = no
  }
  immediate = {
    set_global_flag = custom_difficulty_active
    random_planet = {
      save_global_event_target_as = custom_difficulty_var_storage
    }
    if = {
      limit = {
        is_difficulty = 0
      }
      country_event = { id = custom_difficulty.11 }
    }
    if = {
      limit = {
        is_difficulty = 2
      }
      country_event = { id = custom_difficulty.12 }
    }
    if = {
      limit = {
        is_difficulty = 3
      }
      country_event = { id = custom_difficulty.13 }
    }
    if = {
      limit = {
        is_difficulty = 4
      }
      country_event = { id = custom_difficulty.14 }
    }
    if = {
      limit = {
        is_difficulty = 5
      }
      country_event = { id = custom_difficulty.15 }
    }
    if = {
      limit = {
        is_difficulty = 1
      }
      country_event = { id = custom_difficulty.16 }
    }
  }
}


#lock confirmation
country_event = {
  id = custom_difficulty.9
  is_triggered_only = yes
  title = custom_difficulty.0.lock.name
  desc = custom_difficulty.0.lock.desc
  picture = "GFX_evt_towel"
  option = {
    name = OK
    hidden_effect = {
      set_global_flag = custom_difficulty_locked
    }
  }
  option = {
    name = custom_difficulty.cancel
    hidden_effect = {
      country_event = { id = custom_difficulty.0 }
    }
  }
}

#reset confirmation. does not work as .2 is fire_only_once
country_event = {
  id = custom_difficulty.8
  is_triggered_only = yes
  title = custom_difficulty_reset_conf.name
  desc = custom_difficulty_reset.desc
  picture = "GFX_evt_towel"
  option = {
    name = OK
    hidden_effect = {
      country_event = { id = custom_difficulty.99 }
      country_event = { id = custom_difficulty.2 }
      country_event = { id = custom_difficulty.1 }
    }
  }
  option = {
    name = custom_difficulty.cancel
    hidden_effect = {
      country_event = { id = custom_difficulty.1 }
    }
  }
}

#todo: Update modifiers
country_event = {
  id = custom_difficulty.9999
  is_triggered_only = yes
  hide_window = yes
}

#reset all flags
country_event = {
  id = custom_difficulty.99
  is_triggered_only = yes
  hide_window = yes
  immediate = {
    remove_global_flag = custom_difficulty_easy
    remove_global_flag = custom_difficulty_ensign
    remove_global_flag = custom_difficulty_captain
    remove_global_flag = custom_difficulty_commodore
    remove_global_flag = custom_difficulty_admiral
    remove_global_flag = custom_difficulty_grand_admiral
    remove_global_flag = custom_difficulty_scaling
    remove_global_flag = custom_difficulty_advanced_configuration
    remove_global_flag = custom_difficulty_advanced_configuration_player
  }
}
#reset flags_non_player
country_event = {
  id = custom_difficulty.98
  is_triggered_only = yes
  hide_window = yes
  immediate = {
    remove_global_flag = custom_difficulty_ensign
    remove_global_flag = custom_difficulty_captain
    remove_global_flag = custom_difficulty_commodore
    remove_global_flag = custom_difficulty_admiral
    remove_global_flag = custom_difficulty_grand_admiral
    remove_global_flag = custom_difficulty_scaling
    remove_global_flag = custom_difficulty_advanced_configuration
  }
}
#reset flags player
country_event = {
  id = custom_difficulty.97
  is_triggered_only = yes
  hide_window = yes
  immediate = {
    remove_global_flag = custom_difficulty_easy
    remove_global_flag = custom_difficulty_advanced_configuration_player
  }
}
