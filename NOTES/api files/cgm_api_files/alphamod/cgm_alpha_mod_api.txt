check_planet_bonus_buildings_am = {
	if = {
		limit = { has_building = building_energy_market }
		change_variable = { which = minerals_mult_planet_base value = -0.1 }
		change_variable = { which = food_mult_planet_base value = -0.1 }
	}
	if = {
		limit = { has_building = building_mineral_transformer }
		change_variable = { which = minerals_mult_planet_base value = 0.1 }
	}
	if = {
		limit = { has_building = building_powerbank }
		change_variable = { which = energy_mult_planet_base value = 0.1 }
	}
	if = {
		limit = { has_building = building_comms_hub }
		change_variable = { which = unity_mult_planet_base value = 0.05 }
	}
	if = {
		limit = { has_building = building_gravitic_comms_array }
		change_variable = { which = society_research_mult_planet_base value = 0.05 }
		change_variable = { which = engineering_research_mult_planet_base value = 0.05 }
		change_variable = { which = unity_mult_planet_base value = 0.05 }
	}
	if = {
		limit = { has_building = building_subspace_comms_array }
		change_variable = { which = society_research_mult_planet_base value = 0.05 }
		change_variable = { which = engineering_research_mult_planet_base value = 0.05 }
		change_variable = { which = unity_mult_planet_base value = 0.1 }
	}	
	if = {
		limit = { has_building = building_state_media }
		change_variable = { which = unity_mult_planet_base value = 0.1 }
	}
	if = {
		limit = { has_building = building_genetic_data }
		change_variable = { which = society_research_mult_planet_base value = 0.1 }
	}
	if = {
		limit = { has_building = building_templeofrule }
		change_variable = { which = unity_mult_planet_base value = 0.05 }
	}	
	if = {
		limit = { has_building = building_water_distributor }
		change_variable = { which = food_mult_planet_base value = 0.1 }
	}	
	if = {
		limit = { has_building = building_water_treatment }
		change_variable = { which = food_mult_planet_base value = 0.1 }
	}	
	if = {
		limit = { has_building = building_reservoir_2 }
		change_variable = { which = food_mult_planet_base value = 0.05 }
	}	
	if = {
		limit = { has_building = building_reservoir_3 }
		change_variable = { which = food_mult_planet_base value = 0.1 }
	}	
	if = {
		limit = { has_building = building_apex_city }
		change_variable = { which = society_research_mult_planet_base value = 0.1 }
		change_variable = { which = engineering_research_mult_planet_base value = 0.1 }
		change_variable = { which = physics_research_mult_planet_base value = 0.1 }
	}
}	

check_neighboring_adj_bonus_buildings_am = {
	every_neighboring_tile = {
		limit = { has_building = building_colony_control_pre }
		prevprev = {
			change_variable = { which = food_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_colony_control }
		prevprev = {
			change_variable = { which = food_weight value = 1 }
			change_variable = { which = minerals_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_colony_control2 }
		prevprev = {
			change_variable = { which = food_weight value = 1 }
			change_variable = { which = minerals_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_hall_of_assignment }
		prevprev = {
			change_variable = { which = food_weight value = 1 }
			change_variable = { which = minerals_weight value = 1 }
			change_variable = { which = energy_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_power_plant_collective }
		prevprev = {
			change_variable = { which = energy_weight value = 2 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_work_collective }
		prevprev = {
			change_variable = { which = food_weight value = 1 }
			change_variable = { which = minerals_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_great_order_1 }
		prevprev = {
			change_variable = { which = unity_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_great_order_2 }
		prevprev = {
			change_variable = { which = unity_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_monastery_of_knowledge }
		prevprev = {
			change_variable = { which = society_research_weight value = 1 }
		}
	}	
	every_neighboring_tile = {
		limit = { has_building = building_science_foundation }
		prevprev = {
			change_variable = { which = engineering_research_weight value = 2 }
			change_variable = { which = physics_research_weight value = 1 }
			change_variable = { which = society_research_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_cantina }
		prevprev = {
			change_variable = { which = unity_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_radio_telescope_array }
		prevprev = {
			change_variable = { which = physics_research_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_radio_telescope_array_2 }
		prevprev = {
			change_variable = { which = physics_research_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_radio_telescope_array_3 }
		prevprev = {
			change_variable = { which = physics_research_weight value = 1.5 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_radio_telescope_array_4 }
		prevprev = {
			change_variable = { which = physics_research_weight value = 2 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_exo_ops }
		prevprev = {
			change_variable = { which = minerals_weight value = 1 }
			change_variable = { which = food_weight value = 1 }
			change_variable = { which = energy_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_exo_power_plant2 }
		prevprev = {
			change_variable = { which = energy_weight value = 0.5 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_exo_power_plant3 }
		prevprev = {
			change_variable = { which = energy_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_exo_ops }
		prevprev = {
			change_variable = { which = minerals_weight value = 1 }
			change_variable = { which = food_weight value = 1 }
			change_variable = { which = energy_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_exo_power_plant2 }
		prevprev = {
			change_variable = { which = energy_weight value = 0.5 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_exo_power_plant3 }
		prevprev = {
			change_variable = { which = energy_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_desalinator }
		prevprev = {
			change_variable = { which = food_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_moisture_farm }
		prevprev = {
			change_variable = { which = food_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_moisture_farm_2 }
		prevprev = {
			change_variable = { which = food_weight value = 1.5 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_moisture_farm_3 }
		prevprev = {
			change_variable = { which = food_weight value = 2 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_solar_power_plant }
		prevprev = {
			change_variable = { which = energy_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_governerspalace }
		prevprev = {
			change_variable = { which = food_weight value = 1 }
			change_variable = { which = minerals_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_templeofrule }
		prevprev = {
			change_variable = { which = food_weight value = 1 }
			change_variable = { which = minerals_weight value = 1 }
			change_variable = { which = unity_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_libraryofadministration }
		prevprev = {
			change_variable = { which = food_weight value = 1 }
			change_variable = { which = minerals_weight value = 1 }
			change_variable = { which = engineering_research_weight value = 1 }
			change_variable = { which = physics_research_weight value = 1 }
			change_variable = { which = society_research_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_chamberofexecutives }
		prevprev = {
			change_variable = { which = food_weight value = 1 }
			change_variable = { which = minerals_weight value = 1 }
			change_variable = { which = energy_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_chamberofexecutives_2 }
		prevprev = {
			change_variable = { which = food_weight value = 1 }
			change_variable = { which = minerals_weight value = 1 }
			change_variable = { which = energy_weight value = 1.5 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_hallofwarriors }
		prevprev = {
			change_variable = { which = food_weight value = 1 }
			change_variable = { which = minerals_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_councilhall }
		prevprev = {
			change_variable = { which = food_weight value = 1 }
			change_variable = { which = minerals_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_actinides_mine }
		prevprev = {
			change_variable = { which = energy_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_garden_construction }
		prevprev = {
			change_variable = { which = unity_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_biomass_furnace }
		prevprev = {
			change_variable = { which = energy_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_biomass_filtrator }
		prevprev = {
			change_variable = { which = food_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_biomass_filtrator_2 }
		prevprev = {
			change_variable = { which = food_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_fuel_refinery_0 }
		prevprev = {
			change_variable = { which = energy_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_fuel_refinery }
		prevprev = {
			change_variable = { which = energy_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_fuel_refinery_2 }
		prevprev = {
			change_variable = { which = energy_weight value = 1.5 }
			change_variable = { which = minerals_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_adv_natfuels_processor }
		prevprev = {
			change_variable = { which = energy_weight value = 1.5 }
			change_variable = { which = minerals_weight value = 1.5 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_water_distributor }
		prevprev = {
			change_variable = { which = food_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_reservoir }
		prevprev = {
			change_variable = { which = food_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_reservoir_2 }
		prevprev = {
			change_variable = { which = food_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_reservoir_3 }
		prevprev = {
			change_variable = { which = food_weight value = 1.5 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_water_excavator }
		prevprev = {
			change_variable = { which = food_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_water_excavator_2 }
		prevprev = {
			change_variable = { which = food_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_wet_farm }
		prevprev = {
			change_variable = { which = food_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_large_city }
		prevprev = {
			change_variable = { which = energy_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_building = building_jewel_city }
		prevprev = {
			change_variable = { which = energy_weight value = 2 }
		}
	}	
}

check_adj_bonus_blockers_am = {
	every_neighboring_tile = {
		limit = { has_blocker = tb_gas_storm }
		prevprev = {
			change_variable = { which = energy_weight value = 2 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_extreme_pressure }
		prevprev = {
			change_variable = { which = engineering_research_weight value = 1 }
			change_variable = { which = physics_research_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_atmospheric_vortex }
		prevprev = {
			change_variable = { which = engineering_research_weight value = 1 }
			change_variable = { which = energy_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_concentrated_acids }
		prevprev = {
			change_variable = { which = engineering_research_weight value = 1 }
			change_variable = { which = society_research_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_molten_rivers }
		prevprev = {
			change_variable = { which = energy_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_molten_plains }
		prevprev = {
			change_variable = { which = energy_weight value = 1 }
			change_variable = { which = minerals_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_molten_sea }
		prevprev = {
			change_variable = { which = energy_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_wild_crops }
		prevprev = {
			change_variable = { which = food_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_wild_crops_locked }
		prevprev = {
			change_variable = { which = food_weight value = 2 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_toxic_kelp_locked }
		prevprev = {
			change_variable = { which = society_research_weight value = 2 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_noxious_swamp_locked }
		prevprev = {
			change_variable = { which = society_research_weight value = 2 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_dangerous_wildlife_locked }
		prevprev = {
			change_variable = { which = food_weight value = 1 }
			change_variable = { which = society_research_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_ancient_forest_locked }
		prevprev = {
			change_variable = { which = society_research_weight value = 2 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_dense_jungle_locked }
		prevprev = {
			change_variable = { which = society_research_weight value = 2 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_active_volcano_locked }
		prevprev = {
			change_variable = { which = energy_weight value = 2 }
			change_variable = { which = engineering_research_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_massive_glacier_locked }
		prevprev = {
			change_variable = { which = engineering_research_weight value = 2 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_alpine_forest }
		prevprev = {
			change_variable = { which = society_research_weight value = 2 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_ancient_forest }
		prevprev = {
			change_variable = { which = society_research_weight value = 2 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_alpha_mountain_range }
		prevprev = {
			change_variable = { which = minerals_weight value = 2 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_alpha_ice_cap }
		prevprev = {
			change_variable = { which = engineering_research_weight value = 1 }
			change_variable = { which = physics_research_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_alpha_volcano_chain }
		prevprev = {
			change_variable = { which = energy_weight value = 2 }
			change_variable = { which = engineering_research_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_alpha_ocean_vortex }
		prevprev = {
			change_variable = { which = energy_weight value = 1 }
			change_variable = { which = engineering_research_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_massive_caverns }
		prevprev = {
			change_variable = { which = minerals_weight value = 1 }
			change_variable = { which = engineering_research_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_ancient_ruins }
		prevprev = {
			change_variable = { which = society_research_weight value = 1 }
			change_variable = { which = engineering_research_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_jungle_riches }
		prevprev = {
			change_variable = { which = society_research_weight value = 1 }
			change_variable = { which = food_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_jurrasic_valley }
		prevprev = {
			change_variable = { which = society_research_weight value = 2 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_geothermal_springs }
		prevprev = {
			change_variable = { which = energy_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_great_oasis }
		prevprev = {
			change_variable = { which = food_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_mountain_range }
		prevprev = {
			change_variable = { which = minerals_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_active_volcano }
		prevprev = {
			change_variable = { which = energy_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_dangerous_wildlife }
		prevprev = {
			change_variable = { which = society_research_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_dense_jungle }
		prevprev = {
			change_variable = { which = society_research_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_quicksand_basin }
		prevprev = {
			change_variable = { which = engineering_research_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_noxious_swamp }
		prevprev = {
			change_variable = { which = society_research_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_massive_glacier }
		prevprev = {
			change_variable = { which = engineering_research_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_toxic_kelp }
		prevprev = {
			change_variable = { which = society_research_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_deep_sinkhole }
		prevprev = {
			change_variable = { which = minerals_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_radioactive_wasteland }
		prevprev = {
			change_variable = { which = physics_research_weight value = 2 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_city_ruins }
		prevprev = {
			change_variable = { which = society_research_weight value = 1 }
			change_variable = { which = engineering_research_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_slums }
		prevprev = {
			change_variable = { which = minerals_weight value = 1 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_tribal_settlement }
		prevprev = {
			change_variable = { which = society_research_weight value = 2 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_wandering_forest_reserve }
		prevprev = {
			change_variable = { which = society_research_weight value = 3 }
		}
	}
	every_neighboring_tile = {
		limit = { has_blocker = tb_failing_infrastructure }
		prevprev = {
			change_variable = { which = engineering_research_weight value = 1 }
		}
	}	
}

check_planet_modifiers_am = {
	if = {
		limit = { has_modifier = gas_isnot_minerals }
		change_variable = { which = minerals_mult value = -1.0 }
	}
	if = {
		limit = { has_modifier = no_ring_mining }
		change_variable = { which = minerals_mult value = -0.75 }
	}
	if = {
		limit = { has_modifier = hard_ring_mining }
		change_variable = { which = minerals_mult value = -0.2 }
	}
	if = {
		limit = { has_modifier = some_ring_mining }
		change_variable = { which = minerals_mult value = 0.05 }
	}
	if = {
		limit = { has_modifier = easy_ring_mining }
		change_variable = { which = minerals_mult value = 0.1 }
	}
	if = {
		limit = { has_modifier = toxic_atmosphere }
		change_variable = { which = food_mult value = -0.25 }
	}
	if = {
		limit = { has_modifier = natural_refinery }
		change_variable = { which = minerals_mult value = 0.2 }
	}
	if = {
		limit = { has_modifier = very_hot }
		change_variable = { which = energy_mult value = 0.2 }
	}
	if = {
		limit = { has_modifier = very_cold }
		change_variable = { which = food_mult value = -0.25 }
	}
	if = {
		limit = { has_modifier = bioscience_paradise }
		change_variable = { which = society_research_mult value = 0.2 }
	}
	if = {
		limit = { has_modifier = volcanic_atmosphere }
		change_variable = { which = food_mult value = -0.25 }
	}
	if = {
		limit = { has_modifier = zero_gravity }
		change_variable = { which = engineering_research_mult value = 0.1 }
		change_variable = { which = food_mult value = -0.25 }
	}
	if = {
		limit = { has_modifier = engineers_paradise }
		change_variable = { which = engineering_research_mult value = 0.25 }
	}
	if = {
		limit = { has_modifier = underground_caverns }
		change_variable = { which = minerals_mult value = 0.1 }
	}
	if = {
		limit = { has_modifier = physicists_paradise }
		change_variable = { which = physics_research_mult value = 0.25 }
	}
	if = {
		limit = { has_modifier = alpha_doming }
		change_variable = { which = energy_mult value = -0.1 }
	}	
	if = {
		limit = { has_modifier = ex_asteroid }
		change_variable = { which = minerals_mult value = -0.5 }
	}	
	if = {
		limit = { has_modifier = satellite_network }
		change_variable = { which = unity_mult value = 0.1 }
	}	
}

check_pop_traits_am = {
	if = { 
		limit = { is_robot_pop = no }
		if = { 
			limit = { has_trait = "trait_high_metabolism" }
			prev = {
				change_variable = { which = energy_mult_planet_pop value = 0.05 }
				change_variable = { which = minerals_mult_planet_pop value = 0.05 }
			}	
		}
		if = { 
			limit = { has_trait = "trait_slow_metabolism" }
			prev = {
				change_variable = { which = minerals_mult_planet_pop value = -0.1 }
			}	
		}		
		else = {
			if = { 
				limit = { has_trait = "trait_robot_multi_tools" }
				prev = {
					change_variable = { which = minerals_mult_planet_pop value = 0.1 }
					change_variable = { which = food_mult_planet_pop value = 0.1 }
				}	
			}	
		}	
	}
}	
