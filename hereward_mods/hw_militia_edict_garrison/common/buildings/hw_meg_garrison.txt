building_garrison = {
	base_buildtime = 180
	is_listed = yes
	defense_armies = 1
	protects_from_bombardment = no

	planetary_ftl_inhibitor = no

	potential = {
		planet = {
			NOT = { is_planet_class = pc_habitat }
		}
	}

	prerequisites = {
		"tech_planetary_defenses"
	}

	cost = {
		minerals = 100
	}

	produced_resource_trigger = {
		modifier = {
			has_valid_civic = civic_citizen_service
			resources = {
				unity = 1
			}
		}
	}

	produced_resources = {
		unity = 1
	}

	required_resources = {
		energy = 1
	}

	upgrades = {
		building_stronghold
	}

	planet_modifier = {
		planet_unrest_add = -10
	}

	ai_weight = {
		weight = 1000
		modifier = {
			factor = 0
			years_passed < 10
		}
		modifier = {
			factor = 0
			planet = {
				unrest < 50
				sector_controlled = yes
				owner = { is_ai = no }
			}
			NOR = {
				has_building = "building_garrison"
				has_building = "building_stronghold"
				has_building = "building_fortress"
			}
		}
		modifier = {
			factor = 0
			planet = {
				NOR = {
					unrest > 50
					AND = {
						planet_size > 12
						OR = {
							has_building = "building_capital_1"
							has_building = "building_capital_2"
							has_building = "building_capital_3"
							has_building = "building_machine_capital_1"
							has_building = "building_machine_capital_2"
							has_building = "building_machine_capital_3"
						}
					}
				}
			}
		}
		modifier = {
			factor = 0
			planet = {
				NOR = {
					unrest > 50
					AND = {
						planet_size > 16
						OR = {
							has_building = "building_capital_2"
							has_building = "building_capital_3"
							has_building = "building_machine_capital_2"
							has_building = "building_machine_capital_3"
						}
					}
				}
				count_tile = {
					limit = {
						OR = {
							has_building = building_garrison
							has_building = building_stronghold
							has_building = building_fortress
						}
					}
					count > 0
				}
			}
		}
		modifier = {
			factor = 0
			planet = {
				NOR = {
					unrest > 50
					AND = {
						planet_size > 20
						OR = {
							has_building = "building_capital_2"
							has_building = "building_capital_3"
							has_building = "building_machine_capital_2"
							has_building = "building_machine_capital_3"
						}
					}
				}
				count_tile = {
					limit = {
						OR = {
							has_building = building_garrison
							has_building = building_stronghold
							has_building = building_fortress
						}
					}
					count > 1
				}
			}
		}
		modifier = {
			factor = 0
			planet = {
				count_tile = {
					limit = {
						OR = {
							has_building = building_garrison
							has_building = building_stronghold
							has_building = building_fortress
						}
					}
					count > 2
				}
			}
		}
	}
}
