namespace = ex_new_worlds_spawn_engine

event = { #this event triggers on game start and monthly pulse
	id = ex_new_worlds_spawn_engine.0
	hide_window = yes
	is_triggered_only = yes
	fire_only_once = yes
	
	#This event fires only once.
		
	immediate = {		
		ex_new_worlds_add_planet_pref_traits = yes
		every_planet = { 
			limit = { 
				is_star = no
				solar_system = { starting_system = no }
			}	
			if = {
				limit = {
					is_planet_class = pc_gas_giant 
					has_moon = yes
				}
				every_moon = { set_planet_flag = gas_giant_moon }
			}			
		}	
		every_planet = {
			limit = {
				is_star = no
				solar_system = { starting_system = no }
				is_capital = no
				is_homeworld = no
			}	
			solar_system = { 
				random_planet = { limit = { is_star = yes } set_star_flag = star_1 save_event_target_as = system_star_1 } 
				if = {
					limit = { has_global_flag = real_space }
					if = {
						limit = { any_planet = { is_star = yes NOT = { has_star_flag = star_1 } } }
						random_planet = { limit = { is_star = yes NOT = { has_star_flag = star_1 } } set_star_flag = star_2 save_event_target_as = system_star_2 } 
					}	
					if = {
						limit = { any_planet = { is_star = yes NOR = { has_star_flag = star_1 has_star_flag = star_2 } } }
						random_planet = { limit = { is_star = yes NOR = { has_star_flag = star_1 has_star_flag = star_2 } } set_star_flag = star_3 save_event_target_as = system_star_3 } 
					}	
				}			
			}			
			if = {
				limit = { is_vanilla_uninhabitable_planet = yes	}
				ex_new_worlds_uninhabitable_planets_spawn_table = yes
			}	
			if = {
				limit = { is_vanilla_habitable_planet = yes	}
				ex_new_worlds_habitable_planets_spawn_table = yes				
			}	
		}	
	}
}