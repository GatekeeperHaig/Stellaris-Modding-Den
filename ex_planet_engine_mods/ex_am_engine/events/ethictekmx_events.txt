namespace = ethictekmx_events

planet_event = {
	id = ethictekmx_events.10
	hide_window = yes
	
	is_triggered_only = yes
	location = root
	
	trigger = {
		from = {
			or = {
				has_building = "building_dry_dock"
				has_building = "building_dry_dock_2"
			}
		}
	}
	
	immediate = {
		owner = {
			if = {
				limit = { 
					not = { has_technology = tech_starbase_2 }
				}
				give_technology = { message = yes tech = tech_starbase_2 }
			}
			if = {
				limit = { 
					not = { has_technology = tech_corvettes }
				}
				give_technology = { message = yes tech = tech_corvettes }
			}
			if = {
				limit = { 
					not = { has_technology = tech_destroyers }
				}
				give_technology = { message = yes tech = tech_destroyers }
			}
			if = {
				limit = { 
					not = { has_technology = tech_cruisers }
				}
				give_technology = { message = yes tech = tech_cruisers }
			}
			if = {
				limit = { 
					not = { has_technology = tech_battleships }
				}
				add_research_option = tech_battleships
			}
		}
	}
}

event = {
	id = ethictekmx_events.40

	is_triggered_only = yes
	hide_window = yes
	
	location = root
	
	trigger = {
		from = {
			has_prev_building = "building_warrior_house"
		}
	}
	
	immediate = {
		if = {
			limit = {
				this = {
					has_planet_flag = pf_warrior_house_1
				}
			}
			this = {
				remove_planet_flag = pf_warrior_house_1
				owner = {
					change_variable = {
						which = "cv_warriorhousetotal" 
						value = -1
					}
					country_event = { id = ethictekmx_events.2 }
				}
			}
		}
		if = {
			limit = {
				this = {
					has_planet_flag = pf_warrior_house_2
				}
			}
			this = {
				remove_planet_flag = pf_warrior_house_2
				set_planet_flag = pf_warrior_house_1
				owner = {
					change_variable = {
						which = "cv_warriorhousetotal" 
						value = -1
					}
					country_event = { id = ethictekmx_events.2 }
				}
			}			
		}
	}
}

# # Retroactive warriorhouse fix
# planet_event = {
	# id = ethictekmx_events.1
	# hide_window = yes
	
	# trigger = {
		# not = { has_planet_flag = warriorhousecheck }
		# has_owner = yes
		# or = {
			# has_planet_flag = pf_warrior_house_1
			# has_planet_flag = pf_warrior_house_2
		# }
	# }
	
	# immediate = {
		# set_planet_flag = warriorhousecheck
		# if = {
			# limit = { has_planet_flag = pf_warrior_house_1 }
			# owner = {
				# change_variable = {
					# which = "cv_warriorhousetotal" 
					# value = 1
				# }
			# }
		# }
		# if = {
			# limit = { has_planet_flag = pf_warrior_house_2 }
			# owner = {
				# change_variable = {
					# which = "cv_warriorhousetotal" 
					# value = 2
				# }	
			# }
		# }
		# owner = {
			# country_event = { id = ethictekmx_events.2 }
		# }
	# }
# }

country_event = {
	id = ethictekmx_events.2
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		remove_modifier = warriorhouses_5
		remove_modifier = warriorhouses_10
		remove_modifier = warriorhouses_15
		remove_modifier = warriorhouses_20
		if = {
			limit = {
				 check_variable = {
					which = "cv_warriorhousetotal" 
					value > 4
				}
				 check_variable = {
					which = "cv_warriorhousetotal" 
					value < 10
				}
			}
			add_modifier = {
				modifier = warriorhouses_5
				days = -1
			}
		}
		if = {
			limit = {
				 check_variable = {
					which = "cv_warriorhousetotal" 
					value > 9
				}
				 check_variable = {
					which = "cv_warriorhousetotal" 
					value < 15
				}
			}
			add_modifier = {
				modifier = warriorhouses_10
				days = -1
			}
		}
		if = {
			limit = {
				 check_variable = {
					which = "cv_warriorhousetotal" 
					value > 14
				}
				 check_variable = {
					which = "cv_warriorhousetotal" 
					value < 20
				}
			}
			add_modifier = {
				modifier = warriorhouses_15
				days = -1
			}
		}
		if = {
			limit = {
				 check_variable = {
					which = "cv_warriorhousetotal" 
					value > 19
				}
			}
			add_modifier = {
				modifier = warriorhouses_20
				days = -1
			}
		}
	}
}