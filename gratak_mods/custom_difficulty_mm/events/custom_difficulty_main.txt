 # This file was created by script!
 # Instead of editing it, you should change the python script.
 # Changes to the file will be overwritten the next time the script is run.
namespace = custom_difficulty
 #main menu
country_event = {
	id = custom_difficulty.0
	is_triggered_only = yes
	title = edict_custom_difficulty
	picture = GFX_evt_synth_sabotage
	immediate = { country_event = { id = custom_difficulty_mm.23 } }
	desc = {
		trigger = {
			fail_text = {
				text = custom_difficulty_choose_desc
				custom_difficulty_allow_changes = no
			}
			success_text = {
				text = custom_difficulty_locked.desc
				custom_difficulty_allow_changes = no
			}
		}
	}
	option = {
		name = custom_difficulty_options.name
		hidden_effect = { country_event = { id = custom_difficulty.3 } }
	}
	option = {
		name = custom_difficulty_mainMenuMM.name
		trigger = { has_global_flag = custom_difficultyMM_active }
		hidden_effect = { country_event = { id = custom_difficulty_mm.1 } }
	}
	option = {
		name = custom_difficulty_close.name
		hidden_effect = {
			country_event = { id = custom_difficulty.41 }
			if = {
				limit = { has_global_flag = custom_difficultyMM_active }
				country_event = { id = custom_difficulty_mm.2 }
			}
		}
	}
}
 #options Event
country_event = {
	id = custom_difficulty.3
	is_triggered_only = yes
	title = custom_difficulty_options.name
	picture = GFX_evt_towel
	desc = {
		trigger = {
			success_text = {
				text = custom_difficulty_locked.desc
				custom_difficulty_allow_changes = no
			}
			text = custom_difficulty_current_options
			success_text = {
				text = custom_difficulty_activate_edict.desc
				has_global_flag = custom_difficulty_activate_edict
			}
			success_text = {
				text = custom_difficulty_deactivate_edict.desc
				has_global_flag = custom_difficulty_deactivate_edict
			}
			success_text = {
				text = custom_difficulty_activate_host_only.desc
				has_global_flag = custom_difficulty_activate_host_only
				is_multiplayer = yes
			}
			success_text = {
				text = custom_difficulty_deactivate_host_only.desc
				has_global_flag = custom_difficulty_deactivate_host_only
				is_multiplayer = yes
			}
			success_text = {
				text = custom_difficulty_random_handicap.desc
				event_target:global_event_country = {
					not = {
						check_variable = {
							which = custom_difficulty_random_handicap_perc
							value = 0
						}
					}
				}
			}
		}
	}
	option = {
		name = custom_difficulty_activate_edict.name
		custom_tooltip = custom_difficulty_activate_edict.desc
		trigger = {
			custom_difficulty_allow_changes = yes
			not = { has_global_flag = custom_difficulty_activate_edict }
		}
		hidden_effect = {
			set_global_flag = custom_difficulty_activate_edict
			remove_global_flag = custom_difficulty_deactivate_edict
			country_event = { id = custom_difficulty.3 }  #optionsEvent
		}
	}
	option = {
		name = custom_difficulty_deactivate_edict.name
		custom_tooltip = custom_difficulty_deactivate_edict.desc
		trigger = {
			custom_difficulty_allow_changes = yes
			not = { has_global_flag = custom_difficulty_deactivate_edict }
		}
		hidden_effect = {
			set_global_flag = custom_difficulty_deactivate_edict
			remove_global_flag = custom_difficulty_activate_edict
			country_event = { id = custom_difficulty.3 }  #optionsEvent
		}
	}
	option = {
		name = custom_difficulty_activate_host_only.name
		custom_tooltip = custom_difficulty_activate_host_only.desc
		trigger = {
			custom_difficulty_allow_changes = yes
			not = { has_global_flag = custom_difficulty_activate_host_only }
			is_multiplayer = yes
			has_country_flag = custom_difficulty_game_host
		}
		hidden_effect = {
			set_global_flag = custom_difficulty_activate_host_only
			remove_global_flag = custom_difficulty_deactivate_host_only
			country_event = { id = custom_difficulty.3 }  #optionsEvent
		}
	}
	option = {
		name = custom_difficulty_deactivate_host_only.name
		custom_tooltip = custom_difficulty_deactivate_host_only.desc
		trigger = {
			custom_difficulty_allow_changes = yes
			not = { has_global_flag = custom_difficulty_deactivate_host_only }
			is_multiplayer = yes
			has_country_flag = custom_difficulty_game_host
		}
		hidden_effect = {
			set_global_flag = custom_difficulty_deactivate_host_only
			remove_global_flag = custom_difficulty_activate_host_only
			country_event = { id = custom_difficulty.3 }  #optionsEvent
		}
	}
	option = {
		name = custom_difficulty_lock.name
		trigger = { custom_difficulty_allow_changes = yes }
		hidden_effect = { country_event = { id = custom_difficulty.60 } }
	}
	option = {
		trigger = { custom_difficulty_allow_changes = yes }
		name = custom_difficulty_random_handicap_inc.desc
		hidden_effect = {
			country_event = { id = custom_difficulty.3 }  #optionsEvent
			event_target:global_event_country = {
				change_variable = {
					which = custom_difficulty_random_handicap_perc
					value = 10
				}
			}
		}
	}
	option = {
		trigger = {
			custom_difficulty_allow_changes = yes
			event_target:global_event_country = {
				check_variable = {
					which = custom_difficulty_random_handicap_perc
					value > 0
				}
			}
		}
		name = custom_difficulty_random_handicap_dec.desc
		hidden_effect = {
			country_event = { id = custom_difficulty.3 }  #optionsEvent
			event_target:global_event_country = {
				change_variable = {
					which = custom_difficulty_random_handicap_perc
					value = -10
				}
			}
		}
	}
	option = {
		trigger = { has_global_flag = custom_difficultyMM_active }
		name = custom_difficultyMM_reset.name
		custom_tooltip = custom_difficultyMM_reset.desc
		hidden_effect = { country_event = { id = custom_difficulty_mm.3 } }
	}
	option = {
		trigger = { has_global_flag = custom_difficultyMM_active }
		name = custom_difficultyMM_remove.name
		custom_tooltip = custom_difficultyMM_remove.desc
		hidden_effect = { country_event = { id = custom_difficulty_mm.4 } }
	}
	option = {
		name = custom_difficulty_back
		hidden_effect = { country_event = { id = custom_difficulty.0 } }
	}
	option = {
		name = custom_difficulty_close.name
		hidden_effect = {
			country_event = { id = custom_difficulty.41 }
			if = {
				limit = { has_global_flag = custom_difficultyMM_active }
				country_event = { id = custom_difficulty_mm.2 }
			}
		}
	}
}
 #root update event
event = {
	id = custom_difficulty.40
	is_triggered_only = yes
	hide_window = yes
}
 #root update event
country_event = {
	id = custom_difficulty.41
	is_triggered_only = yes
	hide_window = yes
}
 #newCountryUpdateEvent
 #new dmm init event
event = {
	id = custom_difficulty.13
	is_triggered_only = yes
	hide_window = yes
	immediate = {
		dmm_register_mod = {
			DMM_NAME = custom_difficulty_dmm_loc
			DMM_FLAG = custom_difficuly_new_dmm_menu_flag
		}
	}
}
 #dmm new menu starter
country_event = {
	id = custom_difficulty.14
	is_triggered_only = yes
	hide_window = yes
	trigger = { from = { has_leader_flag = custom_difficuly_new_dmm_menu_flag } }
	immediate = { country_event = { id = custom_difficulty.0 } }
}
 #game start init
country_event = {
	id = custom_difficulty.10
	hide_window = yes
	fire_only_once = yes
	trigger = {
		is_ai = no
		or = {
			NOR = { }
			not = { has_global_flag = custom_difficulty_active }
			has_global_flag = MM_was_active_before_custom_difficulty
		}
	}
	immediate = {
		country_event = { id = custom_difficulty.11 }
		set_country_flag = custom_difficulty_game_host
		set_global_flag = custom_difficulty_variables_transfered
		if = {
			limit = { has_global_flag = MM_was_active_before_custom_difficulty }
			remove_global_flag = MM_was_active_before_custom_difficulty
		}
		event_target:global_event_country = {
			get_galaxy_setup_value = {
				which = custom_difficulty_crisis_strength
				setting = crisis_strength_scale
			}
			set_variable = {
				which = custom_difficulty_random_handicap_perc
				value = 0
			}
			set_variable = {
				which = custom_difficulty_random_handicap
				value = 0
			}
		}
	}
	after = {
		hidden_effect = {
			remove_global_flag = custom_difficulty_deactivate_host_only
			set_global_flag = custom_difficulty_activate_host_only
			remove_global_flag = custom_difficulty_deactivate_edict
			set_global_flag = custom_difficulty_activate_edict
			if = {
				limit = {
					event_target:global_event_country = {
						OR = {
							check_variable = {
								which = custom_difficulty_crisis_strength
								value > 0
							}
							is_crises_allowed = no
						}
					}
				}
				set_global_flag = custom_difficulty_active
				set_global_flag = dmm_mod_utilities_4
				set_global_flag = custom_difficulty_no_player_bonus
				set_global_flag = custom_difficulty_no_scaling
			}
		}
	}
}
 #legacy game start init
country_event = {
	id = custom_difficulty.12
	title = custom_difficulty_init
	picture = GFX_evt_custom_difficulty
	is_triggered_only = yes
	desc = {
		trigger = {
			text = custom_difficulty_init_desc
			success_text = {
				text = custom_difficulty_init_crisis_desc
				is_crises_allowed = yes
			}
			success_text = {
				text = custom_difficulty_init_no_crisis_desc
				is_crises_allowed = no
			}
		}
	}
	option = {
		name = custom_difficulty_0.25_crisis.name
		trigger = { is_crises_allowed = yes }
		hidden_effect = {
			event_target:global_event_country = {
				set_variable = {
					which = custom_difficulty_crisis_strength
					value = 0.25
				}
			}
		}
	}
	option = {
		name = custom_difficulty_0.5_crisis.name
		trigger = { is_crises_allowed = yes }
		hidden_effect = {
			event_target:global_event_country = {
				set_variable = {
					which = custom_difficulty_crisis_strength
					value = 0.5
				}
			}
		}
	}
	option = {
		name = custom_difficulty_1_crisis.name
		trigger = { is_crises_allowed = yes }
		hidden_effect = {
			event_target:global_event_country = {
				set_variable = {
					which = custom_difficulty_crisis_strength
					value = 1
				}
			}
		}
	}
	option = {
		name = custom_difficulty_2_crisis.name
		trigger = { is_crises_allowed = yes }
		hidden_effect = {
			event_target:global_event_country = {
				set_variable = {
					which = custom_difficulty_crisis_strength
					value = 2
				}
			}
		}
	}
	option = {
		name = custom_difficulty_3_crisis.name
		trigger = { is_crises_allowed = yes }
		hidden_effect = {
			event_target:global_event_country = {
				set_variable = {
					which = custom_difficulty_crisis_strength
					value = 3
				}
			}
		}
	}
	option = {
		name = custom_difficulty_4_crisis.name
		trigger = { is_crises_allowed = yes }
		hidden_effect = {
			event_target:global_event_country = {
				set_variable = {
					which = custom_difficulty_crisis_strength
					value = 4
				}
			}
		}
	}
	option = {
		name = custom_difficulty_5_crisis.name
		trigger = { is_crises_allowed = yes }
		hidden_effect = {
			event_target:global_event_country = {
				set_variable = {
					which = custom_difficulty_crisis_strength
					value = 5
				}
			}
		}
	}
	option = {
		name = custom_difficulty_10_crisis.name
		trigger = { is_crises_allowed = yes }
		hidden_effect = {
			event_target:global_event_country = {
				set_variable = {
					which = custom_difficulty_crisis_strength
					value = 10
				}
			}
		}
	}
	option = {
		name = custom_difficulty_15_crisis.name
		trigger = { is_crises_allowed = yes }
		hidden_effect = {
			event_target:global_event_country = {
				set_variable = {
					which = custom_difficulty_crisis_strength
					value = 15
				}
			}
		}
	}
	option = {
		name = custom_difficulty_20_crisis.name
		trigger = { is_crises_allowed = yes }
		hidden_effect = {
			event_target:global_event_country = {
				set_variable = {
					which = custom_difficulty_crisis_strength
					value = 20
				}
			}
		}
	}
	option = {
		name = custom_difficulty_25_crisis.name
		trigger = { is_crises_allowed = yes }
		hidden_effect = {
			event_target:global_event_country = {
				set_variable = {
					which = custom_difficulty_crisis_strength
					value = 25
				}
			}
		}
	}
	option = {
		name = OK
		trigger = { is_crises_allowed = no }
	}
	after = {
		hidden_effect = {
			set_global_flag = custom_difficulty_active
			set_global_flag = dmm_mod_utilities_4
			set_global_flag = custom_difficulty_no_player_bonus
			set_global_flag = custom_difficulty_no_scaling
		}
	}
}
 #Assign a variable to each default country that will decide how much their difficulty modifiers are decreased by randomness
country_event = {
	id = custom_difficulty.11
	hide_window = yes
	trigger = { NOT = { has_global_flag = custom_difficulty_random_difficulty_given } }
	immediate = {
		set_global_flag = custom_difficulty_random_difficulty_given
		every_country = {
			limit = {
				is_country_type = default
				is_ai = yes
			}
			random_list = {
				1 = {
					set_variable = {
						which = custom_difficulty_random_handicap
						value = 0
					}
				}
				1 = {
					set_variable = {
						which = custom_difficulty_random_handicap
						value = 1
					}
				}
				1 = {
					set_variable = {
						which = custom_difficulty_random_handicap
						value = 2
					}
				}
				1 = {
					set_variable = {
						which = custom_difficulty_random_handicap
						value = 3
					}
				}
				1 = {
					set_variable = {
						which = custom_difficulty_random_handicap
						value = 4
					}
				}
				1 = {
					set_variable = {
						which = custom_difficulty_random_handicap
						value = 5
					}
				}
				1 = {
					set_variable = {
						which = custom_difficulty_random_handicap
						value = 6
					}
				}
				1 = {
					set_variable = {
						which = custom_difficulty_random_handicap
						value = 7
					}
				}
				1 = {
					set_variable = {
						which = custom_difficulty_random_handicap
						value = 8
					}
				}
				1 = {
					set_variable = {
						which = custom_difficulty_random_handicap
						value = 9
					}
				}
				1 = {
					set_variable = {
						which = custom_difficulty_random_handicap
						value = 10
					}
				}
				1 = {
					set_variable = {
						which = custom_difficulty_random_handicap
						value = 11
					}
				}
				1 = {
					set_variable = {
						which = custom_difficulty_random_handicap
						value = 12
					}
				}
				1 = {
					set_variable = {
						which = custom_difficulty_random_handicap
						value = 13
					}
				}
				1 = {
					set_variable = {
						which = custom_difficulty_random_handicap
						value = 14
					}
				}
				1 = {
					set_variable = {
						which = custom_difficulty_random_handicap
						value = 15
					}
				}
				1 = {
					set_variable = {
						which = custom_difficulty_random_handicap
						value = 16
					}
				}
				1 = {
					set_variable = {
						which = custom_difficulty_random_handicap
						value = 17
					}
				}
				1 = {
					set_variable = {
						which = custom_difficulty_random_handicap
						value = 18
					}
				}
				1 = {
					set_variable = {
						which = custom_difficulty_random_handicap
						value = 19
					}
				}
				1 = {
					set_variable = {
						which = custom_difficulty_random_handicap
						value = 20
					}
				}
			}
		}
	}
}
 #lock confirmation
country_event = {
	id = custom_difficulty.60
	is_triggered_only = yes
	title = custom_difficulty_lock.name
	desc = custom_difficulty_lock.desc
	picture = GFX_evt_towel
	option = {
		name = OK
		hidden_effect = {
			set_global_flag = custom_difficulty_locked
			country_event = { id = custom_difficulty.41 }
		}
	}
	option = {
		name = custom_difficulty_cancel
		hidden_effect = { country_event = { id = custom_difficulty.3 } }
	}
}
 #all flags
country_event = {
	id = custom_difficulty.22
	is_triggered_only = yes
	hide_window = yes
	immediate = {
		remove_global_flag = custom_difficulty_advanced_configuration_player
		remove_global_flag = custom_difficulty_advanced_configuration_scaling
		remove_global_flag = custom_difficulty_advanced_configuration_other
	}
}
 #player flags
country_event = {
	id = custom_difficulty.25
	is_triggered_only = yes
	hide_window = yes
	immediate = { remove_global_flag = custom_difficulty_advanced_configuration_player }
}
 #scaling flags
country_event = {
	id = custom_difficulty.24
	is_triggered_only = yes
	hide_window = yes
	immediate = { remove_global_flag = custom_difficulty_advanced_configuration_scaling }
}
 #other flags
country_event = {
	id = custom_difficulty.23
	is_triggered_only = yes
	hide_window = yes
	immediate = { remove_global_flag = custom_difficulty_advanced_configuration_other }
}
