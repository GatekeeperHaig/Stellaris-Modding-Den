namespace = ex_ship_events

event = {
	id = ex_ship_events.0
	hide_window = yes
	is_triggered_only = yes

	
	trigger = {

	}
	
	immediate = { 
		every_country = {
			limit = {
				OR = {
					is_country_type = default
					is_country_type = fallen_empire					
				}
				OR = {
					has_technology = "tech_wormhole_generation_1"
					has_technology = "tech_wormhole_generation_2"
					has_technology = "tech_wormhole_generation_3"
				}
			}	
			every_owned_ship = {
				limit = { is_ship_class = shipclass_military }
				if = {
					limit = { has_wormhole_modulator_1 = yes } 
					set_ship_flag = ex_wormhole_1
				}	
				if = {
					limit = { has_wormhole_modulator_2 = yes } 
					set_ship_flag = ex_wormhole_2
				}		
				if = {
					limit = { has_wormhole_modulator_3 = yes } 
					set_ship_flag = ex_wormhole_3
				}	
			}				
		}
	}
}	

ship_event = {
	id = ex_ship_events.1
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {	
		root ={
			is_ship_class = shipclass_military
			OR = {
				has_wormhole_modulator_1 = yes
				has_wormhole_modulator_2 = yes
				has_wormhole_modulator_3 = yes			
			}	
		}	
	}		
	
	immediate = { 
		root = {
			if = {
				limit = { has_ship_flag = ex_wormhole_1 }
				remove_ship_flag = ex_wormhole_1
				ship_event = { id = ex_ship_events.2 }
				break = yes
			}	
			if = {
				limit = { has_ship_flag = ex_wormhole_2 }
				remove_ship_flag = ex_wormhole_2
				ship_event = { id = ex_ship_events.2 }
				break = yes
			}
			if = {
				limit = { has_ship_flag = ex_wormhole_3 }
				remove_ship_flag = ex_wormhole_3
				ship_event = { id = ex_ship_events.2 }
				break = yes
			}	
		}	
	}
}	

ship_event = {
	id = ex_ship_events.2
	hide_window = yes
	is_triggered_only = yes
	
	immediate = { 
		root = {
			if = {
				limit = { has_wormhole_modulator_1 = yes } 
				set_ship_flag = ex_wormhole_1
				break = yes
			}	
			if = {
				limit = { has_wormhole_modulator_2 = yes } 
				set_ship_flag = ex_wormhole_2
				break = yes
			}		
			if = {
				limit = { has_wormhole_modulator_3 = yes } 
				set_ship_flag = ex_wormhole_3
				break = yes
			}	
		}		
	}
}

ship_event = { 
	id = ex_ship_events.3
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {	
		OR = {
			has_ship_flag = ex_wormhole_1
			has_ship_flag = ex_wormhole_2
			has_ship_flag = ex_wormhole_3

		}	
	}	
	
	immediate = {
		if = {
			limit = { has_modifier = ex_wormhole_ftl_debuff }
			remove_modifier = "ex_wormhole_ftl_debuff"
		}	
		if = {
			limit = { has_ship_flag = ex_wormhole_1 } 
			add_modifier = { modifier = ex_wormhole_ftl_debuff days = 90 }
		}				
		if = {
			limit = { has_ship_flag = ex_wormhole_2 } 
			add_modifier = { modifier = ex_wormhole_ftl_debuff days = 60 }
		}						
		if = {
			limit = { has_ship_flag = ex_wormhole_3 } 
			add_modifier = { modifier = ex_wormhole_ftl_debuff days = 30 }
		}								
	}
}