namespace = cgm_asteroid_colonization

ship_event = {
	id = cgm_asteroid_colonization.1
	is_triggered_only = yes
	location = from
	title = cgm_asteroidal_planet_found.name
	desc = {
		trigger = { 
			from = { is_planet_class = pc_asteroidal_planetoid }
			text = cgm_asteroidal_planet_found.desc
		}	
		trigger = { 
			from = { is_planet_class = pc_ice_asteroidal_planetoid }
			text = cgm_ice_asteroidal_planet_found.desc
		}		
		trigger = { 
			from = { is_planet_class = pc_crystal_asteroidal_planetoid }
			text = cgm_ice_asteroidal_planet_found.desc
		}				
	}		
	picture = "GFX_evt_mining_station"		
	immediate = { 
		from = { generate_asteroidal_planetoid = yes } 
	}		
	option = { name = OK } 
}	
planet_event = { 
	id = cgm_asteroid_colonization.2
	hide_window = yes
	is_triggered_only = yes
	
	immediate = { 
		if = { 
			limit = { is_planet_class = pc_asteroidal_planetoid }
			set_variable = { which = tb_pc_asteroidal_mineral_ultra_rich_rock_new value = 0 } 
			set_variable = { which = tb_pc_asteroidal_mineral_rich_rock_new value = 0 } 
			set_variable = { which = tb_pc_asteroidal_energy_ultra_rich_rock_new value = 0 } 
			set_variable = { which = tb_pc_asteroidal_energy_rich_rock_new value = 0 } 
			set_variable = { which = tb_pc_asteroidal_carbometallic_rock_new value = 0 } 		
			every_tile = { 
				if = { limit = { has_blocker = tb_pc_asteroidal_carbometallic_rock } prev = { change_variable = { which = tb_pc_asteroidal_carbometallic_rock_new value = 1 } } }
				else_if = { limit = { has_blocker = tb_pc_asteroidal_mineral_rich_rock } prev = { change_variable = { which = tb_pc_asteroidal_mineral_rich_rock_new value = 1 } } }
				else_if = { limit = { has_blocker = tb_pc_asteroidal_energy_rich_rock } prev = { change_variable = { which =	tb_pc_asteroidal_energy_rich_rock_new value = 1 } } }
				else_if = { limit = { has_blocker = tb_pc_asteroidal_mineral_ultra_rich_rock } prev = { change_variable = { which =  tb_pc_asteroidal_mineral_ultra_rich_rock_new value = 1 } } }
				else_if = { limit = { has_blocker = tb_pc_asteroidal_energy_ultra_rich_rock } prev = { change_variable = { which = tb_pc_asteroidal_energy_ultra_rich_rock_new  value = 1 } } }
			}
			if = { 
				limit = { NOT = { check_variable = { which = tb_pc_asteroidal_carbometallic_rock value = tb_pc_asteroidal_carbometallic_rock } } }
			}									
			else_if = { 
				limit = { NOT = { check_variable = { which = tb_pc_asteroidal_mineral_rich_rock_new value = tb_pc_asteroidal_mineral_rich_rock } } }
			}						
			else_if = { 
				limit = { NOT = { check_variable = { which = tb_pc_asteroidal_energy_rich_rock_new value = tb_pc_asteroidal_energy_rich_rock } } }
			}									
			else_if = { 
				limit = { NOT = { check_variable = { which = tb_pc_asteroidal_mineral_ultra_rich_rock_new value = tb_pc_asteroidal_mineral_ultra_rich_rock } } }
			}	
			else_if = { 
				limit = { NOT = { check_variable = { which = tb_pc_asteroidal_energy_ultra_rich_rock_new value = tb_pc_asteroidal_energy_ultra_rich_rock } } }
			}			
		}
		else_if = { 
			limit = { is_planet_class = pc_ice_asteroidal_planetoid }		
			set_variable = { which = tb_pc_ice_asteroidal_primordial_ice_new value = 0 } 
			set_variable = { which = tb_pc_ice_asteroidal_frozen_exotic_matter_new value = 0 } 
			every_tile = {
				if = { 
					limit = { has_blocker = tb_pc_ice_asteroidal_primordial_ice } prev = { change_variable = { which = tb_pc_ice_asteroidal_primordial_ice_new value = 1 } } 
				}
				else_if = { 
					limit = { has_blocker = tb_pc_ice_asteroidal_frozen_exotic_matter } prev = { change_variable = { which = tb_pc_ice_asteroidal_frozen_exotic_matter_new value = 1 } } 
				}				
			}
			if = { 
				limit = { NOT = { check_variable = { which = tb_pc_ice_asteroidal_primordial_ice value = tb_pc_ice_asteroidal_primordial_ice } } }
			}					
			else_if = { 
				limit = { NOT = { check_variable = { which = tb_pc_ice_asteroidal_frozen_exotic_matter_new value = tb_pc_ice_asteroidal_frozen_exotic_matter } } }
			}			
		}	
		else_if = { 
			limit = { is_planet_class = pc_crystal_asteroidal_planetoid }
		}	
	}
}	
