namespace = gigadrill
#Construction site built
country_event = {
	id = gigadrill.1000
	title = gigadrill.1000.title
	desc = gigadrill.1000.desc
	picture = GFX_evt_drilling_for_gas
	show_sound = event_dyson_sphere_build_complete
	location = FROM

	is_triggered_only = yes

	trigger = {
		FROM = { is_megastructure_type = hyper_drill_2 }
	}

	option = {
		name = gigadrill.1000.a
		hidden_effect = {
			FROM.planet = {
				planet_event = { id = gigadrill.1001 days = 720 }
			}
		}
	}
}

planet_event = {
	id = gigadrill.1001
	hide_window = yes

	is_triggered_only = yes

	immediate = {
		planet_event = { id = gigadrill.1002 days = 720 }
		change_planet_size = -1
		change_pc = pc_strip_mined
	}
}

planet_event = {
	id = gigadrill.1002
	hide_window = yes

	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				planet_size > 2
				NOT = { has_planet_flag = osat_event }
			}
			change_planet_size = -1
			planet_event = { id = gigadrill.1007 days = 1 }
			planet_event = { id = gigadrill.1005 days = 1 }
			planet_event = { id = gigadrill.1002 days = 720 }
		}
		if = {
			limit = {
				planet_size = 5
			}
			planet_event = { id = gigadrill.1003 days = 1 }
		}
	}
}

planet_event = {
	id = gigadrill.1003
	hide_window = yes

	is_triggered_only = yes

	immediate = {
		set_planet_flag = reached_inner_core
		solar_system = {
			space_owner = {
				country_event = { id = gigadrill.1004 days = 1 }
			}
		}
	}
}

country_event = {
	id = gigadrill.1004
	title = gigadrill.1004.title
	desc = gigadrill.1004.desc
	picture = GFX_evt_drilling_for_gas
	show_sound = event_dyson_sphere_build_complete
	location = FROM

	is_triggered_only = yes

	option = {
		name = gigadrill.1004.a
	}
}

planet_event = {
	id = gigadrill.1005
	hide_window = yes

	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				planet_size = 2
			}
			change_pc = pc_core_mined
			set_planet_flag = depletedstripmine
			remove_planet_flag = has_megastructure
			solar_system = {
				space_owner = {
					country_event = { id = gigadrill.1006 days = 1 }
				}
			}
		}
	}
}

country_event = {
	id = gigadrill.1006
	title = gigadrill.1006.title
	desc = gigadrill.1006.desc
	picture = GFX_evt_drilling_for_gas
	show_sound = event_dyson_sphere_build_complete
	location = FROM

	is_triggered_only = yes

	option = {
		name = gigadrill.1006.a
		hidden_effect = {
			every_megastructure = {
				limit = {
					is_megastructure_type = hyper_drill_2
					planet = { is_planet_class = pc_core_mined }
				}
				remove_megastructure = this
				planet = {
					orbital_deposit_tile = {
						add_deposit =  d_depletedstripmine_deposit
					}
					remove_planet_flag = depletedstripmine
					set_planet_flag = stripminedplanet
				}
			}
			every_megastructure = {
				limit = {
					is_megastructure_type = hyper_drill_s1_2
					planet = { is_planet_class = pc_core_mined }
				}
				remove_megastructure = this
				planet = {
					orbital_deposit_tile = {
						add_deposit =  d_depletedstripmine_deposit
					}
					remove_planet_flag = depletedstripmine
					set_planet_flag = stripminedplanet
				}
			}
			every_megastructure = {
				limit = {
					is_megastructure_type = hyper_drill_s2_2
					planet = { is_planet_class = pc_core_mined }
				}
				remove_megastructure = this
				planet = {
					orbital_deposit_tile = {
						add_deposit =  d_depletedstripmine_deposit
					}
					remove_planet_flag = depletedstripmine
					set_planet_flag = stripminedplanet
				}
			}
			every_megastructure = {
				limit = {
					is_megastructure_type = hyper_drill_s3_2
					planet = { is_planet_class = pc_core_mined }
				}
				remove_megastructure = this
				planet = {
					orbital_deposit_tile = {
						add_deposit =  d_depletedstripmine_deposit
					}
					remove_planet_flag = depletedstripmine
					set_planet_flag = stripminedplanet
				}
			}
			every_megastructure = {
				limit = {
					is_megastructure_type = hyper_drill_s4_2
					planet = { is_planet_class = pc_core_mined }
				}
				remove_megastructure = this
				planet = {
					orbital_deposit_tile = {
						add_deposit =  d_depletedstripmine_deposit
					}
					remove_planet_flag = depletedstripmine
					set_planet_flag = stripminedplanet
				}
			}
			every_megastructure = {
				limit = {
					is_megastructure_type = hyper_drill_s5_2
					planet = { is_planet_class = pc_core_mined }
				}
				remove_megastructure = this
				planet = {
					orbital_deposit_tile = {
						add_deposit =  d_depletedstripmine_deposit
					}
					remove_planet_flag = depletedstripmine
					set_planet_flag = stripminedplanet
				}
			}
			every_megastructure = {
				limit = {
					is_megastructure_type = hyper_drill_2_on_again
					planet = { is_planet_class = pc_core_mined }
				}
				remove_megastructure = this
				planet = {
					orbital_deposit_tile = {
						add_deposit =  d_depletedstripmine_deposit
					}
					remove_planet_flag = depletedstripmine
					set_planet_flag = stripminedplanet
				}
			}
		}				
	}
}

planet_event = {
	id = gigadrill.1007
	location = FROM
	hide_window = yes

	is_triggered_only = yes

	immediate = {
		random_list = {
			10 = {
				modifier = {
					factor = 0
					has_planet_flag = found_strategic_deposit
				}
				modifier = {
					factor = 0
					has_planet_flag = found_osat
				}
				solar_system = {
					space_owner = {
						country_event = { id = gigadrill.11007 days = 1 }
					}
				}
				set_planet_flag = found_strategic_deposit
				set_planet_flag = found_aegisalt
			}
			5 = {
				modifier = {
					factor = 0
					has_planet_flag = found_strategic_deposit												
				}
				modifier = {
					factor = 0
					has_planet_flag = found_osat												
				}
				solar_system = {
					space_owner = {
						country_event = { id = gigadrill.21007 days = 1 }
					}
				}
				set_planet_flag = found_strategic_deposit
				set_planet_flag = found_purpla
			}
			10 = {
				modifier = {
					factor = 0
					has_planet_flag = found_strategic_deposit												
				}
				modifier = {
					factor = 0
					has_planet_flag = found_osat												
				}
				solar_system = {
					space_owner = {
						country_event = { id = gigadrill.31007 days = 1 }
					}
				}
				set_planet_flag = found_strategic_deposit
				set_planet_flag = found_kyber
			}
			10 = {
				modifier = {
					factor = 0
					has_planet_flag = found_strategic_deposit												
				}
				modifier = {
					factor = 0
					has_planet_flag = found_osat												
				}
				solar_system = {
					space_owner = {
						country_event = { id = gigadrill.41007 days = 1 }
					}
				}
				set_planet_flag = found_strategic_deposit
				set_planet_flag = found_ruby
			}
			10 = {
				modifier = {
					factor = 0
					has_planet_flag = found_strategic_deposit												
				}
				modifier = {
					factor = 0
					has_planet_flag = found_osat												
				}
				modifier = {
					factor = 0
					has_planet_flag = reached_inner_core												
				}
				solar_system = {
					space_owner = {
						country_event = { id = gigadrill.51007 days = 1 }
					}
				}
				set_planet_flag = found_strategic_deposit
				set_planet_flag = found_fossil_fuels
			}
			1 = {
				modifier = {
					factor = 0
					has_planet_flag = found_strategic_deposit												
				}
				modifier = {
					factor = 0
					has_global_flag = found_civilization												
				}
				modifier = {
					factor = 0
					has_planet_flag = reached_inner_core												
				}
				solar_system = {
					space_owner = {
						country_event = { id = gigadrill.1009 days = 1 }
					}
				}
				set_planet_flag = osat_event
				set_planet_flag = has_osat
				set_planet_flag = found_osat
				set_global_flag = found_civilization
			}
			1000 = {}
		}
	}
}

country_event = {
	id = gigadrill.11007
	title = gigadrill.11007.title
	desc = gigadrill.11007.desc
	picture = GFX_evt_drilling_for_gas
	show_sound = event_dyson_sphere_build_complete
	location = FROM

	is_triggered_only = yes

	option = {
		name = gigadrill.11007.a
		hidden_effect = {
			every_megastructure = {
				limit = {
					is_megastructure_type = hyper_drill_2
					planet = { has_planet_flag = found_aegisalt }
				}
				upgrade_megastructure_to = hyper_drill_s1_2
				planet = { remove_planet_flag = found_aegisalt }
			}
		}
	}
}

country_event = {
	id = gigadrill.21007
	title = gigadrill.21007.title
	desc = gigadrill.21007.desc
	picture = GFX_evt_drilling_for_gas
	show_sound = event_dyson_sphere_build_complete
	location = FROM

	is_triggered_only = yes

	option = {
		name = gigadrill.21007.a
		hidden_effect = {
			set_country_flag = found_purplarium
			every_megastructure = {
				limit = {
					is_megastructure_type = hyper_drill_2
					planet = { has_planet_flag = found_purpla }
				}
				upgrade_megastructure_to = hyper_drill_s2_2
				planet = { remove_planet_flag = found_purpla }
			}
		}
	}
}

country_event = {
	id = gigadrill.31007
	title = gigadrill.31007.title
	desc = gigadrill.31007.desc
	picture = GFX_evt_drilling_for_gas
	show_sound = event_dyson_sphere_build_complete
	location = FROM

	is_triggered_only = yes

	option = {
		name = gigadrill.31007.a
		hidden_effect = {
			every_megastructure = {
				limit = {
					is_megastructure_type = hyper_drill_2
					planet = { has_planet_flag = found_kyber }
				}
				upgrade_megastructure_to = hyper_drill_s3_2
				planet = { remove_planet_flag = found_kyber }
			}
		}
	}
}

country_event = {
	id = gigadrill.41007
	title = gigadrill.41007.title
	desc = gigadrill.41007.desc
	picture = GFX_evt_drilling_for_gas
	show_sound = event_dyson_sphere_build_complete
	location = FROM

	is_triggered_only = yes

	option = {
		name = gigadrill.41007.a
		hidden_effect = {
			every_megastructure = {
				limit = {
					is_megastructure_type = hyper_drill_2
					planet = { has_planet_flag = found_ruby }
				}
				upgrade_megastructure_to = hyper_drill_s4_2
				planet = { remove_planet_flag = found_ruby }
			}
		}
	}
}

country_event = {
	id = gigadrill.51007
	title = gigadrill.51007.title
	desc = gigadrill.51007.desc
	picture = GFX_evt_drilling_for_gas
	show_sound = event_dyson_sphere_build_complete
	location = FROM

	is_triggered_only = yes

	option = {
		name = gigadrill.51007.a
		hidden_effect = {
			every_megastructure = {
				limit = {
					is_megastructure_type = hyper_drill_2
					planet = { has_planet_flag = found_fossil_fuels }
				}
				upgrade_megastructure_to = hyper_drill_s5_2
				planet = { remove_planet_flag = found_fossil_fuels }
			}
		}
	}
}

country_event = {
	id = gigadrill.1009
	title = gigadrill.1009.title
	desc = gigadrill.1009.desc
	picture = GFX_evt_underground_civilization
	show_sound = event_radio_chatter_01
	location = FROM

	is_triggered_only = yes

	option = {
		name = gigadrill.1009.a
		hidden_effect = {
			every_megastructure = {
				limit = {
					is_megastructure_type = hyper_drill_2
					planet = { has_planet_flag = has_osat }
				}
				upgrade_megastructure_to = hyper_drill_off_2
			}
			every_planet = {
				limit = {
					has_planet_flag = has_osat
				}
				save_event_target_as = osat_planet
			}
			country_event = { id = gigadrill.1010 }
		}
	}
}

country_event = {
	id = gigadrill.1010
	title = "gigadrill.1010.title"
	desc = "gigadrill.1010.desc"
	
	diplomatic = yes
	
	is_triggered_only = yes
	
	picture_event_data = {
		room = no_video_feed_room
	}
	
	option = {
		name = gigadrill.1010.a
		response_text = gigadrill.1010.a.response
		is_dialog_only = yes
	}
	option = {
		name = gigadrill.1010.b
		custom_tooltip = gigadrill.1010.b.tooltip
		country_event = { id = gigadrill.1011 }
	}
	option = {
		name = gigadrill.1010.c
		custom_tooltip = gigadrill.1010.c.tooltip
		country_event = { id = gigadrill.1012 }
	}
}

country_event = {
	id = gigadrill.1011
	title = gigadrill.1011.title
	desc = gigadrill.1011.desc
	picture = GFX_evt_underground_civilization
	show_sound = event_radio_chatter_01
	location = FROM

	is_triggered_only = yes

	option = {
		name = gigadrill.1011.a
		hidden_effect = {
			country_event = { id = gigadrill.1100 days = 1 }
		}
	}
	option = {
		name = gigadrill.1011.b
		enable_special_project = {
			name = "OSAT_PROJECT"
			location = event_target:osat_planet
			owner = root.owner
		}
	}
}

country_event = {
	id = gigadrill.1012
	title = gigadrill.1012.title
	desc = gigadrill.1012.desc
	picture = GFX_evt_underground_civilization
	show_sound = event_radio_chatter_01
	location = FROM

	is_triggered_only = yes

	option = {
		name = gigadrill.1012.a
		enable_special_project = {
			name = "OSAT_PROJECT_OBSERVE"
			location = event_target:osat_planet
			owner = root.owner
		}
	}
	option = {
		trigger = {
			any_owned_planet = {
				free_pop_tiles > 1
			}
		}
		name = gigadrill.1012.b
		custom_tooltip = gigadrill.1012.b.tooltip
		hidden_effect = {
			random_planet_within_border = {
				limit = {
					free_pop_tiles > 1
					habitable_planet = yes
					is_colony = yes	
					has_anomaly = no
				}
				save_event_target_as = potential_osat
			}
		}
		enable_special_project = {
			name = "OSAT_PROJECT_MOVE"
			location = event_target:osat_planet
			owner = root.owner
		}
	}
	option = {
		name = gigadrill.1012.c
		hidden_effect = {
			every_planet = {
				limit = {
					has_planet_flag = has_osat
				}
				set_planet_flag = osat_system
			}
		}
		enable_special_project = {
			name = "OSAT_PROJECT_HABITAT"
			location = event_target:osat_planet
			owner = root.owner
		}
	}
}

country_event = {
	id = gigadrill.1400
	title = gigadrill.1400.title
	desc = gigadrill.1400.desc
	picture = GFX_evt_underground_civilization
	show_sound = event_radio_chatter_01
	location = FROM

	is_triggered_only = yes

	option = {
		name = gigadrill.1400.a
		hidden_effect = {
			every_planet = {
				limit = {
					has_planet_flag = has_osat
				}
				solar_system = {
					spawn_megastructure = { 
						type = "hyper_drill_habitat" 
						location = FROMFROM
						owner = FROM
					}
				}
			}
			every_megastructure = {
				limit = {
					is_megastructure_type = hyper_drill_off_2
					planet = { has_planet_flag = has_osat }
				}
				upgrade_megastructure_to = hyper_drill_2_on_again
				planet = { remove_planet_flag = osat_event }
			}
			every_planet = {
				limit = {
					has_planet_flag = has_osat
				}
				remove_planet_flag = has_osat
				planet_event = { id = gigadrill.1002 days = 2 }
			}
		}
	}
}

country_event = {
	id = gigadrill.1300
	title = gigadrill.1300.title
	desc = gigadrill.1300.desc
	picture = GFX_evt_underground_civilization
	show_sound = event_radio_chatter_01
	location = FROM

	is_triggered_only = yes

	option = {
		name = gigadrill.1300.a
		hidden_effect = {
			every_megastructure = {
				limit = {
					is_megastructure_type = hyper_drill_off_2
					planet = { has_planet_flag = has_osat }
				}
				upgrade_megastructure_to = hyper_drill_2_on_again
				planet = { remove_planet_flag = osat_event }
			}
			every_planet = {
				limit = {
					has_planet_flag = has_osat
				}
				planet_event = { id = gigadrill.1002 days = 2 }
			}
			create_species = {
				name = "Osat"
				plural = "Osats"
				adjective = "Osat"
				class = ART
				portrait = art1
				traits = {
					trait = "trait_venerable"
					trait = "trait_conservational"
					trait = "trait_traditional"
					trait = "trait_osat"
					trait = "trait_pc_continental_preference"
				}
			}
			event_target:potential_osat = {
				set_owner = root
				set_controller = root
				prevent_anomaly = yes
				
				best_tile_for_pop = {
					set_building = "building_osat_habitat"
					create_pop = {
						species = Osat
						ethos = {
							ethic = "ethic_egalitarian"
						}
					}
				}
			}
		}
	}
}

country_event = {
	id = gigadrill.1013
	title = gigadrill.1013.title
	desc = gigadrill.1013.desc
	picture = GFX_evt_alien_cavemen
	show_sound = event_radio_chatter_01
	location = FROM

	is_triggered_only = yes

	option = {
		name = gigadrill.1013.a
		country_event = { id = gigadrill.1014 }
		add_monthly_resource_mult = {
			resource = minerals
			value = 1
			min = 1500
			max = 1500
		}
		add_monthly_resource_mult = {
			resource = energy
			value = 1
			min = 1500
			max = 1500
		}
		add_monthly_resource_mult = {
			resource = food
			value = 1
			min = 500
			max = 500
		}
		add_monthly_resource_mult = {
			resource = society_research
			value = 1
			min = 1500
			max = 1500
		}
		hidden_effect = {
			every_country = {
				limit = {
					NOT = { is_country_type = primitive }
					NOT = { is_country_type = fallen_empire }
					NOT = { has_ethic = xenophobe }
					NOT = { has_ethic = fanatic_xenophobe }
					NOT = { is_country = ROOT }
					has_communications = root
				}
				add_opinion_modifier = { who = ROOT modifier = opinion_preserved_osat }
			}
			every_planet = {
				limit = {
					has_planet_flag = has_osat
				}
				orbital_deposit_tile = {
					add_deposit =  d_osat_deposit
				}
				add_modifier = {
					modifier = osat_preserve
					days = -1
				}
				remove_planet_flag = has_megastructure
			}
			every_megastructure = {
				limit = {
					exists = this
					is_megastructure_type = hyper_drill_off_2
					planet = { has_planet_flag = has_osat }
				}
				remove_megastructure = this
			}
		}
	}
}

country_event = {
	id = gigadrill.1014
	title = "gigadrill.1014.title"
	desc = "gigadrill.1014.desc"
	
	diplomatic = yes
	
	is_triggered_only = yes
	
	picture_event_data = {
		room = no_video_feed_room
	}
	
	option = {
		name = gigadrill.1014.a
	}
}

country_event = {
	id = gigadrill.1200
	title = gigadrill.1200.title
	desc = gigadrill.1200.desc
	picture = GFX_evt_underground_civilization
	show_sound = event_radio_chatter_01
	location = FROM

	is_triggered_only = yes

	option = {
		name = gigadrill.1201.a
		hidden_effect = {
			every_megastructure = {
				limit = {
					exists = this
					is_megastructure_type = hyper_drill_off_2
					planet = { has_planet_flag = has_osat }
				}
				remove_megastructure = this
			}
		}
	}
}

country_event = {
	id = gigadrill.1100
	title = gigadrill.1100.title
	desc = gigadrill.1100.desc
	picture = GFX_evt_underground_civilization
	show_sound = event_radio_chatter_01
	location = FROM

	is_triggered_only = yes

	option = {
		name = gigadrill.1100.a
		hidden_effect = {
			country_event = { id = gigadrill.1101 }
			every_megastructure = {
				limit = {
					is_megastructure_type = hyper_drill_off_2
					planet = { has_planet_flag = has_osat }
				}
				upgrade_megastructure_to = hyper_drill_2_on_again
				planet = { remove_planet_flag = osat_event }
			}
			every_country = {
				limit = {
					NOT = { is_country_type = primitive }
					NOT = { is_country_type = fallen_empire }
					NOT = { has_ethic = xenophobe }
					NOT = { has_ethic = fanatic_xenophobe }
					NOT = { is_country = ROOT }
					has_communications = root
				}
				add_opinion_modifier = { who = ROOT modifier = opinion_killed_osat }
			}
			every_planet = {
				limit = {
					has_planet_flag = has_osat
				}
				remove_planet_flag = has_osat
				planet_event = { id = gigadrill.1002 days = 2 }
			}
		}
	}
}

country_event = {
	id = gigadrill.1101
	title = "gigadrill.1101.title"
	desc = "gigadrill.1101.desc"
	
	diplomatic = yes
	
	is_triggered_only = yes
	
	picture_event_data = {
		room = no_video_feed_room
	}
	
	option = {
		name = gigadrill.1101.a
	}
}
	
country_event = {
	id = gigadrill.1110
	title = gigadrill.1110.title
	desc = gigadrill.1110.desc
	picture = GFX_evt_ground_combat
	show_sound = event_ground_battle
	location = FROM

	is_triggered_only = yes

	option = {
		name = gigadrill.1110.a
		hidden_effect = {
			every_country = {
				limit = {
					NOT = { is_country_type = primitive }
					NOT = { is_country_type = fallen_empire }
					NOT = { has_ethic = xenophobe }
					NOT = { has_ethic = fanatic_xenophobe }
					NOT = { is_country = ROOT }
					has_communications = root
				}
				add_opinion_modifier = { who = ROOT modifier = opinion_killed_osat }
			}
			every_megastructure = {
				limit = {
					is_megastructure_type = hyper_drill_off_2
					planet = { has_planet_flag = has_osat }
				}
				upgrade_megastructure_to = hyper_drill_2_on_again
				planet = { remove_planet_flag = osat_event }
			}
			every_planet = {
				limit = {
					has_planet_flag = has_osat
				}
				planet_event = { id = gigadrill.1002 days = 2 }
			}
		}
		add_monthly_resource_mult = {
			resource = minerals
			value = 1
			min = 3500
			max = 3500
		}
		add_monthly_resource_mult = {
			resource = energy
			value = 1
			min = 3500
			max = 3500
		}
	}
}