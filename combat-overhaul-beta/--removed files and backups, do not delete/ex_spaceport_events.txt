namespace = ex_spaceport_events

country_event = {
	id = ex_spaceport_events.0 #gamestart event
	hide_window = yes

	immediate = {
		every_owned_planet = {
			limit = { has_spaceport = yes }	
			if = { 
				limit = { has_spaceport_module = projectile_weapon }									
				owner = { add_ship_design = "NAME_Kinetic_Spaceport" }				
			}	
			if = { 
				limit = { has_spaceport_module = laser_weapon }				
				owner = { add_ship_design = "NAME_Energy_Spaceport" }
			}	
			if = { 
				limit = { has_spaceport_module = missile_weapon }
				owner = { add_ship_design = "NAME_Explosives_Spaceport" } 
			}
		}	
	}	
}

planet_event = {
	id = ex_spaceport_events.2
	hide_window = yes

	trigger = {
		has_spaceport = yes				
		OR = {
			has_spaceport_module = projectile_weapon
			has_spaceport_module = laser_weapon
			has_spaceport_module = missile_weapon
		}	
	}

	immediate = {
		if = {
			limit = { is_spaceport_module_slot_free = 1 }
			if = { 
				limit = { has_spaceport_module = projectile_weapon }
				spaceport = { delete_ship = this }
				create_spaceport = {
					owner = root
					initial_module = "space_port_core_module_kinetic_1"
				}		
				set_spaceport_level = 1	
				set_planet_flag = ex_spaceport_created	
			}	
			if = { 
				limit = { has_spaceport_module = laser_weapon }
				spaceport = { delete_ship = this }
				create_spaceport = {
					owner = root
					initial_module = "space_port_core_module_energy_1"
				}		
				set_spaceport_level = 1		
				set_planet_flag = ex_spaceport_created	
			}	
			if = { 
				limit = { has_spaceport_module = missile_weapon }
				spaceport = { delete_ship = this }
				create_spaceport = {
					owner = root
					initial_module = "space_port_core_module_explosives_1"
				}		
			set_spaceport_level = 1		
			set_planet_flag = ex_spaceport_created	
			}
		}	
		# else = { } 	
	}
}		

planet_event = {
	id = ex_spaceport_events.10 
	hide_window = yes

	trigger = {
		has_planet_flag = ex_spaceport_created
		has_owner = yes
		has_spaceport = yes			
		is_spaceport_module_slot_free = 2		
	}

	immediate = {
		if = { 
			limit = { has_spaceport_module = space_port_core_module_kinetic_1 }			
			remove_spaceport_module = space_port_core_module_kinetic_1
			set_spaceport_module = { slot = 1 module = space_port_core_module_kinetic_2 }
		}	
		if = { 
			limit = { has_spaceport_module = space_port_core_module_energy_1 }			
			remove_spaceport_module = space_port_core_module_energy_1
			set_spaceport_module = { slot = 1 module = space_port_core_module_energy_2 }
		}			
		if = { 
			limit = { has_spaceport_module = space_port_core_module_explosives_1 }			
			remove_spaceport_module = space_port_core_module_explosives_1
			set_spaceport_module = { slot = 1 module = space_port_core_module_explosives_2 }
		}			
	}
}	